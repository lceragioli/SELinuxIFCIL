; typeattributes for information flows;
(typeattribute TCB)
(typeattribute Harm)
(typeattribute Harmless)
(typeattributeset Harmless (or TCB (not Harm)))
;IFL; (TCBintegrity) +> TCB : Harmless +> TCB ;IFL;

(policycap "network_peer_controls")
(policycap "open_perms")

; (policycap "always_check_network")
(macro standard_obj_change_exemption_subj_type ((type ARG1))
	(call standard_obj_id_change_exemption_subj_type (ARG1))

	(tunableif enable_rbacsep
		(true
			(call rbacsep_obj_role_change_exemption_subj_type (ARG1)))))

(macro standard_obj_id_change_exemption_subj_type ((type ARG1))
	(typeattributeset standard_obj_id_change_exemption_subj_type ARG1))

(macro standard_uncond_exemption_subj_type ((type ARG1))
	(typeattributeset standard_uncond_exempt_subj_type ARG1))

(macro standard_sys_change_exemption_subj_type ((type ARG1))
	(call standard_sys_id_change_exemption_subj_type (ARG1))
	(call standard_sys_role_change_exemption_subj_type (ARG1)))

(macro standard_sys_id_change_exemption_subj_type ((type ARG1))
	(typeattributeset standard_sys_id_change_exemption_subj_type ARG1))

(macro standard_sys_role_change_exemption_subj_type ((type ARG1))
	(typeattributeset standard_sys_role_change_exemption_subj_type ARG1))

(macro standard_obj_sys_change_exemption_subj_type ((type ARG1))
	(call standard_obj_sys_id_change_exemption_subj_type (ARG1))

	(tunableif enable_rbacsep
		(true
			(call rbacsep_obj_sys_role_change_exemption_subj_type (ARG1)))))

(macro standard_obj_sys_id_change_exemption_subj_type ((type ARG1))
	(typeattributeset standard_obj_sys_id_change_exemption_subj_type ARG1))

(macro standard_change_exemption_subj_type ((type ARG1))
	(call standard_id_change_exemption_subj_type (ARG1))
	(call standard_role_change_exemption_subj_type (ARG1)))

(macro standard_id_change_exemption_subj_type ((type ARG1))
	(typeattributeset standard_id_change_exemption_subj_type ARG1))

(macro standard_role_change_exemption_subj_type ((type ARG1))
	(typeattributeset standard_role_change_exemption_subj_type ARG1))

(macro standard_user_exemption_target_subj_type ((type ARG1))
	(typeattributeset standard_user_exemption_target_subj_type ARG1))
(typeattribute standard_obj_id_change_exemption_subj_type)

(typeattribute standard_id_change_exemption_subj_type)
(typeattribute standard_role_change_exemption_subj_type)

(typeattribute standard_obj_sys_id_change_exemption_subj_type)

(typeattribute standard_sys_id_change_exemption_subj_type)
(typeattribute standard_sys_role_change_exemption_subj_type)

(typeattribute standard_user_exemption_target_subj_type)

(typeattribute standard_uncond_exempt_subj_type)

(tunableif (and (not enable_mls) (not enable_mcs))
	(true
		(mls false)

                (sensitivity s0)
                (sensitivityorder (s0))

                (category c0)
                (categoryorder (c0))

                (sensitivitycategory s0 (c0))

                (level systemlow (s0))
                (level systemhigh (s0 (c0)))))
(constrain (process (transition dyntransition noatsecure siginh rlimitinh))
	(or (or (or (eq u1 u2)
	(and (eq t1 standard_id_change_exemption_subj_type) (eq t2 standard_user_exemption_target_subj_type)))
	(and (eq t1 standard_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_uncond_exempt_subj_type)))

(constrain (process (transition dyntransition noatsecure siginh rlimitinh))
	(or (or (or (eq r1 r2)
	(and (eq t1 standard_role_change_exemption_subj_type) (eq t2 standard_user_exemption_target_subj_type)))
	(and (eq t1 standard_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
	(eq t1 standard_uncond_exempt_subj_type)))

(constrain (file (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (dir (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (lnk_file (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (chr_file (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (blk_file (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (sock_file (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (fifo_file (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (tcp_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (udp_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (rawip_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (packet_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (unix_stream_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (unix_dgram_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_route_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_tcpdiag_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_nflog_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_xfrm_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_selinux_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_audit_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_dnrt_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_kobject_uevent_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (appletalk_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (dccp_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (tun_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_iscsi_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_fib_lookup_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_connector_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_netfilter_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_generic_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_scsitransport_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_rdma_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))

(constrain (netlink_crypto_socket (create relabelto relabelfrom))
	(or (or (eq u1 u2)
	(and (eq t1 standard_obj_sys_id_change_exemption_subj_type) (eq u2 sys.id)))
	(eq t1 standard_obj_id_change_exemption_subj_type)))
(tunable enable_mls false)
(tunable enable_mcs false)
(tunable enable_rbacsep true)
(handleunknown deny)
(tunableif enable_rbacsep
	(true
		(context boot (sys.id sys.role boot.boot_file (systemlow systemlow)))
		(context config (sys.id sys.role config.config_file (systemlow systemlow)))
		(context data (sys.id sys.role data.data_file (systemlow systemlow)))
		(context file_execmod_all_except (sys.id sys.role file_execmod_all_except.bool (systemlow systemlow)))
		(context home_low (sys.id sys.role home.file (systemlow systemlow)))
		(context mnt (sys.id sys.role mnt.file (systemlow systemlow)))
		(context runtime_config (sys.id sys.role runtime_config.runtime_config_file (systemlow systemlow)))
		(context runtime_lock (sys.id sys.role runtime_lock.runtime_lock_file (systemlow systemlow)))
		(context runtime (sys.id sys.role runtime.runtime_file (systemlow systemlow)))
		(context unknown (sys.id sys.role unknown.file (systemlow systemlow)))
		(context var_cache (sys.id sys.role var_cache.var_cache_file (systemlow systemlow)))
		(context var_db (sys.id sys.role var_db.var_db_file (systemlow systemlow)))
		(context var_lib (sys.id sys.role var_lib.var_lib_file (systemlow systemlow)))
		(context var_spool (sys.id sys.role var_spool.var_spool_file (systemlow systemlow)))
		(context var_tmp_low (sys.id sys.role var_tmp.var_tmp_file (systemlow systemlow)))
		(context var (sys.id sys.role var.var_file (systemlow systemlow))))
	(false
		(context boot (sys.id object_r boot.boot_file (systemlow systemlow)))
		(context config (sys.id object_r config.config_file (systemlow systemlow)))
		(context data (sys.id object_r data.data_file (systemlow systemlow)))
		(context file_execmod_all_except (sys.id object_r file_execmod_all_except.bool (systemlow systemlow)))
		(context home_low (sys.id object_r home.file (systemlow systemlow)))
		(context mnt (sys.id object_r mnt.file (systemlow systemlow)))
		(context runtime_config (sys.id object_r runtime_config.runtime_config_file (systemlow systemlow)))
		(context runtime_lock (sys.id object_r runtime_lock.runtime_lock_file (systemlow systemlow)))
		(context runtime (sys.id object_r runtime.runtime_file (systemlow systemlow)))
		(context unknown (sys.id object_r unknown.file (systemlow systemlow)))
		(context var_cache (sys.id object_r var_cache.var_cache_file (systemlow systemlow)))
		(context var_db (sys.id object_r var_db.var_db_file (systemlow systemlow)))
		(context var_lib (sys.id object_r var_lib.var_lib_file (systemlow systemlow)))
		(context var_spool (sys.id object_r var_spool.var_spool_file (systemlow systemlow)))
		(context var_tmp_low (sys.id object_r var_tmp.var_tmp_file (systemlow systemlow)))
		(context var (sys.id object_r var.var_file (systemlow systemlow)))))

(tunableif enable_mls
	(true
		(tunableif enable_rbacsep
			(true
				(context home (sys.id sys.role home.file (systemlow systemhigh)))
				(context lost_found (sys.id sys.role lost_found.file (systemhigh systemhigh)))
				(context runtime_user (sys.id sys.role runtime_user.runtime_file (systemlow systemhigh)))
				(context var_log (sys.id sys.role var_log.var_log_file (systemlow systemhigh)))
				(context var_tmp (sys.id sys.role var_tmp.var_tmp_file (systemlow systemhigh))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context home (sys.id object_r home.file (systemlow systemhigh)))
				(context lost_found (sys.id object_r lost_found.file (systemhigh systemhigh)))
				(context runtime_user (sys.id object_r runtime_user.runtime_file (systemlow systemhigh)))
				(context var_log (sys.id object_r var_log.var_log_file (systemlow systemhigh)))
				(context var_tmp (sys.id object_r var_tmp.var_tmp_file (systemlow systemhigh)))))))

(tunableif (not enable_mls)
	(true
		(tunableif enable_rbacsep
			(true
				(context home (sys.id sys.role home.file (systemlow systemlow)))
				(context lost_found (sys.id sys.role lost_found.file (systemlow systemlow)))
				(context runtime_user (sys.id sys.role runtime_user.runtime_file (systemlow systemlow)))
				(context var_log (sys.id sys.role var_log.var_log_file (systemlow systemlow)))
				(context var_tmp (sys.id sys.role var_tmp.var_tmp_file (systemlow systemlow))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context home (sys.id object_r home.file (systemlow systemlow)))
				(context lost_found (sys.id object_r lost_found.file (systemlow systemlow)))
				(context runtime_user (sys.id object_r runtime_user.runtime_file (systemlow systemlow)))
				(context var_log (sys.id object_r var_log.var_log_file (systemlow systemlow)))
				(context var_tmp (sys.id object_r var_tmp.var_tmp_file (systemlow systemlow)))))))

(filecon "/.*" any unknown)
(filecon "/boot(/.*)?" any boot)
(filecon "/boot/efi(/.*)?" any ())
(filecon "/boot/\.journal" any ())
(filecon "/boot/lost\+found/.*" any ())
(filecon "/boot/lost\+found" dir lost_found)
(filecon "/etc(/.*)?" any config)
(filecon "/etc/\.journal" any ())
(filecon "/etc/lost\+found/.*" any ())
(filecon "/etc/lost\+found" dir lost_found)
(filecon "/etc/rc\.d/init\.d/functions" file config)
(filecon "/etc/rc\.d/init\.d/README" file config)
(filecon "/etc/sysconfig/network-scripts/network-functions.*" file config)
(filecon "/home/.*" any ())
(filecon "/home" dir home)
(filecon "/home/\.journal" any ())
(filecon "/home/lost\+found/.*" any ())
(filecon "/home/lost\+found" dir lost_found)
(filecon "/home" symlink home_low)
(filecon "/\.journal" any ())
(filecon "/lost\+found/.*" any ())
(filecon "/lost\+found" dir lost_found)
(filecon "/media/[^/]*/.*" any ())
(filecon "/media(/[^/]*)?" dir mnt)
(filecon "/media(/[^/]*)?" symlink mnt)
(filecon "/mnt/[^/]*/.*" any ())
(filecon "/mnt(/[^/]*)?" dir mnt)
(filecon "/mnt(/[^/]*)?" symlink mnt)
(filecon "/opt(/.*)?" any data)
(filecon "/opt/\.journal" any ())
(filecon "/opt/lost\+found/.*" any ())
(filecon "/opt/lost\+found" dir lost_found)
(filecon "/srv(/.*)?" any var)
(filecon "/srv/\.journal" any ())
(filecon "/srv/lost\+found/.*" any ())
(filecon "/srv/lost\+found" dir lost_found)
(filecon "/usr(/.*)?" any data)
(filecon "/usr/\.journal" any ())
(filecon "/usr/lost\+found/.*" any ())
(filecon "/usr/lost\+found" dir lost_found)
(filecon "/usr/tmp" symlink var_tmp_low)
(filecon "/var(/.*)?" any var)
(filecon "/var/cache(/.*)?" any var_cache)
(filecon "/var/cache/\.journal" any ())
(filecon "/var/cache/lost\+found/.*" any ())
(filecon "/var/cache/lost\+found" dir lost_found)
(filecon "/var/db(/.*)?" any var_db)
(filecon "/var/db/\.journal" any ())
(filecon "/var/db/lost\+found/.*" any ())
(filecon "/var/db/lost\+found" dir lost_found)
(filecon "/var/\.journal" any ())
(filecon "/var/lib(/.*)?" any var_lib)
(filecon "/var/lib/\.journal" any ())
(filecon "/var/lib/lost\+found/.*" any ())
(filecon "/var/lib/lost\+found" dir lost_found)
(filecon "/var/lock" symlink runtime_lock)
(filecon "/var/log(/.*)?" any var_log)
(filecon "/var/log/\.journal" any ())
(filecon "/var/log/lost\+found/.*" any ())
(filecon "/var/log/lost\+found" dir lost_found)
(filecon "/var/lost\+found/.*" any ())
(filecon "/var/lost\+found" dir lost_found)
(filecon "/var/mail" symlink var_spool)
(filecon "/var/run(/.*)?" any runtime)
(filecon "/var/run/lock(/.*)?" any runtime_lock)
(filecon "/var/run/lock" symlink runtime_lock)
(filecon "/var/run" symlink runtime)
(filecon "/var/run/sysconfig(/.*)?" any runtime_config)
(filecon "/var/run/user/.*" any ())
(filecon "/var/run/user" dir runtime_user)
(filecon "/var/spool(/.*)?" any var_spool)
(filecon "/var/spool/\.journal" any ())
(filecon "/var/spool/lost\+found/.*" any ())
(filecon "/var/spool/lost\+found" dir lost_found)
(filecon "/var/tmp/.*" any ())
(filecon "/var/tmp" dir var_tmp)
(filecon "/var/tmp/\.journal" any ())
(filecon "/var/tmp/lost\+found/.*" any ())
(filecon "/var/tmp/lost\+found" dir lost_found)

(genfscon "selinuxfs" "/booleans/file_execmod_all_except" file_execmod_all_except)
(block file_obj_blk
	(blockabstract file_obj_blk)

	(type file)
	(call file_obj_type (file)))

(block file_auth_obj_blk
	(blockabstract file_auth_obj_blk)

	(type auth_file)
	(call file_auth_obj_type (auth_file)))

(block file_sec_obj_blk
	(blockabstract file_sec_obj_blk)

	(type sec_file)
	(call file_sec_obj_type (sec_file)))

(block file_boot_obj_blk
	(blockabstract file_boot_obj_blk)

	(type boot_file)
	(call file_boot_obj_type (boot_file)))

(block file_boot_flag_obj_blk
	(blockabstract file_boot_flag_obj_blk)

	(type boot_flag_file)
	(call file_boot_flag_obj_type (boot_flag_file)))

(block file_config_obj_blk
	(blockabstract file_config_obj_blk)

	(type config_file)
	(call file_config_obj_type (config_file)))

(block file_data_obj_blk
	(blockabstract file_data_obj_blk)

	(type data_file)
	(call file_data_obj_type (data_file)))

(block file_runtime_obj_blk
	(blockabstract file_runtime_obj_blk)

	(type runtime_file)
	(call file_runtime_obj_type (runtime_file)))

(block file_runtime_config_obj_blk
	(blockabstract file_runtime_config_obj_blk)

	(type runtime_config_file)
	(call file_runtime_config_obj_type (runtime_config_file)))

(block file_runtime_lock_obj_blk
	(blockabstract file_runtime_lock_obj_blk)

	(type runtime_lock_file)
	(call file_runtime_lock_obj_type (runtime_lock_file)))

(block file_var_obj_blk
	(blockabstract file_var_obj_blk)

	(type var_file)
	(call file_var_obj_type (var_file)))

(block file_var_cache_obj_blk
	(blockabstract file_var_cache_obj_blk)

	(type var_cache_file)
	(call file_var_cache_obj_type (var_cache_file)))

(block file_var_db_obj_blk
	(blockabstract file_var_db_obj_blk)

	(type var_db_file)
	(call file_var_db_obj_type (var_db_file)))

(block file_var_lib_obj_blk
	(blockabstract file_var_lib_obj_blk)

	(type var_lib_file)
	(call file_var_lib_obj_type (var_lib_file)))

(block file_var_log_obj_blk
	(blockabstract file_var_log_obj_blk)

	(type var_log_file)
	(call file_var_log_obj_type (var_log_file)))

(block file_var_spool_obj_blk
	(blockabstract file_var_spool_obj_blk)

	(type var_spool_file)
	(call file_var_spool_obj_type (var_spool_file)))

(block file_var_tmp_obj_blk
	(blockabstract file_var_tmp_obj_blk)

	(type var_tmp_file)
	(call file_var_tmp_obj_type (var_tmp_file)))

(block file_tmpfs_obj_blk
	(blockabstract file_tmpfs_obj_blk)

	(type tmpfs_file)
	(call file_tmpfs_obj_type (tmpfs_file)))

(macro file_obj_type ((type ARG1))
	(typeattributeset file_obj_type ARG1)
	(typeattributeset file_non_auth_obj_type ARG1)
	(typeattributeset file_non_sec_obj_type ARG1))

(macro file_auth_obj_type ((type ARG1))
	(typeattributeset file_obj_type ARG1)
	(typeattributeset file_auth_obj_type ARG1))

(macro file_sec_obj_type ((type ARG1))
	(typeattributeset file_obj_type ARG1)
	(typeattributeset file_sec_obj_type ARG1))

(macro file_boot_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_boot_obj_type ARG1))

(macro file_boot_flag_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_boot_flag_obj_type ARG1))

(macro file_config_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_config_obj_type ARG1))

(macro file_data_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_data_obj_type ARG1))

(macro file_runtime_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_runtime_obj_type ARG1))

(macro file_runtime_config_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_runtime_config_obj_type ARG1))

(macro file_runtime_lock_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_runtime_lock_obj_type ARG1))

(macro file_var_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_var_obj_type ARG1))

(macro file_var_cache_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_var_cache_obj_type ARG1))

(macro file_var_db_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_var_db_obj_type ARG1))

(macro file_var_lib_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_var_lib_obj_type ARG1))

(macro file_var_log_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_var_log_obj_type ARG1))

(macro file_var_spool_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_var_spool_obj_type ARG1))

(macro file_var_tmp_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_var_tmp_obj_type ARG1))

(macro file_tmpfs_obj_type ((type ARG1))
	(call file_obj_type (ARG1))
	(typeattributeset file_tmpfs_obj_type ARG1))

(macro file_search_boot ((type ARG1))
	(allow ARG1 boot.boot_file search_dir_perms))

(macro file_list_boot ((type ARG1))
	(allow ARG1 boot.boot_file list_dir_perms))

(macro file_read_boot_files ((type ARG1))
	(call read_files_pattern (ARG1 boot.boot_file boot.boot_file)))

(macro file_rw_boot_files ((type ARG1))
	(call rw_files_pattern (ARG1 boot.boot_file boot.boot_file)))

(macro file_manage_boot_files ((type ARG1))
	(call manage_files_pattern (ARG1 boot.boot_file boot.boot_file)))

(macro file_read_boot_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 boot.boot_file boot.boot_file)))

(macro file_read_boot ((type ARG1))
	(allow ARG1 boot.boot_file read_file_perms)
	(allow ARG1 boot.boot_file list_dir_perms)
	(allow ARG1 boot.boot_file read_fifo_file_perms)
	(allow ARG1 boot.boot_file read_sock_file_perms)
	(allow ARG1 boot.boot_file read_lnk_file_perms))

(macro file_manage_boot ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 boot.boot_file manage_file_perms)
	(allow ARG1 boot.boot_file manage_dir_perms)
	(allow ARG1 boot.boot_file manage_fifo_file_perms)
	(allow ARG1 boot.boot_file manage_sock_file_perms)
	(allow ARG1 boot.boot_file manage_lnk_file_perms))

(macro file_rw_boot_dirs ((type ARG1))
	(allow ARG1 boot.boot_file rw_dir_perms))

(macro file_search_all_boot ((type ARG1))
	(allow ARG1 file_boot_obj_type search_dir_perms))

(macro file_list_all_boot ((type ARG1))
	(allow ARG1 file_boot_obj_type list_dir_perms))

(macro file_read_all_boot_files ((type ARG1))
	(call read_files_pattern (ARG1 file_boot_obj_type file_boot_obj_type)))

(macro file_read_all_boot_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 file_boot_obj_type file_boot_obj_type)))

(macro file_read_all_boot ((type ARG1))
	(allow ARG1 file_boot_obj_type read_file_perms)
	(allow ARG1 file_boot_obj_type list_dir_perms)
	(allow ARG1 file_boot_obj_type read_fifo_file_perms)
	(allow ARG1 file_boot_obj_type read_sock_file_perms)
	(allow ARG1 file_boot_obj_type read_lnk_file_perms))

(macro file_manage_all_boot ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 file_boot_obj_type manage_file_perms)
	(allow ARG1 file_boot_obj_type manage_dir_perms)
	(allow ARG1 file_boot_obj_type manage_fifo_file_perms)
	(allow ARG1 file_boot_obj_type manage_sock_file_perms)
	(allow ARG1 file_boot_obj_type manage_lnk_file_perms))

(macro file_boot_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call obj_type_transition_pattern (ARG1 boot.boot_file ARG2 ARG3 ARG4)))

(macro file_read_all_boot_flag_files ((type ARG1))
	(allow ARG1 file_boot_flag_obj_type read_file_perms))

(macro file_manage_all_boot_flag_files ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 file_boot_flag_obj_type manage_file_perms))

(macro file_search_config ((type ARG1))
	(allow ARG1 config.config_file search_dir_perms))

(macro file_list_config ((type ARG1))
	(allow ARG1 config.config_file list_dir_perms))

(macro file_audit_access_config_dirs ((type ARG1))
	(allow ARG1 config.config_file (dir (write))))

(macro file_rw_config_dirs ((type ARG1))
	(allow ARG1 config.config_file rw_dir_perms))

(macro file_read_config_files ((type ARG1))
	(call read_files_pattern (ARG1 config.config_file config.config_file)))

(macro file_relabel_config_files ((type ARG1))
	(call relabel_files_pattern (ARG1 config.config_file config.config_file)))

(macro file_read_config_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 config.config_file config.config_file)))

(macro file_delete_config_lnk_files ((type ARG1))
	(call delete_lnk_files_pattern (ARG1 config.config_file config.config_file)))

(macro file_create_config_lnk_files ((type ARG1))
	(call create_lnk_files_pattern (ARG1 config.config_file config.config_file)))

(macro file_manage_config_files ((type ARG1))
	(call manage_files_pattern (ARG1 config.config_file config.config_file)))

(macro file_manage_config_lnk_files ((type ARG1))
	(call manage_lnk_files_pattern (ARG1 config.config_file config.config_file)))

(macro file_read_config ((type ARG1))
	(allow ARG1 config.config_file read_file_perms)
	(allow ARG1 config.config_file list_dir_perms)
	(allow ARG1 config.config_file read_fifo_file_perms)
	(allow ARG1 config.config_file read_sock_file_perms)
	(allow ARG1 config.config_file read_lnk_file_perms))

(macro file_manage_config ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 config.config_file manage_file_perms)
	(allow ARG1 config.config_file manage_dir_perms)
	(allow ARG1 config.config_file manage_fifo_file_perms)
	(allow ARG1 config.config_file manage_sock_file_perms)
	(allow ARG1 config.config_file manage_lnk_file_perms))

(macro file_setattr_config_dirs ((type ARG1))
	(allow ARG1 config.config_file (dir (setattr))))

(macro file_search_all_config ((type ARG1))
	(allow ARG1 file_config_obj_type search_dir_perms))

(macro file_list_all_config ((type ARG1))
	(allow ARG1 file_config_obj_type list_dir_perms))

(macro file_read_all_config_files ((type ARG1))
	(call read_files_pattern (ARG1 file_config_obj_type file_config_obj_type)))

(macro file_read_all_config_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 file_config_obj_type file_config_obj_type)))

(macro file_read_all_config ((type ARG1))
	(allow ARG1 file_config_obj_type read_file_perms)
	(allow ARG1 file_config_obj_type list_dir_perms)
	(allow ARG1 file_config_obj_type read_fifo_file_perms)
	(allow ARG1 file_config_obj_type read_sock_file_perms)
	(allow ARG1 file_config_obj_type read_lnk_file_perms))

(macro file_manage_all_config ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 file_config_obj_type manage_file_perms)
	(allow ARG1 file_config_obj_type manage_dir_perms)
	(allow ARG1 file_config_obj_type manage_fifo_file_perms)
	(allow ARG1 file_config_obj_type manage_sock_file_perms)
	(allow ARG1 file_config_obj_type manage_lnk_file_perms))

(macro file_config_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call obj_type_transition_pattern (ARG1 config.config_file ARG2 ARG3 ARG4)))

(macro file_search_data ((type ARG1))
	(allow ARG1 data.data_file search_dir_perms))

(macro file_list_data ((type ARG1))
	(allow ARG1 data.data_file list_dir_perms))

(macro file_read_data_files ((type ARG1))
	(call read_files_pattern (ARG1 data.data_file data.data_file)))

(macro file_read_data_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 data.data_file data.data_file)))

(macro file_read_data ((type ARG1))
	(allow ARG1 data.data_file read_file_perms)
	(allow ARG1 data.data_file list_dir_perms)
	(allow ARG1 data.data_file read_fifo_file_perms)
	(allow ARG1 data.data_file read_sock_file_perms)
	(allow ARG1 data.data_file read_lnk_file_perms))

(macro file_manage_data ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 data.data_file manage_file_perms)
	(allow ARG1 data.data_file manage_dir_perms)
	(allow ARG1 data.data_file manage_fifo_file_perms)
	(allow ARG1 data.data_file manage_sock_file_perms)
	(allow ARG1 data.data_file manage_lnk_file_perms))

(macro file_rw_data_dirs ((type ARG1))
	(allow ARG1 data.data_file rw_dir_perms))

(macro file_search_all_data ((type ARG1))
	(allow ARG1 file_data_obj_type search_dir_perms))

(macro file_list_all_data ((type ARG1))
	(allow ARG1 file_data_obj_type list_dir_perms))

(macro file_read_all_data_files ((type ARG1))
	(call read_files_pattern (ARG1 file_data_obj_type file_data_obj_type)))

(macro files_read_all_data_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 file_data_obj_type file_data_obj_type)))

(macro file_read_all_data ((type ARG1))
	(allow ARG1 file_data_obj_type read_file_perms)
	(allow ARG1 file_data_obj_type list_dir_perms)
	(allow ARG1 file_data_obj_type read_fifo_file_perms)
	(allow ARG1 file_data_obj_type read_sock_file_perms)
	(allow ARG1 file_data_obj_type read_lnk_file_perms))

(macro file_manage_all_data ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 file_data_obj_type manage_file_perms)
	(allow ARG1 file_data_obj_type manage_dir_perms)
	(allow ARG1 file_data_obj_type manage_fifo_file_perms)
	(allow ARG1 file_data_obj_type manage_sock_file_perms)
	(allow ARG1 file_data_obj_type manage_lnk_file_perms))

(macro file_data_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call obj_type_transition_pattern (ARG1 data.data_file ARG2 ARG3 ARG4)))

(macro file_search_home ((type ARG1))
	(allow ARG1 home.file search_dir_perms))

(macro file_list_home ((type ARG1))
	(allow ARG1 home.file list_dir_perms))

(macro file_add_entry_home ((type ARG1))
	(allow ARG1 home.file add_entry_dir_perms))

(macro file_del_entry_home ((type ARG1))
	(allow ARG1 home.file del_entry_dir_perms))

(macro file_rw_home_dirs ((type ARG1))
	(allow ARG1 home.file rw_dir_perms))

(macro file_home_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call obj_type_transition_pattern (ARG1 home.file ARG2 ARG3 ARG4)))

(macro file_manage_lost_found_files ((type ARG1))
	(call sys_search_mountpoints (ARG1))
	(call manage_files_pattern (ARG1 lost_found.file lost_found.file)))

(macro file_manage_lost_found_dirs ((type ARG1))
	(call sys_rw_mountpoint_dirs (ARG1))
	(call manage_dirs_pattern (ARG1 lost_found.file lost_found.file)))

(macro file_manage_lost_found ((type ARG1))
	(call sys_rw_mountpoint_dirs (ARG1))
	(allow ARG1 lost_found.file manage_file_perms)
	(allow ARG1 lost_found.file manage_dir_perms)
	(allow ARG1 lost_found.file manage_lnk_file_perms))

(macro file_mountpoint_obj_type_transition_lost_found ((type ARG1))
	(call sys_mountpoint_obj_type_transition (ARG1 lost_found.file dir "lost+found")))

(macro file_search_mnt ((type ARG1))
	(allow ARG1 mnt.file search_dir_perms))

(macro file_list_mnt ((type ARG1))
	(allow ARG1 mnt.file list_dir_perms))

(macro file_read_mnt_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 mnt.file mnt.file)))

(macro file_read_mnt ((type ARG1))
	(allow ARG1 mnt.file list_dir_perms)
	(allow ARG1 mnt.file read_file_perms)
	(allow ARG1 mnt.file read_lnk_file_perms))

(macro file_manage_mnt ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 mnt.file manage_dir_perms)
	(allow ARG1 mnt.file manage_file_perms)
	(allow ARG1 mnt.file manage_lnk_file_perms))

(macro file_rw_mnt_dirs ((type ARG1))
	(allow ARG1 mnt.file rw_dir_perms))

(macro file_manage_mnt_dirs ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 mnt.file manage_dir_perms))

(macro file_setattr_mnt_dirs ((type ARG1))
	(allow ARG1 mnt.file (dir (setattr))))

(macro file_dontaudit_audit_access_mnt_dirs ((type ARG1))
	(dontaudit ARG1 mnt.file (dir (audit_access))))

(macro file_mounton_mnt_dirs ((type ARG1))
	(allow ARG1 mnt.file (dir (mounton))))

(macro file_search_runtime ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 runtime.runtime_file read_lnk_file_perms)
	(allow ARG1 runtime.runtime_file search_dir_perms))

(macro file_list_runtime ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 runtime.runtime_file read_lnk_file_perms)
	(allow ARG1 runtime.runtime_file list_dir_perms))

(macro file_read_runtime_files ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime.runtime_file read_file_perms))

(macro file_read_runtime_lnk_files ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime.runtime_file read_lnk_file_perms))

(macro file_dontaudit_audit_access_runtime_dirs ((type ARG1))
	(dontaudit ARG1 runtime.runtime_file (dir (audit_access))))

(macro file_rw_runtime_dirs ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime.runtime_file rw_dir_perms))

(macro file_read_runtime ((type ARG1))
	(allow ARG1 runtime.runtime_file read_file_perms)
	(allow ARG1 runtime.runtime_file list_dir_perms)
	(allow ARG1 runtime.runtime_file read_fifo_file_perms)
	(allow ARG1 runtime.runtime_file read_sock_file_perms)
	(allow ARG1 runtime.runtime_file read_lnk_file_perms))

(macro file_manage_runtime ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 runtime.runtime_file manage_file_perms)
	(allow ARG1 runtime.runtime_file manage_dir_perms)
	(allow ARG1 runtime.runtime_file manage_fifo_file_perms)
	(allow ARG1 runtime.runtime_file manage_sock_file_perms)
	(allow ARG1 runtime.runtime_file manage_lnk_file_perms))

(macro file_add_entry_runtime ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 runtime.runtime_file read_lnk_file_perms)
	(allow ARG1 runtime.runtime_file add_entry_dir_perms))

(macro file_del_entry_runtime ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 runtime.runtime_file read_lnk_file_perms)
	(allow ARG1 runtime.runtime_file del_entry_dir_perms))

(macro file_mounton_runtime_dirs ((type ARG1))
	(allow ARG1 runtime.runtime_file (dir (mounton))))

(macro file_search_all_runtime ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 runtime.runtime_file read_lnk_file_perms)
	(call search_dirs_pattern (ARG1 runtime.runtime_file file_runtime_obj_type)))

(macro file_list_all_runtime ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 runtime.runtime_file read_lnk_file_perms)
	(call search_dirs_pattern (ARG1 runtime.runtime_file file_runtime_obj_type)))

(macro file_read_all_runtime_files ((type ARG1))
	(call file_search_all_runtime (ARG1))
	(allow ARG1 file_runtime_obj_type read_file_perms))

(macro file_read_all_runtime_lnk_files ((type ARG1))
	(call file_search_all_runtime (ARG1))
	(call read_lnk_files_pattern (ARG1 file_runtime_obj_type file_runtime_obj_type)))

(macro file_read_all_runtime ((type ARG1))
	(allow ARG1 file_runtime_obj_type read_file_perms)
	(allow ARG1 file_runtime_obj_type list_dir_perms)
	(allow ARG1 file_runtime_obj_type read_fifo_file_perms)
	(allow ARG1 file_runtime_obj_type read_sock_file_perms)
	(allow ARG1 file_runtime_obj_type read_lnk_file_perms))

(macro file_manage_all_runtime ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 file_runtime_obj_type manage_file_perms)
	(allow ARG1 file_runtime_obj_type manage_dir_perms)
	(allow ARG1 file_runtime_obj_type manage_fifo_file_perms)
	(allow ARG1 file_runtime_obj_type manage_sock_file_perms)
	(allow ARG1 file_runtime_obj_type manage_lnk_file_perms))

(macro file_relabel_all_runtime ((type ARG1))
	(allow ARG1 file_runtime_obj_type relabel_file_perms)
	(allow ARG1 file_runtime_obj_type relabel_dir_perms)
	(allow ARG1 file_runtime_obj_type relabel_fifo_file_perms)
	(allow ARG1 file_runtime_obj_type relabel_sock_file_perms)
	(allow ARG1 file_runtime_obj_type relabel_lnk_file_perms))

(macro file_runtime_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call file_search_runtime (ARG1))
	(call obj_type_transition_pattern (ARG1 runtime.runtime_file ARG2 ARG3 ARG4)))

(macro file_search_runtime_config ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_config.runtime_config_file search_dir_perms))

(macro file_list_runtime_config ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_config.runtime_config_file list_dir_perms))

(macro file_read_runtime_config_files ((type ARG1))
	(call file_search_runtime_config (ARG1))
	(allow ARG1 runtime_config.runtime_config_file read_file_perms))

(macro file_dontaudit_audit_access_runtime_config_dirs ((type ARG1))
	(dontaudit ARG1 runtime_config.runtime_config_file (dir (audit_access))))

(macro file_rw_runtime_config_dirs ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_config.runtime_config_file rw_dir_perms))

(macro file_manage_runtime_config_dirs ((type ARG1))
	(call file_rw_runtime_dirs (ARG1))
	(allow ARG1 runtime_config.runtime_config_file manage_dir_perms))

(macro file_read_runtime_config ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_config.runtime_config_file read_file_perms)
	(allow ARG1 runtime_config.runtime_config_file list_dir_perms)
	(allow ARG1 runtime_config.runtime_config_file read_fifo_file_perms)
	(allow ARG1 runtime_config.runtime_config_file read_lnk_file_perms)
	(allow ARG1 runtime_config.runtime_config_file read_sock_file_perms))

(macro file_manage_runtime_config ((type ARG1))
	(call file_rw_runtime_dirs (ARG1))
	(allow ARG1 runtime_config.runtime_config_file manage_file_perms)
	(allow ARG1 runtime_config.runtime_config_file manage_dir_perms)
	(allow ARG1 runtime_config.runtime_config_file manage_fifo_file_perms)
	(allow ARG1 runtime_config.runtime_config_file manage_lnk_file_perms)
	(allow ARG1 runtime_config.runtime_config_file manage_sock_file_perms))

(macro file_add_entry_runtime_config ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_config.runtime_config_file add_entry_dir_perms))

(macro file_del_entry_runtime_config ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_config.runtime_config_file del_entry_dir_perms))

(macro file_search_all_runtime_config ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 file_runtime_config_obj_type search_dir_perms))

(macro files_list_all_runtime_config ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 file_runtime_config_obj_type list_dir_perms))

(macro file_read_all_runtime_config_files ((type ARG1))
	(call file_search_runtime (ARG1))
	(call read_files_pattern (ARG1 file_runtime_config_obj_type file_runtime_config_obj_type)))

(macro file_read_all_runtime_config_lnk_files ((type ARG1))
	(call file_search_runtime (ARG1))
	(call read_lnk_files_pattern (ARG1 file_runtime_config_obj_type file_runtime_config_obj_type)))

(macro file_read_all_runtime_config ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 file_runtime_config_obj_type read_file_perms)
	(allow ARG1 file_runtime_config_obj_type list_dir_perms)
	(allow ARG1 file_runtime_config_obj_type read_fifo_file_perms)
	(allow ARG1 file_runtime_config_obj_type read_link_file_perms)
	(allow ARG1 file_runtime_config_obj_type read_sock_file_perms))

(macro file_manage_all_runtime_config ((type ARG1))
	(call file_rw_runtime_dirs (ARG1))
	(allow ARG1 file_runtime_config_obj_type manage_file_perms)
	(allow ARG1 file_runtime_config_obj_type manage_dir_perms)
	(allow ARG1 file_runtime_config_obj_type manage_fifo_file_perms)
	(allow ARG1 file_runtime_config_obj_type manage_lnk_file_perms)
	(allow ARG1 file_runtime_config_obj_type manage_sock_file_perms))

(macro file_runtime_obj_type_transition_runtime_config ((type ARG1))
	(call file_search_runtime (ARG1))
	(call file_runtime_obj_type_transition (ARG1 runtime_config.runtime_config_file dir "sysconfig")))

(macro file_runtime_config_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call file_search_runtime (ARG1))
	(call obj_type_transition_pattern (ARG1 runtime_config.runtime_config_file. ARG2 ARG3 ARG4)))

(macro file_search_runtime_lock ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_lock.runtime_lock_file read_lnk_file_perms)
	(allow ARG1 runtime_lock.runtime_lock_file search_dir_perms))

(macro file_list_runtime_lock ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_lock.runtime_lock_file read_lnk_file_perms)
	(allow ARG1 runtime_lock.runtime_lock_file list_dir_perms))

(macro file_read_runtime_lock_files ((type ARG1))
	(call file_search_runtime_lock (ARG1))
	(allow ARG1 runtime_lock.runtime_lock_file read_file_perms))

(macro file_dontaudit_audit_access_runtime_lock_dirs ((type ARG1))
	(dontaudit ARG1 runtime_lock.runtime_lock_file (dir (audit_access))))

(macro file_rw_runtime_lock_dirs ((type ARG1))
	(call file_search_runtime_lock (ARG1))
	(allow ARG1 runtime_lock.runtime_lock_file rw_dir_perms))

(macro file_read_runtime_lock ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_lock.runtime_lock_file read_file_perms)
	(allow ARG1 runtime_lock.runtime_lock_file list_dir_perms)
	(allow ARG1 runtime_lock.runtime_lock_file read_fifo_file_perms)
	(allow ARG1 runtime_lock.runtime_lock_file read_sock_file_perms)
	(allow ARG1 runtime_lock.runtime_lock_file read_lnk_file_perms))

(macro file_manage_runtime_lock ((type ARG1))
	(call file_rw_runtime_dirs (ARG1))
	(allow ARG1 runtime_lock.runtime_lock_file manage_file_perms)
	(allow ARG1 runtime_lock.runtime_lock_file manage_dir_perms)
	(allow ARG1 runtime_lock.runtime_lock_file manage_fifo_file_perms)
	(allow ARG1 runtime_lock.runtime_lock_file manage_sock_file_perms)
	(allow ARG1 runtime_lock_runtime_lock_file manage_lnk_file_perms))

(macro file_relabelto_runtime_lock_dirs ((type ARG1))
	(call file_search_runtime_lock (ARG1))
	(allow ARG1 runtime_lock.runtime_lock_file relabelto_dir_perms))

(macro file_search_all_runtime_lock ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_lock.runtime_lock_file read_lnk_file_perms)
	(call search_dirs_pattern (ARG1 runtime_lock.runtime_lock_file file_runtime_lock_obj_type)))

(macro file_list_all_runtime_lock ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_lock.runtime_lock_file read_lnk_file_perms)
	(call search_dirs_pattern (ARG1 runtime_lock.runtime_lock_file file_runtime_lock_obj_type)))

(macro file_read_all_runtime_lock_files ((type ARG1))
	(call file_search_all_runtime_lock (ARG1))
	(allow ARG1 file_runtime_lock_obj_type read_file_perms))

(macro file_read_all_runtime_lock_lnk_files ((type ARG1))
	(call file_search_runtime (ARG1))
	(call read_lnk_files_pattern (ARG1 file_runtime_lock_obj_type file_runtime_lock_obj_type)))

(macro file_read_all_runtime_lock ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 file_runtime_lock_obj_type read_file_perms)
	(allow ARG1 file_runtime_lock_obj_type list_dir_perms)
	(allow ARG1 file_runtime_lock_obj_type read_fifo_file_perms)
	(allow ARG1 file_runtime_lock_obj_type read_sock_file_perms)
	(allow ARG1 file_runtime_lock_obj_type read_lnk_file_perms))

(macro file_manage_all_runtime_lock ((type ARG1))
	(call file_rw_runtime_dirs (ARG1))
	(allow ARG1 file_runtime_lock_obj_type manage_file_perms)
	(allow ARG1 file_runtime_lock_obj_type manage_dir_perms)
	(allow ARG1 file_runtime_lock_obj_type manage_fifo_file_perms)
	(allow ARG1 file_runtime_lock_obj_type manage_sock_file_perms)
	(allow ARG1 file_runtime_lock_obj_type manage_lnk_file_perms))

(macro file_runtime_lock_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call file_search_runtime_lock (ARG1))
	(call obj_type_transition_pattern (ARG1 runtime_lock.runtime_lock_file ARG2 ARG3 ARG4)))

(macro file_search_runtime_user ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_user.runtime_file search_dir_perms))

(macro file_list_runtime_user ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_user.runtime_file list_dir_perms))

(macro file_add_entry_runtime_user ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_user.runtime_file add_entry_dir_perms))

(macro file_del_entry_runtime_user ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_user.runtime_file del_entry_dir_perms))

(macro file_rw_runtime_user_dirs ((type ARG1))
	(call file_search_runtime (ARG1))
	(allow ARG1 runtime_user.runtime_file rw_dir_perms))

(macro file_manage_runtime_user_dirs ((type ARG1))
	(call file_rw_runtime_dirs (ARG1))
	(allow ARG1 runtime_user.runtime_file manage_dir_perms))

(macro file_setattr_runtime_user_dirs ((type ARG1))
	(allow ARG1 runtime_user.runtime_file (dir (setattr))))

(macro file_dontaudit_audit_access_runtime_user_dirs ((type ARG1))
	(dontaudit ARG1 runtime_user.runtime_file (dir (audit_access))))

(macro file_mounton_runtime_user_dirs ((type ARG1))
	(allow ARG1 runtime_user.runtime_file (dir (mounton))))

(macro file_runtime_user_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call file_search_runtime (ARG1))
	(call obj_type_transition_pattern (ARG1 runtime_user.runtime_file ARG2 ARG3 ARG4)))

(macro file_search_all_tmpfs ((type ARG1))
	(call fs_search_tmpfs (ARG1))
	(allow ARG1 file_tmpfs_obj_type search_dir_perms))

(macro file_list_all_tmpfs ((type ARG1))
	(call fs_search_tmpfs (ARG1))
	(allow ARG1 file_tmpfs_obj_type list_dir_perms))

(macro file_getattr_all_tmpfs_files ((type ARG1))
	(call fs_search_tmpfs (ARG1))
	(call getattr_files_pattern (ARG1 file_tmpfs_obj_type file_tmpfs_obj_type)))

(macro file_read_all_tmpfs_files ((type ARG1))
	(call fs_search_tmpfs (ARG1))
	(call read_files_pattern (ARG1 file_tmpfs_obj_type file_tmpfs_obj_type)))

(macro file_read_all_tmpfs_lnk_files ((type ARG1))
	(call fs_search_tmpfs (ARG1))
	(call read_lnk_files_pattern (ARG1 file_tmpfs_obj_type file_tmpfs_obj_type)))

(macro file_read_all_tmpfs ((type ARG1))
	(call fs_search_tmpfs (ARG1))
	(allow ARG1 file_tmpfs_obj_type read_file_perms)
	(allow ARG1 file_tmpfs_obj_type list_dir_perms)
	(allow ARG1 file_tmpfs_obj_type read_fifo_file_perms)
	(allow ARG1 file_tmpfs_obj_type read_sock_file_perms)
	(allow ARG1 file_tmpfs_obj_type read_lnk_file_perms))

(macro file_manage_all_tmpfs ((type ARG1))
	(call fs_rw_tmpfs_dirs (ARG1))
	(allow ARG1 file_tmpfs_obj_type manage_file_perms)
	(allow ARG1 file_tmpfs_obj_type manage_dir_perms)
	(allow ARG1 file_tmpfs_obj_type manage_fifo_perms)
	(allow ARG1 file_tmpfs_obj_type manage_sock_perms)
	(allow ARG1 file_tmpfs_obj_type manage_lnk_file_perms))

(macro file_search_unknown ((type ARG1))
	(allow ARG1 unknown.file search_dir_perms))

(macro file_list_unknown ((type ARG1))
	(allow ARG1 unknown.file list_dir_perms))

(macro file_read_unknown_files ((type ARG1))
	(call read_files_pattern (ARG1 unknown.file unknown.file)))

(macro file_read_unknown_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 unknown.file unknown.file)))

(macro file_read_unknown ((type ARG1))
	(allow ARG1 unknown.file read_file_perms)
	(allow ARG1 unknown.file list_dir_perms)
	(allow ARG1 unknown.file read_fifo_file_perms)
	(allow ARG1 unknown.file read_lnk_file_perms)
	(allow ARG1 unknown.file read_sock_file_perms))

(macro file_manage_unknown ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 unknown.file manage_file_perms)
	(allow ARG1 unknown.file manage_dir_perms)
	(allow ARG1 unknown.file manage_fifo_file_perms)
	(allow ARG1 unknown.file manage_lnk_file_perms)
	(allow ARG1 unknown.file manage_sock_file_perms))

(macro file_rootfs_obj_type_transition_unknown ((type ARG1))
	(call fs_rootfs_obj_type_transition (ARG1 unknown.file file "*"))
	(call fs_rootfs_obj_type_transition (ARG1 unknown.file dir "*"))
	(call fs_rootfs_obj_type_transition (ARG1 unknown.file fifo_file "*"))
	(call fs_rootfs_obj_type_transition (ARG1 unknown.file lnk_file "*"))
	(call fs_rootfs_obj_type_transition (ARG1 unknown.file sock_file "*"))
	(call fs_rootfs_obj_type_transition (ARG1 unknown.file blk_file "*"))
	(call fs_rootfs_obj_type_transition (ARG1 unknown.file chr_file "*")))

(macro file_search_var ((type ARG1))
	(allow ARG1 var.var_file search_dir_perms))

(macro file_list_var ((type ARG1))
	(allow ARG1 var.var_file list_dir_perms))

(macro file_read_var_files ((type ARG1))
	(call read_files_pattern (ARG1 var.var_file var.var_file)))

(macro file_read_var_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 var.var_file var.var_file)))

(macro file_read_var ((type ARG1))
	(allow ARG1 var.var_file read_file_perms)
	(allow ARG1 var.var_file list_dir_perms)
	(allow ARG1 var.var_file read_fifo_file_perms)
	(allow ARG1 var.var_file read_sock_file_perms)
	(allow ARG1 var.var_file read_lnk_file_perms))

(macro file_manage_var ((type ARG1))
	(allow ARG1 var.var_file manage_file_perms)
	(allow ARG1 var.var_file manage_dir_perms)
	(allow ARG1 var.var_file manage_fifo_file_perms)
	(allow ARG1 var.var_file manage_sock_file_perms)
	(allow ARG1 var.var_file manage_lnk_file_perms))

(macro file_rw_var_dirs ((type ARG1))
	(allow ARG1 var.var_file rw_dir_perms))

(macro file_setattr_var_dirs ((type ARG1))
	(allow ARG1 var.var_file (dir (setattr))))

(macro file_search_all_var ((type ARG1))
	(allow ARG1 file_var_obj_type search_dir_perms))

(macro file_list_all_var ((type ARG1))
	(allow ARG1 file_var_obj_type list_dir_perms))

(macro file_read_all_var_files ((type ARG1))
	(call read_files_pattern (ARG1 file_var_obj_type file_var_obj_type)))

(macro file_read_all_var_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 file_var_obj_type file_var_obj_type)))

(macro file_read_all_var ((type ARG1))
	(allow ARG1 file_var_obj_type read_file_perms)
	(allow ARG1 file_var_obj_type list_dir_perms)
	(allow ARG1 file_var_obj_type read_fifo_file_perms)
	(allow ARG1 file_var_obj_type read_sock_file_perms)
	(allow ARG1 file_var_obj_type read_lnk_file_perms))

(macro file_manage_all_var ((type ARG1))
	(call fs_rw_rootfs_dirs (ARG1))
	(allow ARG1 file_var_obj_type manage_file_perms)
	(allow ARG1 file_var_obj_type manage_dir_perms)
	(allow ARG1 file_var_obj_type manage_fifo_file_perms)
	(allow ARG1 file_var_obj_type manage_sock_file_perms)
	(allow ARG1 file_var_obj_type manage_lnk_file_perms))

(macro file_var_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call obj_type_transition_pattern (ARG1 var.var_file ARG2 ARG3 ARG4)))

(macro file_search_var_cache ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_cache.var_cache_file search_dir_perms))

(macro file_list_var_cache ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_cache.var_cache_file list_dir_perms))

(macro file_read_var_cache_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_files_pattern (ARG1 var_cache.var_cache_file var_cache.var_cache_file)))

(macro file_read_var_cache_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 var_cache.var_cache_file var_cache.var_cache_file)))

(macro file_read_var_cache ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_cache.var_cache_file read_file_perms)
	(allow ARG1 var_cache.var_cache_file list_dir_perms)
	(allow ARG1 var_cache.var_cache_file read_fifo_file_perms)
	(allow ARG1 var_cache.var_cache_file read_sock_file_perms)
	(allow ARG1 var_cache.var_cache_file read_lnk_file_perms))

(macro file_manage_var_cache ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 var_cache.var_cache_file manage_file_perms)
	(allow ARG1 var_cache.var_cache_file manage_dir_perms)
	(allow ARG1 var_cache.var_cache_file manage_fifo_file_perms)
	(allow ARG1 var_cache.var_cache_file manage_sock_file_perms)
	(allow ARG1 var_cache.var_cache_file manage_lnk_file_perms))

(macro file_rw_var_cache_dirs ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_cache.var_cache_file rw_dir_perms))

(macro file_search_all_var_cache ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_cache_obj_type search_dir_perms))

(macro file_list_all_var_cache ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_cache_obj_type list_dir_perms))

(macro file_read_all_var_cache_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_files_pattern (ARG1 file_var_cache_obj_type file_var_cache_obj_type)))

(macro file_read_all_var_cache_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 file_var_cache_obj_type file_var_cache_obj_type)))

(macro file_read_all_var_cache ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_cache_obj_type read_file_perms)
	(allow ARG1 file_var_cache_obj_type list_dir_perms)
	(allow ARG1 file_var_cache_obj_type read_fifo_file_perms)
	(allow ARG1 file_var_cache_obj_type read_sock_file_perms)
	(allow ARG1 file_var_cache_obj_type read_lnk_file_perms))

(macro file_manage_all_var_cache ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 file_var_cache_obj_type manage_file_perms)
	(allow ARG1 file_var_cache_obj_type manage_dir_perms)
	(allow ARG1 file_var_cache_obj_type manage_fifo_file_perms)
	(allow ARG1 file_var_cache_obj_type manage_sock_file_perms)
	(allow ARG1 file_var_cache_obj_type manage_lnk_file_perms))

(macro file_var_cache_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call file_search_var (ARG1))
	(call obj_type_transition_pattern (ARG1 var_cache.var_cache_file ARG2 ARG3 ARG4)))

(macro file_search_var_db ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_db.var_db_file search_dir_perms))

(macro file_list_var_db ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_db.var_db_file list_dir_perms))

(macro file_read_var_db_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_files_pattern (ARG1 var_db.var_db_file var_db.var_db_file)))

(macro file_read_var_db_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 var_db.var_db_file var_db.var_db_file)))

(macro file_read_var_db ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_db.var_db_file read_file_perms)
	(allow ARG1 var_db.var_db_file list_dir_perms)
	(allow ARG1 var_db.var_db_file read_fifo_file_perms)
	(allow ARG1 var_db.var_db_file read_sock_file_perms)
	(allow ARG1 var_db.var_db_file read_lnk_file_perms))

(macro file_manage_var_db ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 var_db.var_db_file manage_file_perms)
	(allow ARG1 var_db.var_db_file manage_dir_perms)
	(allow ARG1 var_db.var_db_file manage_fifo_file_perms)
	(allow ARG1 var_db.var_db_file manage_sock_file_perms)
	(allow ARG1 var_db.var_db_file manage_lnk_file_perms))

(macro file_rw_var_db_dirs ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_db.var_db_file rw_dir_perms))

(macro file_search_all_var_db ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_db_obj_type search_dir_perms))

(macro file_list_all_var_db ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_db_obj_type list_dir_perms))

(macro file_read_all_var_db_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_files_pattern (ARG1 file_var_db_obj_type file_var_db_obj_type)))

(macro file_read_all_var_db_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 file_var_db_obj_type file_var_db_obj_type)))

(macro file_read_all_var_db ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_db_obj_type read_file_perms)
	(allow ARG1 file_var_db_obj_type list_dir_perms)
	(allow ARG1 file_var_db_obj_type read_fifo_file_perms)
	(allow ARG1 file_var_db_obj_type read_sock_file_perms)
	(allow ARG1 file_var_db_obj_type read_lnk_file_perms))

(macro file_manage_all_var_db ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 file_var_db_obj_type manage_file_perms)
	(allow ARG1 file_var_db_obj_type manage_dir_perms)
	(allow ARG1 file_var_db_obj_type manage_fifo_file_perms)
	(allow ARG1 file_var_db_obj_type manage_sock_file_perms)
	(allow ARG1 file_var_db_obj_type manage_lnk_file_perms))

(macro file_var_db_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call file_search_var (ARG1))
	(call obj_type_transition_pattern (ARG1 var_db.var_db_file ARG2 ARG3 ARG4)))

(macro file_search_var_lib ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_lib.var_lib_file search_dir_perms))

(macro file_list_var_lib ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_lib.var_lib_file list_dir_perms))

(macro file_read_var_lib_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_files_pattern (ARG1 var_lib.var_lib_file var_lib.var_lib_file)))

(macro file_read_var_lib_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 var_lib.var_lib_file var_lib.var_lib_file)))

(macro file_read_lib ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_lib.var_lib_file read_file_perms)
	(allow ARG1 var_lib.var_lib_file list_dir_perms)
	(allow ARG1 var_lib.var_lib_file read_fifo_file_perms)
	(allow ARG1 var_lib.var_lib_file read_sock_file_perms)
	(allow ARG1 var_lib.var_lib_file read_lnk_file_perms))

(macro file_manage_var_lib ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 var_lib.var_lib_file manage_file_perms)
	(allow ARG1 var_lib.var_lib_file manage_dir_perms)
	(allow ARG1 var_lib.var_lib_file manage_fifo_file_perms)
	(allow ARG1 var_lib.var_lib_file manage_sock_file_perms)
	(allow ARG1 var_lib.var_lib_file manage_lnk_file_perms))

(macro file_rw_var_lib_dirs ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_lib.var_lib_file rw_dir_perms))

(macro file_setattr_var_lib_dirs ((type ARG1))
	(allow ARG1 var_lib.var_lib_file (dir (setattr))))

(macro file_search_all_var_lib ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_lib_obj_type search_dir_perms))

(macro file_list_all_var_lib ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_lib_obj_type list_dir_perms))

(macro file_read_all_var_lib_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_files_pattern (ARG1 file_var_lib_obj_type file_var_lib_obj_type)))

(macro file_read_all_var_lib_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 file_var_lib_obj_type file_var_lib_obj_type)))

(macro file_read_all_var_lib ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_lib_obj_type read_file_perms)
	(allow ARG1 file_var_lib_obj_type list_dir_perms)
	(allow ARG1 file_var_lib_obj_type read_fifo_file_perms)
	(allow ARG1 file_var_lib_obj_type read_sock_file_perms)
	(allow ARG1 file_var_lib_obj_type read_lnk_file_perms))

(macro file_manage_all_var_lib ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 file_var_lib_obj_type manage_file_perms)
	(allow ARG1 file_var_lib_obj_type manage_dir_perms)
	(allow ARG1 file_var_lib_obj_type manage_fifo_file_perms)
	(allow ARG1 file_var_lib_obj_type manage_sock_file_perms)
	(allow ARG1 file_var_lib_obj_type manage_lnk_file_perms))

(macro file_var_lib_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call file_search_var (ARG1))
	(call obj_type_transition_pattern (ARG1 var_lib.var_lib_file ARG2 ARG3 ARG4)))

(macro file_search_var_log ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_log.var_log_file search_dir_perms))

(macro file_list_var_log ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_log.var_log_file list_dir_perms))

(macro file_read_var_log_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_files_pattern (ARG1 var_log.var_log_file var_log.var_log_file)))

(macro file_read_var_log_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 var_log.var_log_file var_log.var_log_file)))

(macro file_read_var_log ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_log.var_log_file read_file_perms)
	(allow ARG1 var_log.var_log_file list_dir_perms)
	(allow ARG1 var_log.var_log_file read_fifo_file_perms)
	(allow ARG1 var_log.var_log_file read_sock_file_perms)
	(allow ARG1 var_log.var_log_file read_lnk_file_perms))

(macro file_manage_var_log ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 var_log.var_log_file manage_file_perms)
	(allow ARG1 var_log.var_log_file manage_dir_perms)
	(allow ARG1 var_log.var_log_file manage_fifo_file_perms)
	(allow ARG1 var_log.var_log_file manage_sock_file_perms)
	(allow ARG1 var_log.var_log_file manage_lnk_file_perms))

(macro file_add_entry_var_log ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_log.var_log_file add_entry_dir_perms))

(macro file_del_entry_var_log ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_log.var_log_file del_entry_dir_perms))

(macro file_rw_var_log_dirs ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_log.var_log_file rw_dir_perms))

(macro file_search_all_var_log ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_log_obj_type search_dir_perms))

(macro file_list_all_var_log ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_log_obj_type list_dir_perms))

(macro file_read_all_var_log_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_files_pattern (ARG1 file_var_log_obj_type file_var_log_obj_type)))

(macro file_read_all_var_log_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 file_var_log_obj_type file_var_log_obj_type)))

(macro file_read_all_var_log ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_log_obj_type read_file_perms)
	(allow ARG1 file_var_log_obj_type list_dir_perms)
	(allow ARG1 file_var_log_obj_type read_fifo_file_perms)
	(allow ARG1 file_var_log_obj_type read_sock_file_perms)
	(allow ARG1 file_var_log_obj_type read_lnk_file_perms))

(macro file_manage_all_var_log ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 file_var_log_obj_type manage_file_perms)
	(allow ARG1 file_var_log_obj_type manage_dir_perms)
	(allow ARG1 file_var_log_obj_type manage_fifo_file_perms)
	(allow ARG1 file_var_log_obj_type manage_sock_file_perms)
	(allow ARG1 file_var_log_obj_type manage_lnk_file_perms))

(macro file_var_log_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call file_search_var (ARG1))
	(call obj_type_transition_pattern (ARG1 var_log.var_log_file ARG2 ARG3 ARG4)))

(macro file_search_var_spool ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_spool.var_spool_file read_lnk_file_perms)
	(allow ARG1 var_spool.var_spool_file search_dir_perms))

(macro file_list_var_spool ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_spool.var_spool_file read_lnk_file_perms)
	(allow ARG1 var_spool.var_spool_file list_dir_perms))

(macro file_add_entry_var_spool ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_spool.var_spool_file add_entry_dir_perms))

(macro file_del_entry_var_spool ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_spool.var_spool_file del_entry_dir_perms))

(macro file_read_var_spool_files ((type ARG1))
	(call file_search_var_spool (ARG1))
	(allow ARG1 var_spool.var_spool_file read_file_perms))

(macro file_dontaudit_audit_access_var_spool_dirs ((type ARG1))
	(dontaudit ARG1 var_spool.var_spool_file (dir (audit_access))))

(macro file_rw_var_spool_dirs ((type ARG1))
	(call file_search_var_spool (ARG1))
	(allow ARG1 var_spool.var_spool_file rw_dir_perms))

(macro file_manage_var_spool_dirs ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(call manage_dirs_pattern (ARG1 var_spool.var_spool_file var_spool.var_spool_file)))

(macro file_read_var_spool_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 var_spool.var_spool_file var_spool.var_spool_file)))

(macro file_read_var_spool ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_spool.var_spool_file read_file_perms)
	(allow ARG1 var_spool.var_spool_file list_dir_perms)
	(allow ARG1 var_spool.var_spool_file read_fifo_file_perms)
	(allow ARG1 var_spool.var_spool_file read_sock_file_perms)
	(allow ARG1 var_spool.var_spool_file read_lnk_file_perms))

(macro file_manage_var_spool ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 var_spool.var_spool_file manage_file_perms)
	(allow ARG1 var_spool.var_spool_file manage_dir_perms)
	(allow ARG1 var_spool.var_spool_file manage_fifo_file_perms)
	(allow ARG1 var_spool.var_spool_file manage_sock_file_perms)
	(allow ARG1 var_spool.var_spool_file manage_lnk_file_perms))

(macro file_search_all_var_spool ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_spool.var_spool_file read_lnk_file_perms)
	(call search_dirs_pattern (ARG1 var_spool.var_spool_file file_var_spool_obj_type)))

(macro file_list_all_var_spool ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_spool.var_spool_file read_lnk_file_perms)
	(call search_dirs_pattern (ARG1 var_spool.var_spool_file file_var_spool_obj_type)))

(macro file_read_all_var_spool_files ((type ARG1))
	(call file_search_all_var_spool (ARG1))
	(allow ARG1 file_var_spool_obj_type read_file_perms))

(macro file_read_all_var_spool_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 file_var_spool_obj_type file_var_spool_obj_type)))

(macro file_read_all_var_spool ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_spool_obj_type read_file_perms)
	(allow ARG1 file_var_spool_obj_type list_dir_perms)
	(allow ARG1 file_var_spool_obj_type read_fifo_file_perms)
	(allow ARG1 file_var_spool_obj_type read_sock_file_perms)
	(allow ARG1 file_var_spool_obj_type read_lnk_file_perms))

(macro file_manage_all_var_spool ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 file_var_spool_obj_type manage_file_perms)
	(allow ARG1 file_var_spool_obj_type manage_dir_perms)
	(allow ARG1 file_var_spool_obj_type manage_fifo_file_perms)
	(allow ARG1 file_var_spool_obj_type manage_sock_file_perms)
	(allow ARG1 file_var_spool_obj_type manage_lnk_file_perms))

(macro file_var_spool_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call file_search_var_spool (ARG1))
	(call obj_type_transition_pattern (ARG1 var_spool.var_spool_file ARG2 ARG3 ARG4)))

(macro file_search_var_tmp ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_tmp.var_tmp_file read_lnk_file_perms)
	(allow ARG1 var_tmp.var_tmp_file search_dir_perms))

(macro file_list_var_tmp ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_tmp.var_tmp_file read_lnk_file_perms)
	(allow ARG1 var_tmp.var_tmp_file list_dir_perms))

(macro file_read_var_tmp_files ((type ARG1))
	(call file_search_var_tmp (ARG1))
	(allow ARG1 var_tmp.var_tmp_file read_file_perms))

(macro file_audit_access_var_tmp_dirs ((type ARG1))
	(allow ARG1 var_tmp.var_tmp_file (dir (write))))

(macro file_dontaudit_audit_access_var_tmp_dirs ((type ARG1))
	(dontaudit ARG1 var_tmp.var_tmp_file (dir (audit_access))))

(macro file_rw_var_tmp_dirs ((type ARG1))
	(call file_search_var_tmp (ARG1))
	(allow ARG1 var_tmp.var_tmp_file rw_dir_perms))

(macro file_manage_var_tmp_dirs ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(call manage_dirs_pattern (ARG1 var_tmp.var_tmp_file var_tmp.var_tmp_file)))

(macro file_read_var_tmp_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 var_tmp.var_tmp_file var_tmp.var_tmp_file)))

(macro file_manage_var_tmp_lnk_files ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(call manage_lnk_files_pattern (ARG1 var_tmp.var_tmp_file var_tmp.var_tmp_file)))

(macro file_read_var_tmp ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_tmp.var_tmp_file read_file_perms)
	(allow ARG1 var_tmp.var_tmp_file list_dir_perms)
	(allow ARG1 var_tmp.var_tmp_file read_fifo_file_perms)
	(allow ARG1 var_tmp.var_tmp_file read_sock_file_perms)
	(allow ARG1 var_tmp.var_tmp_file read_lnk_file_perms))

(macro file_manage_var_tmp ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 var_tmp.var_tmp_file manage_file_perms)
	(allow ARG1 var_tmp.var_tmp_file manage_dir_perms)
	(allow ARG1 var_tmp.var_tmp_file manage_fifo_file_perms)
	(allow ARG1 var_tmp.var_tmp_file manage_sock_file_perms)
	(allow ARG1 var_tmp.var_tmp_file manage_lnk_file_perms))

(macro file_search_all_var_tmp ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_tmp.var_tmp_file read_lnk_file_perms)
	(call search_dirs_pattern (ARG1 var_tmp.var_tmp_file file_var_tmp_obj_type)))

(macro file_list_all_var_tmp ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 var_tmp.var_tmp_file read_lnk_file_perms)
	(call search_dirs_pattern (ARG1 var_tmp.var_tmp_file file_var_tmp_obj_type)))

(macro file_read_all_tmp_files ((type ARG1))
	(call file_search_all_var_tmp (ARG1))
	(allow ARG1 file_var_tmp_obj_type read_file_perms))

(macro file_read_all_var_tmp_lnk_files ((type ARG1))
	(call file_search_var (ARG1))
	(call read_lnk_files_pattern (ARG1 file_var_tmp_obj_type file_var_tmp_obj_type)))

(macro file_read_all_var_tmp ((type ARG1))
	(call file_search_var (ARG1))
	(allow ARG1 file_var_tmp_obj_type read_file_perms)
	(allow ARG1 file_var_tmp_obj_type list_dir_perms)
	(allow ARG1 file_var_tmp_obj_type read_fifo_file_perms)
	(allow ARG1 file_var_tmp_obj_type read_sock_file_perms)
	(allow ARG1 file_var_tmp_obj_type read_lnk_file_perms))

(macro file_manage_all_var_tmp ((type ARG1))
	(call file_rw_var_dirs (ARG1))
	(allow ARG1 file_var_tmp_obj_type manage_file_perms)
	(allow ARG1 file_var_tmp_obj_type manage_dir_perms)
	(allow ARG1 file_var_tmp_obj_type manage_fifo_file_perms)
	(allow ARG1 file_var_tmp_obj_type manage_sock_file_perms)
	(allow ARG1 file_var_tmp_obj_type manage_lnk_file_perms))

(macro file_var_tmp_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call file_search_var_tmp (ARG1))
	(call obj_type_transition_pattern (ARG1 var_tmp.var_tmp_file ARG2 ARG3 ARG4)))

(macro file_list_all ((type ARG1))
	(allow ARG1 file_obj_type list_dir_perms))

(macro file_read_all_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 file_obj_type file_obj_type)))

(macro file_dontaudit_relabel_all ((type ARG1))
	(dontaudit ARG1 file_obj_type (file (relabelto relabelfrom)))
	(dontaudit ARG1 file_obj_type (dir (relabelto relabelfrom)))
	(dontaudit ARG1 file_obj_type (fifo_file (relabelto relabelfrom)))
	(dontaudit ARG1 file_obj_type (lnk_file (relabelto relabelfrom)))
	(dontaudit ARG1 file_obj_type (sock_file (relabelto relabelfrom)))
	(dontaudit ARG1 file_obj_type (blk_file (relabelto relabelfrom)))
	(dontaudit ARG1 file_obj_type (chr_file (relabelto relabelfrom))))

(macro file_getattr_all ((type ARG1))
	(allow ARG1 file_obj_type (file (getattr)))
	(allow ARG1 file_obj_type (dir (getattr)))
	(allow ARG1 file_obj_type (fifo_file (getattr)))
	(allow ARG1 file_obj_type (lnk_file (getattr)))
	(allow ARG1 file_obj_type (sock_file (getattr)))
	(allow ARG1 file_obj_type (blk_file (getattr)))
	(allow ARG1 file_obj_type (chr_file (getattr))))

(macro file_read_all_files_except ((type ARG1))
	(call read_files_pattern (ARG1 file_except_obj_type file_except_obj_type)))

(macro file_rw_all_files_except ((type ARG1))
	(call rw_files_pattern (ARG1 file_except_obj_type file_except_obj_type)))

(macro file_read_all_inherited_files_except ((type ARG1))
	(allow ARG1 file_except_obj_type read_inherited_file_perms))

(macro file_read_all_lnk_files_except ((type ARG1))
	(allow ARG1 file_except_obj_type read_lnk_file_perms))

(macro file_setattr_all_dirs_except ((type ARG1))
	(allow ARG1 file_except_obj_type (dir (setattr))))

(macro file_list_all_except ((type ARG1))
	(allow ARG1 file_except_obj_type list_dir_perms))

(macro file_getattr_all_except ((type ARG1))
	(allow ARG1 file_except_obj_type (file (getattr)))
	(allow ARG1 file_except_obj_type (dir (getattr)))
	(allow ARG1 file_except_obj_type (fifo_file (getattr)))
	(allow ARG1 file_except_obj_type (lnk_file (getattr)))
	(allow ARG1 file_except_obj_type (sock_file (getattr)))
	(allow ARG1 file_except_obj_type (blk_file (getattr)))
	(allow ARG1 file_except_obj_type (chr_file (getattr))))

(macro file_dontaudit_audit_access_all_except ((type ARG1))
	(dontaudit ARG1 file_except_obj_type (file (audit_access)))
	(dontaudit ARG1 file_except_obj_type (dir (audit_access)))
	(dontaudit ARG1 file_except_obj_type (fifo_file (audit_access)))
	(dontaudit ARG1 file_except_obj_type (lnk_file (audit_access)))
	(dontaudit ARG1 file_except_obj_type (sock_file (audit_access)))
	(dontaudit ARG1 file_except_obj_type (blk_file (audit_access)))
	(dontaudit ARG1 file_except_obj_type (chr_file (audit_access))))

(macro file_mounton_all_except ((type ARG1))
	(allow ARG1 file_except_obj_type (file (mounton)))
	(allow ARG1 file_except_obj_type (dir (mounton))))

(macro file_read_all_except ((type ARG1))
	(allow ARG1 file_except_obj_type read_file_perms)
	(allow ARG1 file_except_obj_type list_dir_perms)
	(allow ARG1 file_except_obj_type read_fifo_file_perms)
	(allow ARG1 file_except_obj_type read_lnk_file_perms)
	(allow ARG1 file_except_obj_type read_sock_file_perms)
	(allow ARG1 file_except_obj_type read_blk_file_perms)
	(allow ARG1 file_except_obj_type read_chr_file_perms))

(macro file_relabel_all_except ((type ARG1))
	(allow ARG1 file_except_obj_type relabel_file_perms)
	(allow ARG1 file_except_obj_type relabel_dir_perms)
	(allow ARG1 file_except_obj_type relabel_fifo_file_perms)
	(allow ARG1 file_except_obj_type relabel_lnk_file_perms)
	(allow ARG1 file_except_obj_type relabel_sock_file_perms)
	(allow ARG1 file_except_obj_type relabel_blk_file_perms)
	(allow ARG1 file_except_obj_type relabel_chr_file_perms))

(macro file_relabelfrom_all_except ((type ARG1))
	(allow ARG1 file_except_obj_type relabelfrom_file_perms)
	(allow ARG1 file_except_obj_type relabelfrom_dir_perms)
	(allow ARG1 file_except_obj_type relabelfrom_fifo_file_perms)
	(allow ARG1 file_except_obj_type relabelfrom_lnk_file_perms)
	(allow ARG1 file_except_obj_type relabelfrom_sock_file_perms)
	(allow ARG1 file_except_obj_type relabelfrom_blk_file_perms)
	(allow ARG1 file_except_obj_type relabelfrom_chr_file_perms))

(macro file_spec_exception ((type ARG1)(type ARG2))
	(typeattributeset ARG1 (and (file_obj_type) (not (file_auth_obj_type file_sec_obj_type file_exception_obj_type ARG2)))))

(macro file_exception_obj_type ((type ARG1))
	(typeattributeset file_exception_obj_type ARG1))

(macro file_execmod_all_except_subj_type ((type ARG1))
	(booleanif file_execmod_all_except (true (allow ARG1 file_except_obj_type (file (execmod))))))

(macro file_execmod_all_except_uncond_subj_type ((type ARG1))
	(allow ARG1 file_except_obj_type (file (execmod))))

(macro file_unconfined_subj_type ((type ARG1))
	(typeattributeset file_unconfined_subj_type ARG1))
(boolean file_execmod_all_except false)

(typeattribute file_obj_type)

(typeattribute file_auth_obj_type)
(typeattribute file_non_auth_obj_type)

(typeattribute file_sec_obj_type)
(typeattribute file_non_sec_obj_type)

(typeattribute file_boot_obj_type)
(typeattribute file_boot_flag_obj_type)
(typeattribute file_config_obj_type)
(typeattribute file_data_obj_type)
(typeattribute file_runtime_obj_type)
(typeattribute file_runtime_config_obj_type)
(typeattribute file_runtime_lock_obj_type)
(typeattribute file_var_obj_type)
(typeattribute file_var_cache_obj_type)
(typeattribute file_var_db_obj_type)
(typeattribute file_var_lib_obj_type)
(typeattribute file_var_log_obj_type)
(typeattribute file_var_spool_obj_type)
(typeattribute file_var_tmp_obj_type)
(typeattribute file_tmpfs_obj_type)

(typeattribute file_unconfined_subj_type)

(block boot
	(blockinherit file_boot_obj_blk)

	(call sys_mountpoint_obj_type (boot_file)))

(block config
	(blockinherit file_config_obj_blk)

	(call sys_mountpoint_obj_type (config_file)))

(block data
	(blockinherit file_data_obj_blk)

	(call sys_mountpoint_obj_type (data_file)))

(block home
	(blockinherit file_obj_blk)

	(call sys_mountpoint_obj_type (file)))

(block lost_found
	(blockinherit file_obj_blk))

(block mnt
	(blockinherit file_obj_blk)

	(call sys_mountpoint_obj_type (file)))

(block runtime
	(blockinherit file_runtime_obj_blk)

	(call sys_mountpoint_obj_type (runtime_file)))

(block runtime_config
	(blockinherit file_runtime_config_obj_blk))

(block runtime_lock
	(blockinherit file_runtime_lock_obj_blk)

	(call sys_mountpoint_obj_type (runtime_lock_file)))

(block runtime_user
	(blockinherit file_runtime_obj_blk)

	(call sys_mountpoint_obj_type (runtime_file)))

(block unknown
	(blockinherit file_obj_blk))

(block var
	(blockinherit file_var_obj_blk)

	(call sys_mountpoint_obj_type (var_file)))

(block var_cache
	(blockinherit file_var_cache_obj_blk)

	(call sys_mountpoint_obj_type (var_cache_file)))

(block var_db
	(blockinherit file_var_db_obj_blk)

	(call sys_mountpoint_obj_type (var_db_file)))

(block var_lib
	(blockinherit file_var_lib_obj_blk)

	(call sys_mountpoint_obj_type (var_lib_file)))

(block var_log
	(blockinherit file_var_log_obj_blk)

	(call sys_mountpoint_obj_type (var_log_file)))

(block var_spool
	(blockinherit file_var_spool_obj_blk)

	(call sys_mountpoint_obj_type (var_spool_file)))

(block var_tmp
	(blockinherit file_var_tmp_obj_blk)

	(call sys_mountpoint_obj_type (var_tmp_file)))

(block file_execmod_all_except
	(blockinherit sec_bool_obj_blk))

(call sys_obj_type (file_obj_type))

(call fs_associate_fs (file_obj_type))

(call fs_associate_tmpfs (file_runtime_obj_type))
(call fs_associate_tmpfs (file_runtime_lock_obj_type))

(call fs_associate_tmpfs (file_tmpfs_obj_type))

(typeattribute file_except_obj_type)
(typeattribute file_exception_obj_type)

(typeattributeset file_except_obj_type (and (file_obj_type) (not (file_auth_obj_type file_sec_obj_type file_exception_obj_type))))

(allow file_unconfined_subj_type file_except_obj_type all_file_perms_except_mounton_execmod_and_entrypoint)
(allow file_unconfined_subj_type file_except_obj_type all_dir_perms_except_mounton_and_execmod)
(allow file_unconfined_subj_type file_except_obj_type all_fifo_file_perms_except_mounton_and_execmod)
(allow file_unconfined_subj_type file_except_obj_type all_lnk_file_perms_except_mounton_and_execmod)
(allow file_unconfined_subj_type file_except_obj_type all_sock_file_perms_except_mounton_and_execmod)
(allow file_unconfined_subj_type file_except_obj_type all_blk_file_perms_except_mounton_and_execmod)
(allow file_unconfined_subj_type file_except_obj_type all_chr_file_perms_except_mounton_and_execmod)

(call file_rootfs_obj_type_transition_unknown (file_unconfined_subj_type))

(call file_execmod_all_except_subj_type (file_unconfined_subj_type))
(tunableif enable_rbacsep
	(true
		(context ephemeral (sys.id sys.role ephemeral.port (systemlow systemlow)))
		(context hi_reserved (sys.id sys.role hi_reserved.port (systemlow systemlow)))
		(context port (sys.id sys.role port.port (systemlow systemlow)))
		(context reserved (sys.id sys.role reserved.port (systemlow systemlow)))
		(context unreserved (sys.id sys.role unreserved.port (systemlow systemlow))))
	(false
		(context ephemeral (sys.id object_r ephemeral.port (systemlow systemlow)))
		(context hi_reserved (sys.id object_r hi_reserved.port (systemlow systemlow)))
		(context port (sys.id object_r port.port (systemlow systemlow)))
		(context reserved (sys.id object_r reserved.port (systemlow systemlow)))
		(context unreserved (sys.id object_r unreserved.port (systemlow systemlow)))))

(tunableif enable_mls
	(true
		(tunableif enable_rbacsep
			(true
				(context if (sys.id sys.role if.if (systemlow systemhigh)))
				(context node (sys.id sys.role node.node (systemlow systemhigh)))
				(context peer (sys.id sys.role peer.peer (systemhigh systemhigh))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context if (sys.id object_r if.if (systemlow systemhigh)))
				(context node (sys.id object_r node.node (systemlow systemhigh)))
				(context peer (sys.id object_r peer.peer (systemhigh systemhigh)))))))

(tunableif (not enable_mls)
	(true
		(tunableif enable_rbacsep
			(true
				(context if (sys.id sys.role if.if (systemlow systemlow)))
				(context node (sys.id sys.role node.node (systemlow systemlow)))
				(context peer (sys.id sys.role peer.peer (systemlow systemlow))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context if (sys.id object_r if.if (systemlow systemlow)))
				(context node (sys.id object_r node.node (systemlow systemlow)))
				(context peer (sys.id object_r peer.peer (systemlow systemlow)))))))

(portcon "tcp" (1024 32767) unreserved)
(portcon "tcp" (1 511) reserved)
(portcon "tcp" (32768 61000) ephemeral)
(portcon "tcp" (512 1023) hi_reserved)
(portcon "tcp" (61001 65535) unreserved)
(portcon "udp" (1024 32767) unreserved)
(portcon "udp" (1 511) reserved)
(portcon "udp" (32768 61000) ephemeral)
(portcon "udp" (512 1023) hi_reserved)
(portcon "udp" (61001 65535) unreserved)

(sidcontext netif if)
(sidcontext netmsg peer)
(sidcontext node node)
(sidcontext port port)
(block net_if_obj_blk
	(blockabstract net_if_obj_blk)

	(type if)
	(call net_if_obj_type (if)))

(block net_node_obj_blk
	(blockabstract net_node_obj_blk)

	(type node)
	(call net_node_obj_type (node)))

(block net_packet_obj_blk
	(blockabstract net_packet_obj_blk)

	(type packet)
	(call net_packet_obj_type (packet)))

(block net_peer_obj_blk
	(blockabstract net_peer_obj_blk)

	(type peer)
	(call net_peer_obj_type (peer)))

(block net_port_obj_blk
	(blockabstract net_port_obj_blk)

	(type port)
	(call net_port_obj_type (port)))

(block net_ephemeral_port_obj_blk
	(blockabstract net_ephemeral_port_obj_blk)

	(type port)
	(call net_ephemeral_port_obj_type (port)))

(block net_hi_reserved_port_obj_blk
	(blockabstract net_hi_reserved_port_obj_blk)

	(type port)
	(call net_hi_reserved_port_obj_type (port)))

(block net_reserved_port_obj_blk
	(blockabstract net_reserved_port_obj_blk)

	(type port)
	(call net_reserved_port_obj_type (port)))

(block net_unreserved_port_obj_blk
	(blockabstract net_unreserved_port_obj_blk)

	(type port)
	(call net_unreserved_port_obj_type (port)))

(macro net_if_obj_type ((type ARG1))
	(typeattributeset net_if_obj_type ARG1))

(macro net_node_obj_type ((type ARG1))
	(typeattributeset net_node_obj_type ARG1))

(macro net_packet_obj_type ((type ARG1))
	(typeattributeset net_packet_obj_type ARG1))

(macro net_peer_obj_type ((type ARG1))
	(typeattributeset net_peer_obj_type ARG1))

(macro net_port_obj_type ((type ARG1))
	(typeattributeset net_port_obj_type ARG1))

(macro net_ephemeral_port_obj_type ((type ARG1))
	(call net_port_obj_type (ARG1))
	(typeattributeset net_ephemeral_port_obj_type ARG1))

(macro net_hi_reserved_port_obj_type ((type ARG1))
	(call net_port_obj_type (ARG1))
	(typeattributeset net_reserved_port_obj_type ARG1)
	(typeattributeset net_rpc_port_obj_type ARG1))

(macro net_reserved_port_obj_type ((type ARG1))
	(call net_port_obj_type (ARG1))
	(typeattributeset net_reserved_port_obj_type ARG1))

(macro net_unreserved_port_obj_type ((type ARG1))
	(call net_port_obj_type (ARG1))
	(typeattributeset net_unreserved_port_obj_type ARG1))

(macro net_tcp_bind_all_unreserved_ports ((type ARG1))
	(allow ARG1 net_unreserved_port_obj_type (tcp_socket (name_bind))))

(macro net_tcp_bind_generic_node ((type ARG1))
	(allow ARG1 node.node (tcp_socket (node_bind))))

(macro net_tcp_connect_all_ephemeral_ports ((type ARG1))
	(allow ARG1 net_ephemeral_port_obj_type (tcp_socket (name_connect))))

(macro net_tcp_connect_all_unreserved_ports ((type ARG1))
	(allow ARG1 net_unreserved_port_obj_type (tcp_socket (name_connect))))

(macro net_udp_bind_all_unreserved_ports ((type ARG1))
	(allow ARG1 net_unreserved_port_obj_type (udp_socket (name_bind))))

(macro net_tcp_connect_unreserved_port ((type ARG1))
	(allow ARG1 unreserved.port (tcp_socket (name_connect))))

(macro net_udp_bind_generic_node ((type ARG1))
	(allow ARG1 node.node (udp_socket (node_bind))))

(macro net_udp_bind_ephemeral_port ((type ARG1))
	(allow ARG1 ephemeral.port (udp_socket (name_bind))))

(macro net_udp_bind_unreserved_port ((type ARG1))
	(allow ARG1 unreserved.port (udp_socket (name_bind))))

(macro net_unconfined_subj_type ((type ARG1))
	(typeattributeset net_unconfined_subj_type ARG1))
(sid port)
(sid netif)
(sid netmsg)
(sid node)

(typeattribute net_if_obj_type)
(typeattribute net_node_obj_type)
(typeattribute net_packet_obj_type)
(typeattribute net_peer_obj_type)
(typeattribute net_port_obj_type)

(typeattribute net_ephemeral_port_obj_type)
(typeattribute net_reserved_port_obj_type)
(typeattribute net_rpc_port_obj_type)
(typeattribute net_unreserved_port_obj_type)

(typeattribute net_unconfined_subj_type)

(block port
	(blockinherit net_port_obj_blk))

(block ephemeral
	(blockinherit net_ephemeral_port_obj_blk))

(block hi_reserved
	(blockinherit net_hi_reserved_port_obj_blk))

(block reserved
	(blockinherit net_reserved_port_obj_blk))

(block unreserved
	(blockinherit net_unreserved_port_obj_blk))

(block node
	(blockinherit net_node_obj_blk))

(block if
	(blockinherit net_if_obj_blk))

(block packet
	(blockinherit net_packet_obj_blk))

(block peer
	(blockinherit net_peer_obj_blk))

(call sys_obj_type (net_if_obj_type))
(call sys_obj_type (net_node_obj_type))
(call sys_obj_type (net_packet_obj_type))
(call sys_obj_type (net_peer_obj_type))
(call sys_obj_type (net_port_obj_type))

(allow net_unconfined_subj_type net_node_obj_type (node (recvfrom sendto)))
(allow net_unconfined_subj_type net_if_obj_type (netif (ingress egress)))
(allow net_unconfined_subj_type net_packet_obj_type (packet (send recv relabelto forward_in forward_out)))

(allow net_unconfined_subj_type net_port_obj_type (tcp_socket (name_bind name_connect)))
(allow net_unconfined_subj_type net_port_obj_type (udp_socket (name_bind)))
(allow net_unconfined_subj_type net_port_obj_type (rawip_socket (name_bind)))
(allow net_unconfined_subj_type net_port_obj_type (dccp_socket (name_bind name_connect)))

(allow net_unconfined_subj_type net_node_obj_type (tcp_socket (node_bind)))
(allow net_unconfined_subj_type net_node_obj_type (udp_socket (node_bind)))
(allow net_unconfined_subj_type net_node_obj_type (rawip_socket (node_bind)))
(allow net_unconfined_subj_type net_node_obj_type (dccp_socket (node_bind)))

(call sys_recvfrom_unlabeled_tcp_sockets (net_unconfined_subj_type))
(call sys_recvfrom_unlabeled_udp_sockets (net_unconfined_subj_type))
(call sys_recvfrom_unlabeled_rawip_sockets (net_unconfined_subj_type))
(call sys_recvfrom_unlabeled_dccp_sockets (net_unconfined_subj_type))

(call sys_recv_unlabeled_peers (net_unconfined_subj_type))
(tunableif enable_rbacsep
	(true
		(context subj_execheap (sys.id sys.role subj_execheap.bool (systemlow systemlow)))
		(context subj_execmem (sys.id sys.role subj_execmem.bool (systemlow systemlow)))
		(context subj_execstack (sys.id sys.role subj_execstack.bool (systemlow systemlow)))
		(context subj_mmap_low (sys.id sys.role subj_mmap_low.bool (systemlow systemlow)))
		(context subj_ptrace (sys.id sys.role subj_ptrace.bool (systemlow systemlow))))
	(false
		(context subj_execheap (sys.id object_r subj_execheap.bool (systemlow systemlow)))
		(context subj_execmem (sys.id object_r subj_execmem.bool (systemlow systemlow)))
		(context subj_execstack (sys.id object_r subj_execstack.bool (systemlow systemlow)))
		(context subj_mmap_low (sys.id object_r subj_mmap_low.bool (systemlow systemlow)))
		(context subj_ptrace (sys.id object_r subj_ptrace.bool (systemlow systemlow)))))

(genfscon "selinuxfs" "/booleans/subj_execheap" subj_execheap)
(genfscon "selinuxfs" "/booleans/subj_execmem" subj_execmem)
(genfscon "selinuxfs" "/booleans/subj_execstack" subj_execstack)
(genfscon "selinuxfs" "/booleans/subj_mmap_low" subj_mmap_low)
(genfscon "selinuxfs" "/booleans/subj_ptrace" subj_ptrace)
(block subj_blk
	(blockabstract subj_blk)

	(type subj)
	(call subj_type (subj)))

(block subj_common_blk
	(blockabstract subj_common_blk)

	(type subj)
	(call subj_common_type (subj)))

(macro subj_type ((type ARG1))
	(typeattributeset subj_type ARG1))

(macro subj_common_type ((type ARG1))
	(call subj_type (ARG1))
	(typeattributeset subj_common_type ARG1))

(macro subj_entry ((type ARG1)(type ARG2))
	(allow ARG1 ARG2 (file (entrypoint)))
	(allow ARG1 ARG2 mmap_file_perms)
	(call subj_entry_obj_type (ARG2)))

(macro subj_entry_obj_type ((type ARG1))
	(typeattributeset subj_entry_obj_type ARG1))

(macro subj_dynamic_subj_type_transition_type ((type ARG1))
	(typeattributeset subj_dynamic_subj_type_transition_type ARG1))

(macro subj_execheap_type ((type ARG1))
	(typeattributeset subj_execheap_type ARG1)
	(booleanif subj_execheap (true (allow ARG1 self (process (execheap))))))

(macro subj_execheap_uncond_type ((type ARG1))
	(allow ARG1 self (process (execheap)))
	(typeattributeset subj_execheap_type ARG1))

(macro subj_execmem_type ((type ARG1))
	(typeattributeset subj_execmem_type ARG1)
	(booleanif subj_execmem (true (allow ARG1 self (process (execmem))))))

(macro subj_execmem_uncond_type ((type ARG1))
	(allow ARG1 self (process (execmem)))
	(typeattributeset subj_execmem_type ARG1))

(macro subj_execstack_type ((type ARG1))
	(typeattributeset subj_execmem_type ARG1)
	(typeattributeset subj_execstack_type ARG1)
	(booleanif subj_execstack (true (allow ARG1 self (process (execmem execstack))))))

(macro subj_execstack_uncond_type ((type ARG1))
	(allow ARG1 self (process (execmem execstack)))
	(typeattributeset subj_execmem_type ARG1)
	(typeattributeset subj_execstack_type ARG1))

(macro subj_mmap_low_type ((type ARG1))
	(typeattributeset subj_mmap_low_type ARG1)
	(booleanif subj_mmap_low (true (allow ARG1 self (memprotect (mmap_zero))))))

(macro subj_mmap_low_uncond_type ((type ARG1))
	(allow ARG1 self (memprotect (mmap_zero)))
	(typeattributeset subj_mmap_low_type ARG1))

(macro subj_ptrace_type ((type ARG1))
	(typeattributeset subj_ptrace_type ARG1)
	(booleanif subj_ptrace (true (allow ARG1 self (capability (sys_ptrace))))))

(macro subj_ptrace_uncond_type ((type ARG1))
	(allow ARG1 self (capability (sys_ptrace)))
	(typeattributeset subj_ptrace_type ARG1))

(macro subj_interactive_fd_type ((type ARG1))
	(typeattributeset subj_interactive_fd_type ARG1))

(macro subj_use_interactive_fd_type ((type ARG1))
	(typeattributeset subj_use_interactive_fd_type ARG1))

(macro subj_getattr_common_subj ((type ARG1))
	(allow ARG1 subj_common_type (process (getattr))))

(macro subj_dontaudit_read_common_subj_state ((type ARG1))
	(dontaudit ARG1 subj_common_type read_file_perms)
	(dontaudit ARG1 subj_common_type list_dir_perms)
	(dontaudit ARG1 subj_common_type read_lnk_file_perms))

(macro subj_read_common_subj_state ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 subj_common_type read_file_perms)
	(allow ARG1 subj_common_type list_dir_perms)
	(allow ARG1 subj_common_type read_lnk_file_perms))

(macro subj_getpgid_common_subj ((type ARG1))
	(allow ARG1 subj_common_type (process (getpgid))))

(macro subj_getsched_common_subj ((type ARG1))
	(allow ARG1 subj_common_type (process (getsched))))

(macro subj_getsession_common_subj ((type ARG1))
	(allow ARG1 subj_common_type (process (getsession))))

(macro subj_setsched_common_subj ((type ARG1))
	(allow ARG1 subj_common_type (process (setsched))))

(macro subj_send_sigkill_common_subj ((type ARG1))
	(allow ARG1 subj_common_type (process (sigkill))))

(macro subj_send_signal_common_subj ((type ARG1))
	(allow ARG1 subj_common_type (process (signal))))

(macro subj_send_signull_common_subj ((type ARG1))
	(allow ARG1 subj_common_type (process (signull))))

(macro subj_send_sigstop_common_subj ((type ARG1))
	(allow ARG1 subj_common_type (process (sigstop))))

(macro subj_unconfined_type ((type ARG1))
	(typeattributeset subj_unconfined_type ARG1))
(boolean subj_execheap false)
(boolean subj_execmem false)
(boolean subj_execstack false)
(boolean subj_mmap_low false)
(boolean subj_ptrace false)

(typeattribute subj_entry_obj_type)

(typeattribute subj_type)
(typeattribute subj_common_type)

(typeattribute subj_unconfined_type)

(typeattribute subj_interactive_fd_type)
(typeattribute subj_use_interactive_fd_type)

(block subj_execheap
	(blockinherit sec_bool_obj_blk))

(block subj_execmem
	(blockinherit sec_bool_obj_blk))

(block subj_execstack
	(blockinherit sec_bool_obj_blk))

(block subj_mmap_low
	(blockinherit sec_bool_obj_blk))

(block subj_ptrace
	(blockinherit sec_bool_obj_blk))

(call cmd_obj_type (subj_entry_obj_type))

(allow subj_use_interactive_fd_type subj_interactive_fd_type (fd (use)))

(allow subj_type self (process (sigkill signal signull sigstop)))

(allow subj_type self rw_file_perms)
(allow subj_type self list_dir_perms)
(allow subj_type self read_lnk_file_perms)

(call sys_subj_type (subj_common_type))

(call fs_search_rootfs (subj_type))

(allow subj_common_type self (process (fork sigchld)))

(call sys_read_vm_overcommit_sysctl_files (subj_common_type))
(call sys_search_invalid (subj_common_type))

(call cmd_search_cmd (subj_common_type))

(call dev_rw_devtty (subj_common_type))
(call dev_rw_null (subj_common_type))
(call dev_rw_zero (subj_common_type))

(call fs_read_proc (subj_common_type))
(call fs_search_sysfs (subj_common_type))

(optional subj_common_type_optional_lib
	(call lib_use_ld_so (subj_common_type))
	(call lib_use_all_libs (subj_common_type)))

(typeattribute subj_not_subj_entry_obj_type)

(typeattributeset subj_not_subj_entry_obj_type (not (subj_entry_obj_type)))

(neverallow subj_type subj_not_subj_entry_obj_type (file (entrypoint)))

(typeattribute subj_not_subj_type)

(typeattributeset subj_not_subj_type (not subj_type))

(neverallow subj_type subj_not_subj_type (process (transition dyntransition)))

(typeattribute subj_dynamic_subj_type_transition_type)
(typeattribute subj_not_dynamic_subj_type_transition_type)

(typeattributeset subj_not_dynamic_subj_type_transition_type (and (subj_type) (not (subj_dynamic_subj_type_transition_type))))

(neverallow subj_not_dynamic_subj_type_transition_type self (process (setcurrent)))

(typeattribute subj_execheap_type)
(typeattribute subj_not_execheap_type)

(typeattributeset subj_not_execheap_type (and (subj_type) (not (subj_execheap_type))))
(neverallow subj_not_execheap_type self (process (execheap)))

(typeattribute subj_execmem_type)
(typeattribute subj_not_execmem_type)

(typeattributeset subj_not_execmem_type (and (subj_type) (not (subj_execmem_type))))

(neverallow subj_not_execmem_type self (process (execmem)))

(typeattribute subj_execstack_type)
(typeattribute subj_not_execstack_type)

(typeattributeset subj_not_execstack_type (and (subj_type) (not (subj_execstack_type))))

(neverallow subj_not_execstack_type self (process (execstack)))

(typeattribute subj_mmap_low_type)
(typeattribute subj_not_mmap_low_type)

(typeattributeset subj_not_mmap_low_type (and (subj_type) (not (subj_mmap_low_type))))

(neverallow subj_not_mmap_low_type self (memprotect (mmap_zero)))

(typeattribute subj_ptrace_type)
(typeattribute subj_not_ptrace_type)

(typeattributeset subj_not_ptrace_type (and (subj_type) (not (subj_ptrace_type))))

(neverallow subj_not_ptrace_type self (capability (sys_ptrace)))

(allow subj_unconfined_type self all_capability_perms_except_sys_module_sys_ptrace_and_sys_nice)
(allow subj_unconfined_type self all_capability2_perms_except_mac_override_and_mac_admin)
(allow subj_unconfined_type self all_fifo_file_perms_except_mounton_and_execmod)

(allow subj_unconfined_type subj_type
	all_process_perms_except_transition_dyntransition_setcurrent_execmem_execstack_and_execheap)
(allow subj_unconfined_type subj_type rw_file_perms)
(allow subj_unconfined_type subj_type list_dir_perms)
(allow subj_unconfined_type subj_type read_lnk_file_perms)
(allow subj_unconfined_type subj_type (fd (use)))
(allow subj_unconfined_type subj_type (socket (ioctl read write create getattr setattr lock relabelfrom relabelto append
	bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type create_tcp_stream_socket_perms)
(allow subj_unconfined_type subj_type create_udp_socket_perms)
(allow subj_unconfined_type subj_type create_rawip_socket_perms)
(allow subj_unconfined_type subj_type (netlink_socket (ioctl read write create getattr setattr lock relabelfrom relabelto append
	bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (packet_socket (ioctl read write create getattr setattr lock relabelfrom relabelto append
	bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (unix_stream_socket (ioctl read write create getattr setattr lock relabelfrom relabelto append
	bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind connectto)))
(allow subj_unconfined_type subj_type (unix_dgram_socket (ioctl read write create getattr setattr lock relabelfrom relabelto append  
	bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (sem (create destroy getattr setattr read write associate unix_read unix_write)))
(allow subj_unconfined_type subj_type (msg (send receive)))
(allow subj_unconfined_type subj_type (msgq (create destroy getattr setattr read write associate unix_read unix_write enqueue)))
(allow subj_unconfined_type subj_type (shm (create destroy getattr setattr read write associate unix_read unix_write lock)))
(allow subj_unconfined_type subj_type (ipc (create destroy getattr setattr read write associate unix_read unix_write)))
(allow subj_unconfined_type subj_type (netlink_route_socket (ioctl read write create getattr setattr lock relabelfrom relabelto
	append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind nlmsg_read nlmsg_write)))
(allow subj_unconfined_type subj_type (netlink_tcpdiag_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind nlmsg_read nlmsg_write)))
(allow subj_unconfined_type subj_type (netlink_nflog_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (netlink_xfrm_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind nlmsg_read nlmsg_write)))
(allow subj_unconfined_type subj_type (netlink_selinux_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (netlink_audit_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind nlmsg_read nlmsg_write
	nlmsg_relay nlmsg_readpriv nlmsg_tty_audit)))
(allow subj_unconfined_type subj_type (netlink_dnrt_socket (ioctl read write create getattr setattr lock relabelfrom relabelto
	append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (netlink_kobject_uevent_socket (ioctl read write create getattr setattr lock
	relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (appletalk_socket (ioctl read write create getattr setattr lock relabelfrom relabelto
	append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (key (view read write search link setattr create)))
(allow subj_unconfined_type subj_type create_dccp_stream_socket_perms)
(allow subj_unconfined_type subj_type (tun_socket (ioctl read write create getattr setattr lock relabelfrom relabelto append
	bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (binder (impersonate call set_context_mgr transfer)))
(allow subj_unconfined_type subj_type (netlink_iscsi_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (netlink_fib_lookup_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (netlink_connector_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (netlink_netfilter_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (netlink_generic_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (netlink_scsitransport_socket (ioctl read write create getattr setattr lock
	relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (netlink_rdma_socket (ioctl read write create getattr setattr lock relabelfrom relabelto
	append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))
(allow subj_unconfined_type subj_type (netlink_crypto_socket (ioctl read write create getattr setattr lock relabelfrom
	relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto name_bind)))

(call subj_dynamic_subj_type_transition_type (subj_unconfined_type))

(call subj_execheap_type (subj_unconfined_type))
(call subj_execmem_type (subj_unconfined_type))
(call subj_execstack_type (subj_unconfined_type))
(call subj_mmap_low_type (subj_unconfined_type))

(call standard_uncond_exemption_subj_type (subj_unconfined_type))
(call standard_obj_change_exemption_subj_type (subj_unconfined_type))

(allow subj_unconfined_type subj_entry_obj_type (file (entrypoint)))
(tunableif enable_rbacsep
	(true
		(context cpu_online_sysfs (sys.id sys.role cpu_online_sysfs.sysfs (systemlow systemlow)))
		(context cpu_sysfs (sys.id sys.role cpu_sysfs.sysfs (systemlow systemlow)))
		(context cpuinfo (sys.id sys.role cpuinfo.proc (systemlow systemlow)))
		(context crypto (sys.id sys.role crypto.sysctl (systemlow systemlow)))
		(context dev (sys.id sys.role dev.sysctl (systemlow systemlow)))
		(context fs_sysctl (sys.id sys.role fs_sysctl.sysctl (systemlow systemlow)))
		(context iomem (sys.id sys.role iomem.proc (systemlow systemlow)))
		(context irq (sys.id sys.role irq.sysctl (systemlow systemlow)))
		(context kallsyms (sys.id sys.role kallsyms.proc (systemlow systemlow)))
		(context kernel (sys.id sys.role kernel.sysctl (systemlow systemlow)))
		(context mdstat (sys.id sys.role mdstat.proc (systemlow systemlow)))
		(context memory_sysfs (sys.id sys.role memory_sysfs.sysfs (systemlow systemlow)))
		(context mtrr (sys.id sys.role mtrr.proc (systemlow systemlow)))
		(context net_proc (sys.id sys.role net_proc.proc (systemlow systemlow)))
		(context net_sysctl (sys.id sys.role net_sysctl.sysctl (systemlow systemlow)))
		(context net_unix (sys.id sys.role net_unix.sysctl (systemlow systemlow)))
		(context node_sysfs (sys.id sys.role node_sysfs.sysfs (systemlow systemlow)))
		(context node_online_sysfs (sys.id sys.role node_online_sysfs.sysfs (systemlow systemlow)))
		(context security (sys.id sys.role security.sysctl (systemlow systemlow)))
		(context sysctl (sys.id sys.role sysctl.sysctl (systemlow systemlow)))
		(context sys_load_kernel_module (sys.id sys.role sys_load_kernel_module.bool (systemlow systemlow)))
		(context sysrq (sys.id sys.role sysrq.proc (systemlow systemlow)))
		(context sys_var_log_file (sys.id sys.role sys.var_log_file (systemlow systemlow)))
		(context unlabeled (sys.id sys.role unlabeled.isid (systemlow systemlow)))
		(context usermodehelper (sys.id sys.role usermodehelper.sysctl (systemlow systemlow)))
		(context vm_overcommit (sys.id sys.role vm_overcommit.sysctl (systemlow systemlow)))
		(context vm (sys.id sys.role vm.sysctl (systemlow systemlow))))
	(false
		(context cpu_online_sysfs (sys.id object_r cpu_online_sysfs.sysfs (systemlow systemlow)))
		(context cpu_sysfs (sys.id object_r cpu_sysfs.sysfs (systemlow systemlow)))
		(context cpuinfo (sys.id object_r cpuinfo.proc (systemlow systemlow)))
		(context crypto (sys.id object_r crypto.sysctl (systemlow systemlow)))
		(context dev (sys.id object_r dev.sysctl (systemlow systemlow)))
		(context fs_sysctl (sys.id object_r fs_sysctl.sysctl (systemlow systemlow)))
		(context iomem (sys.id object_r iomem.proc (systemlow systemlow)))
		(context irq (sys.id object_r irq.sysctl (systemlow systemlow)))
		(context kallsyms (sys.id object_r kallsyms.proc (systemlow systemlow)))
		(context kernel (sys.id object_r kernel.sysctl (systemlow systemlow)))
		(context mdstat (sys.id object_r mdstat.proc (systemlow systemlow)))
		(context memory_sysfs (sys.id object_r memory_sysfs.sysfs (systemlow systemlow)))
		(context mtrr (sys.id object_r mtrr.proc (systemlow systemlow)))
		(context net_proc (sys.id object_r net_proc.proc (systemlow systemlow)))
		(context net_sysctl (sys.id object_r net_sysctl.sysctl (systemlow systemlow)))
		(context net_unix (sys.id object_r net_unix.sysctl (systemlow systemlow)))
		(context node_sysfs (sys.id object_r node_sysfs.sysfs (systemlow systemlow)))
		(context node_online_sysfs (sys.id object_r node_online_sysfs.sysfs (systemlow systemlow)))
		(context security (sys.id object_r security.sysctl (systemlow systemlow)))
		(context sysctl (sys.id object_r sysctl.sysctl (systemlow systemlow)))
		(context sys_load_kernel_module (sys.id object_r sys_load_kernel_module.bool (systemlow systemlow)))
		(context sysrq (sys.id object_r sysrq.proc (systemlow systemlow)))
		(context sys_var_log_file (sys.id object_r sys.var_log_file (systemlow systemlow)))
		(context unlabeled (sys.id object_r unlabeled.isid (systemlow systemlow)))
		(context usermodehelper (sys.id object_r usermodehelper.sysctl (systemlow systemlow)))
		(context vm_overcommit (sys.id object_r vm_overcommit.sysctl (systemlow systemlow)))
		(context vm (sys.id object_r vm.sysctl (systemlow systemlow)))))

(tunableif enable_mls
	(true
		(tunableif enable_rbacsep
			(true
				(context invalid (sys.id sys.role invalid.isid (systemhigh systemhigh)))
				(context kcore (sys.id sys.role kcore.proc (systemhigh systemhigh)))
				(context kmsg_proc (sys.id sys.role kmsg_proc.proc (systemhigh systemhigh)))
				(context sys (sys.id sys.role sys.subj (systemhigh systemhigh))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context invalid (sys.id object_r invalid.isid (systemhigh systemhigh)))
				(context kcore (sys.id object_r kcore.proc (systemhigh systemhigh)))
				(context kmsg_proc (sys.id object_r kmsg_proc.proc (systemhigh systemhigh)))
				(context sys (sys.id sys.role sys.subj (systemhigh systemhigh)))))))

(tunableif (not enable_mls)
	(true
		(tunableif enable_rbacsep
			(true
				(context invalid (sys.id sys.role invalid.isid (systemlow systemlow)))
				(context kcore (sys.id sys.role kcore.proc (systemlow systemlow)))
				(context kmsg_proc (sys.id sys.role kmsg_proc.proc (systemlow systemlow)))
				(context sys (sys.id sys.role sys.subj (systemlow systemlow))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context invalid (sys.id object_r invalid.isid (systemlow systemlow)))
				(context kcore (sys.id object_r kcore.proc (systemlow systemlow)))
				(context kmsg_proc (sys.id object_r kmsg_proc.proc (systemlow systemlow)))
				(context sys (sys.id sys.role sys.subj (systemlow systemlow)))))))

(filecon "/var/log/boot\.log" file sys_var_log_file)

(genfscon "proc" "/cpuinfo" cpuinfo)
(genfscon "proc" "/iomem" iomem)
(genfscon "proc" "/irq" irq)
(genfscon "proc" "/kallsyms" kallsyms)
(genfscon "proc" "/kcore" kcore)
(genfscon "proc" "/kmsg" kmsg_proc)
(genfscon "proc" "/mdstat" mdstat)
(genfscon "proc" "/mtrr" mtrr)
(genfscon "proc" "/net" net_proc)
(genfscon "proc" "/sys/crypto" crypto)
(genfscon "proc" "/sys/dev" dev)
(genfscon "proc" "/sys/fs" fs_sysctl)
(genfscon "proc" "/sys/fs/protected_hardlinks" security)
(genfscon "proc" "/sys/fs/protected_symlinks" security)
(genfscon "proc" "/sys/fs/suid_dumpable" security)
(genfscon "proc" "/sys/kernel/core_pattern" usermodehelper)
(genfscon "proc" "/sys/kernel/dmesg_restrict" security)
(genfscon "proc" "/sys/kernel" kernel)
(genfscon "proc" "/sys/kernel/kptr_restrict" security)
(genfscon "proc" "/sys/kernel/modprobe" usermodehelper)
(genfscon "proc" "/sys/kernel/modules_disabled" security)
(genfscon "proc" "/sys/kernel/poweroff_cmd" usermodehelper)
(genfscon "proc" "/sys/kernel/randomize_va_space" security)
(genfscon "proc" "/sys/kernel/usermodehelper" usermodehelper)
(genfscon "proc" "/sys/net" net_sysctl)
(genfscon "proc" "/sys/net/unix" net_unix)
(genfscon "proc" "/sysrq-trigger" sysrq)
(genfscon "proc" "/sys" sysctl)
(genfscon "proc" "/sys/vm/mmap_min_addr" security)
(genfscon "proc" "/sys/vm/overcommit_memory" vm_overcommit)
(genfscon "proc" "/sys/vm" vm)
(genfscon "selinuxfs" "/booleans/sys_load_kernel_module" sys_load_kernel_module)
(genfscon "sysfs" "/devices/system/cpu" cpu_sysfs)
(genfscon "sysfs" "/devices/system/cpu/online" cpu_online_sysfs)
(genfscon "sysfs" "/devices/system/memory" memory_sysfs)
(genfscon "sysfs" "/devices/system/node" node_sysfs)
(genfscon "sysfs" "/devices/system/node/online" node_online_sysfs)

(sidcontext file unlabeled)
(sidcontext kernel sys)
(sidcontext sysctl sysctl)
(sidcontext unlabeled invalid)
(block sys_proc_obj_blk
	(blockabstract sys_proc_obj_blk)

	(type proc)
	(call sys_proc_obj_type (proc)))

(block sys_sysctl_obj_blk
	(blockabstract sys_sysctl_obj_blk)

	(type sysctl)
	(call sys_sysctl_obj_type (sysctl)))

(block sys_sysfs_obj_blk
	(blockabstract sys_sysfs_obj_blk)

	(type sysfs)
	(call sys_sysfs_obj_type (sysfs)))

(block sys_isid_blk
	(blockabstract sys_isid_blk)
	(type isid))

(macro sys_obj_type ((type ARG1))
	(typeattributeset sys_obj_type ARG1))

(macro sys_subj_type ((type ARG1))
	(typeattributeset sys_subj_type ARG1))

(macro sys_role ((role ARG1))
	(roleattributeset sys_role ARG1))

(macro sys_roleallow_role ((role ARG1))
	(roleattributeset sys_roleallow_role ARG1))

(macro sys_audit_client_subj_type ((type ARG1))
	(typeattributeset sys_audit_client_subj_type ARG1))

(macro sys_mountpoint_obj_type ((type ARG1))
	(typeattributeset sys_mountpoint_obj_type ARG1))

(macro sys_proc_obj_type ((type ARG1))
	(typeattributeset sys_proc_obj_type ARG1))

(macro sys_sysctl_obj_type ((type ARG1))
	(typeattributeset sys_sysctl_obj_type ARG1))

(macro sys_sysfs_obj_type ((type ARG1))
	(typeattributeset sys_sysfs_obj_type ARG1))

(macro sys_get_sysvipc_info ((type ARG1))
	(allow ARG1 sys.subj (system (ipc_info))))

(macro sys_getattr_core_if ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 kcore.proc (file (getattr))))

(macro sys_read_ring_buffer ((type ARG1))
	(allow ARG1 self (capability2 (syslog)))
	(allow ARG1 sys.subj (system (syslog_read))))

(macro sys_change_ring_buffer_level ((type ARG1))
	(allow ARG1 self (capability2 (syslog)))
	(allow ARG1 sys.subj (system (syslog_console))))

(macro sys_dump_kernel_subj_type ((type ARG1))
	(allow ARG1 self (capability (sys_rawio)))
	(call fs_search_proc (ARG1))
	(allow ARG1 kcore.proc read_file_perms)
	(typeattributeset sys_dump_kernel_subj_type ARG1))

(macro sys_load_kernel_module_subj_type ((type ARG1))
	(typeattributeset sys_load_kernel_module_subj_type ARG1))

(macro sys_read_kernel_message_subj_type ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 kmsg_proc.proc read_file_perms)
	(typeattributeset sys_read_kernel_message_subj_type ARG1))

(macro sys_request_load_module ((type ARG1))
	(allow ARG1 sys.subj (system (module_request))))

(macro sys_audit_set_loginuid ((type ARG1))
	(allow ARG1 self (capability (audit_control)))
	(allow ARG1 self r_netlink_audit_socket_perms)
	(allow ARG1 self (netlink_audit_socket (nlmsg_relay))))

(macro sys_audit_set_tty_audit ((type ARG1))
	(allow ARG1 self r_netlink_audit_socket_perms)
	(allow ARG1 self (netlink_audit_socket (nlmsg_tty_audit))))

(macro sys_audit_set_params ((type ARG1))
	(allow ARG1 self (capability (audit_write audit_control)))
	(allow ARG1 self create_netlink_audit_socket_perms)
	(allow ARG1 self (netlink_audit_socket (nlmsg_relay))))

(macro sys_rw_inherited_netlink_audit_sockets ((type ARG1))
	(call sys_use_fd (ARG1))
	(allow ARG1 sys.subj (netlink_audit_socket (getattr read write))))

(macro sys_dontaudit_audit_access_mountpoint_dirs ((type ARG1))
	(dontaudit ARG1 sys_mountpoint_obj_type (dir (audit_access))))

(macro sys_getattr_mountpoints ((type ARG1))
	(allow ARG1 sys_mountpoint_obj_type (file (getattr)))
	(allow ARG1 sys_mountpoint_obj_type (dir (getattr)))
	(allow ARG1 sys_mountpoint_obj_type (fifo_file (getattr)))
	(allow ARG1 sys_mountpoint_obj_type (lnk_file (getattr)))
	(allow ARG1 sys_mountpoint_obj_type (sock_file (getattr)))
	(allow ARG1 sys_mountpoint_obj_type (chr_file (getattr)))
	(allow ARG1 sys_mountpoint_obj_type (blk_file (getattr))))

(macro sys_dontaudit_link_keyring ((type ARG1))
	(dontaudit ARG1 sys.subj (key (search link))))

(macro sys_link_keyring ((type ARG1))
	(allow ARG1 sys.subj (key (search link))))

(macro sys_mounton_kmsg_proc_files ((type ARG1))
	(allow ARG1 kmsg_proc.proc (file (mounton))))

(macro sys_setattr_mountpoint_dirs ((type ARG1))
	(allow ARG1 sys_mountpoint_obj_type (dir (setattr))))

(macro sys_rw_mountpoint_dirs ((type ARG1))
	(allow ARG1 sys_mountpoint_obj_type rw_dir_perms))

(macro sys_list_mountpoints ((type ARG1))
	(allow ARG1 sys_mountpoint_obj_type list_dir_perms))

(macro sys_dontaudit_list_mountpoints ((type ARG1))
	(dontaudit ARG1 sys_mountpoint_obj_type list_dir_perms))

(macro sys_search_mountpoints ((type ARG1))
	(allow ARG1 sys_mountpoint_obj_type search_dir_perms))

(macro sys_mounton_mountpoint_dirs ((type ARG1))
	(allow ARG1 sys_mountpoint_obj_type (dir (mounton))))

(macro sys_mountpoint_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call obj_type_transition_pattern (ARG1 sys_mountpoint_obj_type ARG2 ARG3 ARG4)))

(macro sys_dontaudit_audit_access_sysctl_dirs ((type ARG1))
	(dontaudit ARG1 sysctl.sysctl (dir (audit_access))))

(macro sys_list_sysctl ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 sysctl.sysctl list_dir_perms))

(macro sys_setattr_sysctl_dirs ((type ARG1))
	(allow ARG1 sysctl.sysctl (dir (setattr))))

(macro sys_mounton_sysctl_dirs ((type ARG1))
	(allow ARG1 sysctl.sysctl (dir (mounton))))

(macro sys_mounton_kernel_sysctl_files ((type ARG1))
	(allow ARG1 kernel.sysctl (file (mounton))))

(macro sys_rw_unix_dgram_sockets ((type ARG1))
	(allow ARG1 sys.subj rw_unix_dgram_socket_perms))

(macro sys_unix_dgram_sendto ((type ARG1))
	(allow ARG1 sys.subj (unix_dgram_socket (sendto))))

(macro sys_rw_unix_stream_sockets ((type ARG1))
	(allow ARG1 sys.subj rw_unix_stream_socket_perms))

(macro sys_rw_inherited_unix_stream_sockets ((type ARG1))
	(call sys_use_fd (ARG1))
	(allow ARG1 sys.subj rw_inherited_unix_stream_socket_perms))

(macro sys_unix_stream_connectto ((type ARG1))
	(allow ARG1 sys.subj (unix_stream_socket (connectto))))

(macro sys_manage_var_log_files ((type ARG1))
	(call file_rw_var_log_dirs (ARG1))
	(allow ARG1 sys.var_log_file manage_file_perms))

(macro sys_var_log_obj_type_transition_var_log ((type ARG1))
	(call file_var_log_obj_type_transition (ARG1 sys.var_log_file file "boot.log")))

(macro sys_search_sysctl ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 sysctl.sysctl search_dir_perms))

(macro sys_read_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 sysctl.sysctl read_file_perms))

(macro sys_rw_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 sysctl.sysctl rw_file_perms))

(macro sys_write_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 sysctl.sysctl write_file_perms))

(macro sys_search_irq_sysctl ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 irq.sysctl search_dir_perms))

(macro sys_read_irq_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call read_files_pattern (ARG1 irq.sysctl irq.sysctl)))

(macro sys_rw_irq_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call rw_files_pattern (ARG1 irq.sysctl irq.sysctl)))

(macro sys_write_irq_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call write_files_pattern (ARG1 irq.sysctl irq.sysctl)))

(macro sys_read_dev_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call read_files_pattern (ARG1 dev.sysctl dev.sysctl)))

(macro sys_rw_dev_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call rw_files_pattern (ARG1 dev.sysctl dev.sysctl)))

(macro sys_write_dev_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call write_files_pattern (ARG1 dev.sysctl dev.sysctl)))

(macro sys_search_crypto_sysctl ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 crypto.sysctl search_dir_perms))

(macro sys_read_crypto_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call read_files_pattern (ARG1 crypto.sysctl crypto.sysctl)))

(macro sys_rw_crypto_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call rw_files_pattern (ARG1 crypto.sysctl crypto.sysctl)))

(macro sys_write_crypto_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call write_files_pattern (ARG1 crypto.sysctl crypto.sysctl)))

(macro sys_search_fs_sysctl ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 fs_sysctl.sysctl search_dir_perms))

(macro sys_read_fs_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call read_files_pattern (ARG1 fs_sysctl.sysctl fs_sysctl.sysctl)))

(macro sys_rw_fs_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call rw_files_pattern (ARG1 fs_sysctl.sysctl fs_sysctl.sysctl)))

(macro sys_write_fs_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call write_files_pattern (ARG1 fs_sysctl.sysctl fs_sysctl.sysctl)))

(macro sys_search_kernel_sysctl ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 kernel.sysctl search_dir_perms))

(macro sys_read_kernel_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call read_files_pattern (ARG1 kernel.sysctl kernel.sysctl)))

(macro sys_rw_kernel_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call rw_files_pattern (ARG1 kernel.sysctl kernel.sysctl)))

(macro sys_write_kernel_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call write_files_pattern (ARG1 kernel.sysctl kernel.sysctl)))

(macro sys_search_net_sysctl ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 net_sysctl.sysctl search_dir_perms))

(macro sys_list_net_sysctl ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 net_sysctl.sysctl list_dir_perms))

(macro sys_read_net_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call read_files_pattern (ARG1 net_sysctl.sysctl net_sysctl.sysctl)))

(macro sys_rw_net_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call rw_files_pattern (ARG1 net_sysctl.sysctl net_sysctl.sysctl)))

(macro sys_write_net_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call write_files_pattern (ARG1 net_sysctl.sysctl net_sysctl.sysctl)))

(macro sys_search_net_unix_sysctl ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 net_unix.sysctl search_dir_perms))

(macro sys_list_net_unix_sysctl ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 net_unix.sysctl list_dir_perms))

(macro sys_read_net_unix_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call read_files_pattern (ARG1 net_unix.sysctl net_unix.sysctl)))

(macro sys_rw_net_unix_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call rw_files_pattern (ARG1 net_unix.sysctl net_unix.sysctl)))

(macro sys_write_net_unix_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call write_files_pattern (ARG1 net_unix.sysctl net_unix.sysctl)))

(macro sys_read_security_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 fs_sysctl.sysctl search_dir_perms)
	(allow ARG1 kernel.sysctl search_dir_perms)
	(allow ARG1 vm.sysctl search_dir_perms)
	(allow ARG1 security.sysctl read_file_perms))

(macro sys_rw_security_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 fs_sysctl.sysctl search_dir_perms)
	(allow ARG1 kernel.sysctl search_dir_perms)
	(allow ARG1 vm.sysctl search_dir_perms)
	(allow ARG1 security.sysctl rw_file_perms)
	(typeattributeset sys_write_security_and_usermodehelper_sysctl_subj_type ARG1))

(macro sys_read_usermodehelper_sysctl_files ((type ARG1))
	(call sys_search_kernel_sysctl (ARG1))
	(call read_files_pattern (ARG1 usermodehelper.sysctl usermodehelper.sysctl)))

(macro sys_rw_usermodehelper_sysctl_files ((type ARG1))
	(call sys_search_kernel_sysctl (ARG1))
	(call rw_files_pattern (ARG1 usermodehelper.sysctl usermodehelper.sysctl))
	(typeattributeset sys_write_security_and_usermodehelper_sysctl_subj_type ARG1))

(macro sys_search_vm_sysctl ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(allow ARG1 vm.sysctl search_dir_perms))

(macro sys_read_vm_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call read_files_pattern (ARG1 vm.sysctl vm.sysctl)))

(macro sys_rw_vm_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call rw_files_pattern (ARG1 vm.sysctl vm.sysctl)))

(macro sys_write_vm_sysctl_files ((type ARG1))
	(call sys_search_sysctl (ARG1))
	(call write_files_pattern (ARG1 vm.sysctl vm.sysctl)))

(macro sys_read_vm_overcommit_sysctl_files ((type ARG1))
	(call sys_search_vm_sysctl (ARG1))
	(allow ARG1 vm_overcommit.sysctl read_file_perms))

(macro sys_rw_vm_overcommit_sysctl_files ((type ARG1))
	(call sys_search_vm_sysctl (ARG1))
	(allow ARG1 vm_overcommit.sysctl rw_file_perms))

(macro sys_write_vm_overcommit_sysctl_files ((type ARG1))
	(call sys_search_vm_sysctl (ARG1))
	(allow ARG1 vm_overcommit.sysctl write_file_perms))

(macro sys_dontaudit_manage_all_sysctl_files ((type ARG1))
	(dontaudit ARG1 sys_sysctl_obj_type manage_file_perms))

(macro sys_dontaudit_read_all_sysctl ((type ARG1))
	(dontaudit ARG1 sys_sysctl_obj_type read_file_perms)
	(dontaudit ARG1 sys_sysctl_obj_type list_dir_perms)
	(dontaudit ARG1 sys_sysctl_obj_type read_lnk_file_perms))

(macro sys_read_all_sysctl ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 sys_sysctl_obj_type read_file_perms)
	(allow ARG1 sys_sysctl_obj_type list_dir_perms)
	(allow ARG1 sys_sysctl_obj_type read_lnk_file_perms))

(macro sys_getattr_all_sysctl_files ((type ARG1))
	(call getattr_files_pattern (ARG1 sys_sysctl_obj_type sys_sysctl_obj_type)))

(macro sys_getattr_all_sysctl_lnk_files ((type ARG1))
	(call getattr_lnk_files_pattern (ARG1 sys_sysctl_obj_type sys_sysctl_obj_type)))

(macro sys_list_all_sysctl ((type ARG1))
	(call fs_search_proc (ARG1))
	(call list_dirs_pattern (ARG1 sys_sysctl_obj_type sys_sysctl_obj_type)))

(macro sys_read_all_sysctl_files ((type ARG1))
	(call sys_read_crypto_sysctl_files (ARG1))
	(call sys_read_dev_sysctl_files (ARG1))
	(call sys_read_fs_sysctl_files (ARG1))
	(call sys_read_sysctl_files (ARG1))
	(call sys_read_kernel_sysctl_files (ARG1))
	(call sys_read_irq_sysctl_files (ARG1))
	(call sys_read_net_sysctl_files (ARG1))
	(call sys_read_net_unix_sysctl_files (ARG1))
	(call sys_read_security_sysctl_files (ARG1))
	(call sys_read_usermodehelper_sysctl_files (ARG1))
	(call sys_read_vm_sysctl_files (ARG1))
	(call sys_read_vm_overcommit_sysctl_files (ARG1)))

(macro sys_rw_all_sysctl_files ((type ARG1))
	(call sys_rw_crypto_sysctl_files (ARG1))
	(call sys_rw_dev_sysctl_files (ARG1))
	(call sys_rw_fs_sysctl_files (ARG1))
	(call sys_rw_sysctl_files (ARG1))
	(call sys_rw_kernel_sysctl_files (ARG1))
	(call sys_rw_irq_sysctl_files (ARG1))
	(call sys_rw_net_sysctl_files (ARG1))
	(call sys_rw_net_unix_sysctl_files (ARG1))
	(call sys_rw_security_sysctl_files (ARG1))
	(call sys_rw_usermodehelper_sysctl_files (ARG1))
	(call sys_rw_vm_sysctl_files (ARG1))
	(call sys_rw_vm_overcommit_sysctl_files (ARG1)))

(macro sys_read_cpuinfo_proc_files ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 cpuinfo.proc read_file_perms))

(macro sys_read_iomem_proc_files ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 iomem.proc read_file_perms))

(macro sys_read_kallsyms_proc_files ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 kallsyms.proc read_file_perms))

(macro sys_read_mdstat_proc_files ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 mdstat.proc read_file_perms))

(macro sys_search_net_proc ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 net_proc.proc search_dir_perms))

(macro sys_read_net_proc_files ((type ARG1))
	(call sys_search_net_proc (ARG1))
	(allow ARG1 net_proc.proc read_file_perms))

(macro sys_rw_net_proc_files ((type ARG1))
	(call sys_search_net_proc (ARG1))
	(allow ARG1 net_proc.proc rw_file_perms))

(macro sys_write_mtrr_proc_files ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 mtrr.proc write_file_perms))

(macro sys_dontaudit_manage_all_proc_files ((type ARG1))
	(dontaudit ARG1 sys_proc_obj_type manage_file_perms))

(macro sys_dontaudit_read_all_proc_files ((type ARG1))
	(dontaudit ARG1 sys_proc_obj_type read_file_perms))

(macro sys_read_all_proc_files ((type ARG1))
	(call fs_search_proc (ARG1))
	(call read_files_pattern (ARG1 sys_proc_obj_type sys_proc_obj_type))
	(typeattributeset sys_dump_kernel_subj_type ARG1)
	(typeattributeset sys_read_kernel_message_subj_type ARG1))

(macro sys_search_all_proc ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 sys_proc_obj_type search_dir_perms))

(macro sys_getattr_all_proc_files ((type ARG1))
	(call fs_search_proc (ARG1))
	(call getattr_files_pattern (ARG1 sys_proc_obj_type sys_proc_obj_type)))

(macro sys_getattr_all_proc_lnk_files ((type ARG1))
	(call fs_search_proc (ARG1))
	(call getattr_lnk_files_pattern (ARG1 sys_proc_obj_type sys_proc_obj_type)))

(macro sys_dontaudit_read_all_sysfs ((type ARG1))
	(dontaudit ARG1 sys_sysfs_obj_type read_file_perms)
	(dontaudit ARG1 sys_sysfs_obj_type list_dir_perms)
	(dontaudit ARG1 sys_sysfs_obj_type read_lnk_file_perms))

(macro sys_read_all_sysfs ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 sys_sysfs_obj_type read_file_perms)
	(allow ARG1 sys_sysfs_obj_type list_dir_perms)
	(allow ARG1 sys_sysfs_obj_type read_lnk_file_perms))

(macro sys_search_cpu_sysfs ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 cpu_sysfs.sysfs search_dir_perms))

(macro sys_list_cpu_sysfs ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 cpu_sysfs.sysfs list_dir_perms))

(macro sys_read_cpu_sysfs_files ((type ARG1))
	(call sys_read_cpu_online_sysfs_files (ARG1))
	(allow ARG1 cpu_sysfs.sysfs read_file_perms))

(macro sys_rw_cpu_sysfs_files ((type ARG1))
	(call sys_read_cpu_online_sysfs_files (ARG1))
	(allow ARG1 cpu_sysfs.sysfs rw_file_perms))

(macro sys_read_cpu_online_sysfs_files ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call read_files_pattern (ARG1 cpu_sysfs.sysfs cpu_online_sysfs.sysfs)))

(macro sys_search_memory_sysfs ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 memory_sysfs.sysfs search_dir_perms))

(macro sys_list_memory_sysfs ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 memory_sysfs.sysfs list_dir_perms))

(macro sys_read_memory_sysfs_files ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call read_files_pattern (ARG1 memory_sysfs.sysfs memory_sysfs.sysfs)))

(macro sys_rw_memory_sysfs_files ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call rw_files_pattern (ARG1 memory_sysfs.sysfs memory_sysfs.sysfs)))

(macro sys_search_node_sysfs ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 node_sysfs.sysfs search_dir_perms))

(macro sys_list_node_sysfs ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 node_sysfs.sysfs list_dir_perms))

(macro sys_read_node_sysfs_files ((type ARG1))
	(call sys_read_node_online_sysfs_files (ARG1))
	(allow ARG1 node_sysfs.sysfs read_file_perms))

(macro sys_rw_node_sysfs_files ((type ARG1))
	(call sys_read_node_online_sysfs_files (ARG1))
	(allow ARG1 node_sysfs.sysfs rw_file_perms))

(macro sys_read_node_online_sysfs_files ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call read_files_pattern (ARG1 node_sysfs.sysfs node_online_sysfs.sysfs)))

(macro sys_read_state_files ((type ARG1))
	(call fs_search_proc (ARG1))
	(call read_files_pattern (ARG1 sys.subj sys.subj)))

(macro sys_read_state_invalid ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 invalid.isid read_file_perms)
	(allow ARG1 invalid.isid list_dir_perms)
	(allow ARG1 invalid.isid read_lnk_file_perms))

(macro sys_search_invalid ((type ARG1))
	(allow ARG1 invalid.isid search_dir_perms))

(macro sys_list_invalid ((type ARG1))
	(allow ARG1 invalid.isid list_dir_perms))

(macro sys_read_invalid_files ((type ARG1))
	(call read_files_pattern (ARG1 invalid.isid invalid.isid)))

(macro sys_read_invalid_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 invalid.isid invalid.isid)))

(macro sys_manage_invalid_files ((type ARG1))
	(call manage_files_pattern (ARG1 invalid.isid invalid.isid)))

(macro sys_manage_invalid_dirs ((type ARG1))
	(allow ARG1 invalid.isid manage_dir_perms))

(macro sys_rw_invalid_dirs ((type ARG1))
	(allow ARG1 invalid.isid rw_dir_perms))

(macro sys_relabelfrom_invalid ((type ARG1))
	(allow ARG1 invalid.isid relabelfrom_file_perms)
	(allow ARG1 invalid.isid relabelfrom_dir_perms)
	(allow ARG1 invalid.isid relabelfrom_fifo_file_perms)
	(allow ARG1 invalid.isid relabelfrom_lnk_file_perms)
	(allow ARG1 invalid.isid relabelfrom_sock_file_perms)
	(allow ARG1 invalid.isid relabelfrom_blk_file_perms)
	(allow ARG1 invalid.isid relabelfrom_chr_file_perms))

(macro sys_relabelfrom_invalid_dirs ((type ARG1))
	(allow ARG1 invalid.isid relabelfrom_dir_perms))

(macro sys_search_unlabeled ((type ARG1))
	(allow ARG1 unlabeled.isid search_dir_perms))

(macro sys_list_unlabeled ((type ARG1))
	(allow ARG1 unlabeled.isid list_dir_perms))

(macro sys_read_unlabeled_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 unlabeled.isid unlabeled.isid)))

(macro sys_relabelfrom_unlabeled ((type ARG1))
	(allow ARG1 unlabeled.isid relabelfrom_file_perms)
	(allow ARG1 unlabeled.isid relabelfrom_dir_perms)
	(allow ARG1 unlabeled.isid relabelfrom_fifo_file_perms)
	(allow ARG1 unlabeled.isid relabelfrom_lnk_file_perms)
	(allow ARG1 unlabeled.isid relabelfrom_sock_file_perms)
	(allow ARG1 unlabeled.isid relabelfrom_blk_file_perms)
	(allow ARG1 unlabeled.isid relabelfrom_chr_file_perms))

(macro sys_recvfrom_unlabeled_tcp_sockets ((type ARG1))
	(allow ARG1 unlabeled.isid (tcp_socket (recvfrom))))

(macro sys_recvfrom_unlabeled_udp_sockets ((type ARG1))
	(allow ARG1 unlabeled.isid (udp_socket (recvfrom))))

(macro sys_recvfrom_unlabeled_rawip_sockets ((type ARG1))
	(allow ARG1 unlabeled.isid (rawip_socket (recvfrom))))

(macro sys_recvfrom_unlabeled_dccp_sockets ((type ARG1))
	(allow ARG1 unlabeled.isid (dccp_socket (recvfrom))))

(macro sys_recv_unlabeled_peers ((type ARG1))
	(allow ARG1 unlabeled.isid (peer (recv))))

(macro sys_send_sigchld ((type ARG1))
	(allow ARG1 sys.subj (process (sigchld))))

(macro sys_setkeycreate ((type ARG1))
	(allow ARG1 sys.subj (process (setkeycreate))))

(macro sys_setpgid ((type ARG1))
	(allow ARG1 sys.subj (process (setpgid))))

(macro sys_setsched ((type ARG1))
	(allow ARG1 sys.subj (process (setsched))))

(macro sys_share_state ((type ARG1))
	(allow ARG1 sys.subj (process (share))))

(macro sys_manual_subj_type_transition ((type ARG1))
	(allow ARG1 sys.subj (process (transition))))

(macro sys_use_fd ((type ARG1))
	(allow ARG1 sys.subj (fd (use))))

(macro sys_unconfined_subj_type ((type ARG1))
	(typeattributeset sys_unconfined_subj_type ARG1))
(boolean sys_load_kernel_module true)

(sid kernel)
(sid sysctl)
(sid unlabeled)
(sid file)

(typeattribute sys_mountpoint_obj_type)
(typeattribute sys_obj_type)

(typeattribute sys_proc_obj_type)
(typeattribute sys_sysctl_obj_type)
(typeattribute sys_sysfs_obj_type)

(typeattribute sys_subj_type)
(typeattribute sys_audit_client_subj_type)
(typeattribute sys_unconfined_subj_type)

(roleattribute sys_role)
(roleattribute sys_roleallow_role)

(block sys
	(user id)

	(role role)

	(blockinherit subj_common_blk)

	(userrole id role)
	(roletype role subj)

	(userlevel id systemlow)
	(userrange id (systemlow systemhigh))

	(roleallow role sys_roleallow_role)

	(blockinherit file_var_log_obj_blk)

	(allow subj self (capability (sys_tty_config sys_admin sys_nice net_admin net_bind_service)))
	(allow subj self (capability2 (block_suspend)))
	(allow subj self (process (setsched)))
	(allow subj self create_unix_stream_socket_perms)

	(allow subj var_log_file manage_file_perms)
	(call file_var_log_obj_type_transition (subj var_log_file file "boot.log"))

	(call sys_change_ring_buffer_level (subj))
	(call sys_request_load_module (subj))

	(call mls_priv_range_trans_subj_type (subj))

	(call dev_manage_all (subj))

	(call dev_devtmpfs_obj_type_transition_clock (subj))
	(call dev_devtmpfs_obj_type_transition_event (subj))
	(call dev_devtmpfs_obj_type_transition_kvm (subj))
	(call dev_devtmpfs_obj_type_transition_mei_misc (subj))
	(call dev_devtmpfs_obj_type_transition_mouse (subj))
	(call dev_devtmpfs_obj_type_transition_printer (subj))
	(call dev_devtmpfs_obj_type_transition_sound (subj))
	(call dev_devtmpfs_obj_type_transition_tpm (subj))
	(call dev_devtmpfs_obj_type_transition_usb (subj))
	(call dev_devtmpfs_obj_type_transition_v4l (subj))
	(call dev_devtmpfs_obj_type_transition_watchdog (subj))
	(call dev_devtmpfs_obj_type_transition_wireless (subj))

	(call file_read_data_files (subj))

	(call fs_dontaudit_write_devtmpfs_chr_files (subj))
	(call fs_list_rootfs (subj))
	(call fs_manage_devtmpfs_dirs (subj))
	(call fs_manage_devtmpfs_lnk_files (subj))
	(call fs_mounton_rootfs_dirs (subj))
	(call fs_read_debugfs (subj))
	(call fs_search_tmpfs (subj))

	(call sec_compute_create_context (subj))
	(call sec_list_fs (subj))

	(call term_devtmpfs_obj_type_transition_unallocated_tty (subj))

	(tunableif enable_rbacsep
		(true
			(call sys_role (role))
			(call rbacsep_exempt_role (role)))
		(false
			(userrole id object_r)))

	(optional sys_optional_storage
		(call storage_devtmpfs_obj_type_transition_fixed_disk (subj))
		(call storage_devtmpfs_obj_type_transition_removable (subj))
		(call storage_devtmpfs_obj_type_transition_scsi_generic (subj))))

(block invalid
	(blockinherit sys_isid_blk)

	(roletype sys.role isid)

	(allow isid self (process (sigchld)))

	(allow isid self rw_file_perms)
	(allow isid self list_dir_perms)
	(allow isid self read_lnk_file_perms)

	(call sys_mountpoint_obj_type (isid))

	(call fs_associate_fs (isid))
	(call fs_associate_tmpfs (isid))
	(call fs_search_proc (isid))

	(tunableif enable_rbacsep
		(false
			(roletype object_r isid))))

(block unlabeled
	(blockinherit sys_isid_blk)

	(call sys_obj_type (isid))

	(call fs_associate_devtmpfs (isid))
	(call fs_associate_fs (isid))
	(call fs_associate_tmpfs (isid)))

(block cpuinfo
	(blockinherit sys_proc_obj_blk))

(block iomem
	(blockinherit sys_proc_obj_blk))

(block kallsyms
	(blockinherit sys_proc_obj_blk))

(block kcore
	(blockinherit sys_proc_obj_blk))

(block kmsg_proc
	(blockinherit sys_proc_obj_blk))

(block mdstat
	(blockinherit sys_proc_obj_blk))

(block mtrr
	(blockinherit sys_proc_obj_blk))

(block net_proc
	(blockinherit sys_proc_obj_blk))

(block sysrq
	(blockinherit sys_proc_obj_blk))

(block sysctl
	(blockinherit sys_sysctl_obj_blk))

(block crypto
	(blockinherit sys_sysctl_obj_blk))

(block dev
	(blockinherit sys_sysctl_obj_blk))

(block fs_sysctl
	(blockinherit sys_sysctl_obj_blk)

	(call sys_mountpoint_obj_type (sysctl)))

(block irq
	(blockinherit sys_sysctl_obj_blk))

(block kernel
	(blockinherit sys_sysctl_obj_blk))

(block net_sysctl
	(blockinherit sys_sysctl_obj_blk))

(block net_unix
	(blockinherit sys_sysctl_obj_blk))

(block security
	(blockinherit sys_sysctl_obj_blk)

	(typeattributeset sys_security_or_usermodehelper_sysctl_obj_type sysctl))

(block usermodehelper
	(blockinherit sys_sysctl_obj_blk)

	(typeattributeset sys_security_or_usermodehelper_sysctl_obj_type sysctl))

(block vm
	(blockinherit sys_sysctl_obj_blk))

(block vm_overcommit
	(blockinherit sys_sysctl_obj_blk))

(block cpu_sysfs
        (blockinherit sys_sysfs_obj_blk))

(block cpu_online_sysfs
        (blockinherit sys_sysfs_obj_blk))

(block memory_sysfs
        (blockinherit sys_sysfs_obj_blk))

(block node_sysfs
        (blockinherit sys_sysfs_obj_blk))

(block node_online_sysfs
        (blockinherit sys_sysfs_obj_blk))

(block sys_load_kernel_module
	(blockinherit sec_bool_obj_blk))

(typeattribute sys_load_kernel_module_subj_type)
(typeattribute sys_not_load_kernel_module_subj_type)

(typeattributeset sys_not_load_kernel_module_subj_type (not sys_load_kernel_module_subj_type))
(neverallow sys_not_load_kernel_module_subj_type self (capability (sys_module)))

(typeattribute sys_read_kernel_message_subj_type)
(typeattribute sys_not_read_kernel_message_subj_type_or_sys_unconfined_subj_type)

(typeattributeset sys_not_read_kernel_message_subj_type_or_sys_unconfined_subj_type
	(not (sys_read_kernel_message_subj_type sys_unconfined_subj_type)))

(neverallow sys_not_read_kernel_message_subj_type_or_sys_unconfined_subj_type kmsg_proc.proc all_file_perms_except_getattr)

(typeattribute sys_dump_kernel_subj_type)
(typeattribute sys_not_dump_kernel_subj_type_or_sys_unconfined_subj_type)

(typeattributeset sys_not_dump_kernel_subj_type_or_sys_unconfined_subj_type
	(not (sys_dump_kernel_subj_type sys_unconfined_subj_type)))

(neverallow sys_not_dump_kernel_subj_type_or_sys_unconfined_subj_type kcore.proc all_file_perms_except_getattr)

(typeattribute sys_security_or_usermodehelper_sysctl_obj_type)
(typeattribute sys_not_security_or_usermodehelper_sysctl_obj_type)

(typeattribute sys_write_security_and_usermodehelper_sysctl_subj_type)
(typeattribute sys_not_write_security_and_usermodehelper_sysctl_subj_type)

(typeattributeset sys_not_write_security_and_usermodehelper_sysctl_subj_type
	(not (sys_write_security_and_usermodehelper_sysctl_subj_type)))

(neverallow sys_not_write_security_and_usermodehelper_sysctl_subj_type
	sys_security_or_usermodehelper_sysctl_obj_type (file (append write)))
; for flow requirement ;
(typeattributeset Harm (sys_not_write_security_and_usermodehelper_sysctl_subj_type))
(typeattributeset TCB sys_security_or_usermodehelper_sysctl_obj_type)
	
(typeattributeset sys_not_security_or_usermodehelper_sysctl_obj_type
	(and (sys_sysctl_obj_type) (not (sys_security_or_usermodehelper_sysctl_obj_type))))

(roletype sys_role sys_obj_type)

(allow sys_unconfined_subj_type sys_not_security_or_usermodehelper_sysctl_obj_type rw_file_perms)

(allow sys_unconfined_subj_type sys_security_or_usermodehelper_sysctl_obj_type read_file_perms)

(allow sys_unconfined_subj_type invalid.isid signal_perms)

(allow sys_unconfined_subj_type invalid.isid all_file_perms_except_mounton_execmod_and_entrypoint)
(allow sys_unconfined_subj_type invalid.isid all_dir_perms_except_mounton_and_execmod)
(allow sys_unconfined_subj_type invalid.isid all_fifo_file_perms_except_mounton_and_execmod)
(allow sys_unconfined_subj_type invalid.isid all_lnk_file_perms_except_mounton_and_execmod)
(allow sys_unconfined_subj_type invalid.isid all_sock_file_perms_except_mounton_and_execmod)
(allow sys_unconfined_subj_type invalid.isid all_chr_file_perms_except_mounton_and_execmod)
(allow sys_unconfined_subj_type invalid.isid all_blk_file_perms_except_mounton_and_execmod)

(allow sys_unconfined_subj_type invalid.isid (filesystem (mount remount unmount getattr relabelfrom relabelto associate
	quotamod quotaget)))

(allow sys_unconfined_subj_type sys_mountpoint_obj_type (dir (mounton)))

(allow sys_unconfined_subj_type unlabeled.isid all_file_perms_except_mounton_execmod_and_entrypoint)
(allow sys_unconfined_subj_type unlabeled.isid all_dir_perms_except_mounton_and_execmod)
(allow sys_unconfined_subj_type unlabeled.isid all_fifo_file_perms_except_mounton_and_execmod)
(allow sys_unconfined_subj_type unlabeled.isid all_lnk_file_perms_except_mounton_and_execmod)
(allow sys_unconfined_subj_type unlabeled.isid all_sock_file_perms_except_mounton_and_execmod)
(allow sys_unconfined_subj_type unlabeled.isid all_chr_file_perms_except_mounton_and_execmod)
(allow sys_unconfined_subj_type unlabeled.isid all_blk_file_perms_except_mounton_and_execmod)

(allow sys_unconfined_subj_type sys.subj (system (ipc_info syslog_read syslog_mod syslog_console module_request)))

(allow sys_unconfined_subj_type sys_proc_obj_type rw_file_perms)
(allow sys_unconfined_subj_type sys_proc_obj_type list_dir_perms)
(allow sys_unconfined_subj_type sys_proc_obj_type read_lnk_file_perms)

(allow sys_unconfined_subj_type sys_sysctl_obj_type list_dir_perms)
(allow sys_unconfined_subj_type sys_sysctl_obj_type read_lnk_file_perms)

(allow sys_unconfined_subj_type sys_sysfs_obj_type rw_file_perms)
(allow sys_unconfined_subj_type sys_sysfs_obj_type list_dir_perms)
(allow sys_unconfined_subj_type sys_sysfs_obj_type read_lnk_file_perms)

(call sys_load_kernel_module_subj_type (sys_unconfined_subj_type))

(call sys_obj_type (sys_proc_obj_type))
(call sys_obj_type (sys_sysctl_obj_type))
(call sys_obj_type (sys_sysfs_obj_type))

(allow sys_audit_client_subj_type self (capability (audit_write)))
(allow sys_audit_client_subj_type self r_netlink_audit_socket_perms)
(allow sys_audit_client_subj_type self (netlink_audit_socket (nlmsg_relay)))

(booleanif (sys_load_kernel_module) (true (allow sys_load_kernel_module_subj_type self
	(capability (sys_nice sys_module)))
	(allow sys_load_kernel_module_subj_type sys.subj (process (setsched)))))
(tunableif enable_rbacsep
	(true
		(context ld_so_cache (sys.id sys.role ld_so_cache.file (systemlow systemlow)))
		(context ld_so (sys.id sys.role ld_so.file (systemlow systemlow)))
		(context lib (sys.id sys.role lib.lib_file (systemlow systemlow))))
	(false
		(context ld_so_cache (sys.id object_r ld_so_cache.file (systemlow systemlow)))
		(context ld_so (sys.id object_r ld_so.file (systemlow systemlow)))
		(context lib (sys.id object_r lib.lib_file (systemlow systemlow)))))

(filecon "/etc/ld\.so\.cache.*" file ld_so_cache)
(filecon "/etc/ld\.so\.preload.*" file ld_so_cache)
(filecon "/usr/lib(/.*)?" any lib)
(filecon "/usr/libexec/sudo/.*" any lib)
(filecon "/usr/lib/ld-[^/]*\.so(\.[^/]*)*" file ld_so)
(filecon "/usr/lib" symlink lib)
(block lib_obj_blk
	(blockabstract lib_obj_blk)

	(type lib_file)
	(call lib_obj_type (lib_file)))

(macro lib_obj_type ((type ARG1))
	(typeattributeset lib_obj_type ARG1))

(macro lib_read_lib ((type ARG1))
	(call file_search_data (ARG1))
	(allow ARG1 lib.lib_file read_file_perms)
	(allow ARG1 lib.lib_file list_dir_perms)
	(allow ARG1 lib.lib_file read_lnk_file_perms))

(macro lib_read_lib_files ((type ARG1))
	(call lib_search_lib (ARG1))
	(allow ARG1 lib.lib_file read_file_perms))

(macro lib_delete_lib_files ((type ARG1))
	(call lib_del_entry_lib (ARG1))
	(allow ARG1 lib.lib_file delete_file_perms))

(macro lib_read_lib_lnk_files ((type ARG1))
	(call file_search_data (ARG1))
	(call read_lnk_files_pattern (ARG1 lib.lib_file lib.lib_file)))

(macro lib_search_lib ((type ARG1))
	(call file_search_data (ARG1))
	(allow ARG1 lib.lib_file read_lnk_file_perms)
	(allow ARG1 lib.lib_file search_dir_perms))

(macro lib_list_lib ((type ARG1))
	(call file_search_data (ARG1))
	(allow ARG1 lib.lib_file read_lnk_file_perms)
	(allow ARG1 lib.lib_file list_dir_perms))

(macro lib_rw_lib_dirs ((type ARG1))
	(call lib_search_lib (ARG1))
	(allow ARG1 lib.lib_file rw_dir_perms))

(macro lib_add_entry_lib ((type ARG1))
	(call lib_search_lib (ARG1))
	(allow ARG1 lib.lib_file add_entry_dir_perms))

(macro lib_del_entry_lib ((type ARG1))
	(call lib_search_lib (ARG1))
	(allow ARG1 lib.lib_file del_entry_dir_perms))

(macro lib_create_lib_lnk_files ((type ARG1))
	(call lib_add_entry_lib (ARG1))
	(allow ARG1 lib.lib_file create_lnk_file_perms))

(macro lib_manage_lib ((type ARG1))
	(call file_rw_data_dirs (ARG1))
	(allow ARG1 lib.lib_file manage_file_perms)
	(allow ARG1 lib.lib_file manage_dir_perms)
	(allow ARG1 lib.lib_file manage_lnk_file_perms))

(macro lib_exec_ld_so_files ((type ARG1))
	(call lib_list_lib (ARG1))
	(allow ARG1 ld_so.file exec_file_perms))

(macro lib_use_ld_so ((type ARG1))
	(call lib_list_lib (ARG1))
	(allow ARG1 ld_so.file mmap_file_perms)
	(call lib_read_ld_so_cache_files (ARG1)))

(macro lib_read_ld_so_cache_files ((type ARG1))
	(call file_search_config (ARG1))
	(allow ARG1 ld_so_cache.file read_file_perms))

(macro lib_manage_ld_so_cache_files ((type ARG1))
	(call file_rw_config_dirs (ARG1))
	(allow ARG1 ld_so_cache.file manage_file_perms))

(macro lib_config_obj_type_transition_ld_so_cache_files ((type ARG1))
	(call file_config_obj_type_transition (ARG1 ld_so_cache.file file "ld.so.cache"))
	(call file_config_obj_type_transition (ARG1 ld_so_cache.file file "ld.so.cache~"))
	(call file_config_obj_type_transition (ARG1 ld_so_cache.file file "ld.so.preload"))
	(call file_config_obj_type_transition (ARG1 ld_so_cache.file file "ld.so.preload~")))

(macro lib_use_all_libs ((type ARG1))
	(call lib_list_lib (ARG1))
	(allow ARG1 lib_obj_type mmap_file_perms)
	(allow ARG1 textrel.lib_file (file (execmod))))

(macro lib_manage_lib_files ((type ARG1))
	(call lib_rw_lib_dirs (ARG1))
	(allow ARG1 lib.lib_file manage_file_perms))
(typeattribute lib_obj_type)

(block lib
	(blockinherit lib_obj_blk))

(block textrel
	(blockinherit lib_obj_blk))

(block ld_so
	(blockinherit file_obj_blk))

(block ld_so_cache
	(blockinherit file_obj_blk))

(call file_obj_type (lib_obj_type))
(tunableif enable_rbacsep
	(true
		(context aio (sys.id sys.role aio.fs (systemlow systemlow)))
		(context anon_inodefs (sys.id sys.role anon_inodefs.fs (systemlow systemlow)))
		(context autofs_fs (sys.id sys.role autofs_fs.fs (systemlow systemlow)))
		(context bdev (sys.id sys.role bdev.fs (systemlow systemlow)))
		(context binfmt_misc (sys.id sys.role binfmt_misc.fs (systemlow systemlow)))
		(context cgroup (sys.id sys.role cgroup.fs (systemlow systemlow)))
		(context cifs (sys.id sys.role cifs.fs (systemlow systemlow)))
		(context configfs (sys.id sys.role configfs.fs (systemlow systemlow)))
		(context debugfs (sys.id sys.role debugfs.fs (systemlow systemlow)))
		(context devpts (sys.id sys.role devpts.fs (systemlow systemlow)))
		(context devtmpfs (sys.id sys.role devtmpfs.fs (systemlow systemlow)))
		(context dosfs (sys.id sys.role dosfs.fs (systemlow systemlow)))
		(context drm (sys.id sys.role drm.fs (systemlow systemlow)))
		(context efivarfs (sys.id sys.role efivarfs.fs (systemlow systemlow)))
		(context fs (sys.id sys.role fs.fs (systemlow systemlow)))
		(context fs_use_dosfs (sys.id sys.role fs_use_dosfs.bool (systemlow systemlow)))
		(context fs_use_cifs (sys.id sys.role fs_use_cifs.bool (systemlow systemlow)))
		(context fs_use_fuse (sys.id sys.role fs_use_fuse.bool (systemlow systemlow)))
		(context fs_use_iso9660 (sys.id sys.role fs_use_iso9660.bool (systemlow systemlow)))
		(context fs_use_nfs (sys.id sys.role fs_use_nfs.bool (systemlow systemlow)))
		(context fs_use_removable (sys.id sys.role fs_use_removable.bool (systemlow systemlow)))
		(context fuse (sys.id sys.role fuse_fs.fs (systemlow systemlow)))
		(context hugetlbfs (sys.id sys.role hugetlbfs.fs (systemlow systemlow)))
		(context iso9660 (sys.id sys.role iso9660.fs (systemlow systemlow)))
		(context nfs (sys.id sys.role nfs.fs (systemlow systemlow)))
		(context nfsd (sys.id sys.role nfsd.fs (systemlow systemlow)))
		(context proc (sys.id sys.role proc.fs (systemlow systemlow)))
		(context pstore (sys.id sys.role pstore.fs (systemlow systemlow)))
		(context rootfs (sys.id sys.role rootfs.fs (systemlow systemlow)))
		(context rpc_pipefs (sys.id sys.role rpc_pipefs.fs (systemlow systemlow)))
		(context sysfs (sys.id sys.role sysfs.fs (systemlow systemlow)))
		(context tmpfs (sys.id sys.role tmpfs.fs (systemlow systemlow)))
		(context tracefs (sys.id sys.role tracefs.fs (systemlow systemlow))))
	(false
		(context aio (sys.id object_r aio.fs (systemlow systemlow)))
		(context anon_inodefs (sys.id object_r anon_inodefs.fs (systemlow systemlow)))
		(context autofs_fs (sys.id object_r autofs_fs.fs (systemlow systemlow)))
		(context bdev (sys.id object_r bdev.fs (systemlow systemlow)))
		(context binfmt_misc (sys.id object_r binfmt_misc.fs (systemlow systemlow)))
		(context cgroup (sys.id object_r cgroup.fs (systemlow systemlow)))
		(context cifs (sys.id object_r cifs.fs (systemlow systemlow)))
		(context configfs (sys.id object_r configfs.fs (systemlow systemlow)))
		(context debugfs (sys.id object_r debugfs.fs (systemlow systemlow)))
		(context devpts (sys.id object_r devpts.fs (systemlow systemlow)))
		(context devtmpfs (sys.id object_r devtmpfs.fs (systemlow systemlow)))
		(context dosfs (sys.id object_r dosfs.fs (systemlow systemlow)))
		(context drm (sys.id object_r drm.fs (systemlow systemlow)))
		(context efivarfs (sys.id object_r efivarfs.fs (systemlow systemlow)))
		(context fs (sys.id object_r fs.fs (systemlow systemlow)))
		(context fs_use_dosfs (sys.id object_r fs_use_dosfs.bool (systemlow systemlow)))
		(context fs_use_cifs (sys.id object_r fs_use_cifs.bool (systemlow systemlow)))
		(context fs_use_fuse (sys.id object_r fs_use_fuse.bool (systemlow systemlow)))
		(context fs_use_iso9660 (sys.id object_r fs_use_iso9660.bool (systemlow systemlow)))
		(context fs_use_nfs (sys.id object_r fs_use_nfs.bool (systemlow systemlow)))
		(context fs_use_removable (sys.id object_r fs_use_removable.bool (systemlow systemlow)))
		(context fuse (sys.id object_r fuse_fs.fs (systemlow systemlow)))
		(context hugetlbfs (sys.id object_r hugetlbfs.fs (systemlow systemlow)))
		(context iso9660 (sys.id object_r iso9660.fs (systemlow systemlow)))
		(context nfs (sys.id object_r nfs.fs (systemlow systemlow)))
		(context nfsd (sys.id object_r nfsd.fs (systemlow systemlow)))
		(context proc (sys.id object_r proc.fs (systemlow systemlow)))
		(context pstore (sys.id object_r pstore.fs (systemlow systemlow)))
		(context rootfs (sys.id object_r rootfs.fs (systemlow systemlow)))
		(context rpc_pipefs (sys.id object_r rpc_pipefs.fs (systemlow systemlow)))
		(context sysfs (sys.id object_r sysfs.fs (systemlow systemlow)))
		(context tmpfs (sys.id object_r tmpfs.fs (systemlow systemlow)))
		(context tracefs (sys.id object_r tracefs.fs (systemlow systemlow)))))

(filecon "/dev(/.*)?" any ())
(filecon "/dev" dir devtmpfs)
(filecon "/" dir rootfs)
(filecon "/proc(/.*)?" any ())
(filecon "/proc" dir proc)
(filecon "/sys(/.*)?" any ())
(filecon "/sys" dir sysfs)
(filecon "/tmp(/.*)?" any ())
(filecon "/tmp" dir tmpfs)
(filecon "/var/run/user(/.*)?" any ())

(fsuse task "nsfs" fs)
(fsuse task "pipefs" fs)
(fsuse task "sockfs" fs)
(fsuse trans "devpts" devpts)
(fsuse trans "devtmpfs" devtmpfs)
(fsuse trans "hugetlbfs" hugetlbfs)
(fsuse trans "mqueue" tmpfs)
(fsuse trans "tmpfs" tmpfs)
(fsuse xattr "ext4" fs)
(fsuse xattr "xfs" fs)

(genfscon "afs" "/" nfs)
(genfscon "aio" "/" aio)
(genfscon "anon_inodefs" "/" anon_inodefs)
(genfscon "autofs" "/" autofs_fs)
(genfscon "bdev" "/" bdev)
(genfscon "binfmt_misc" "/" binfmt_misc)
(genfscon "cgroup" "/" cgroup)
(genfscon "cifs" "/" cifs)
(genfscon "configfs" "/" configfs)
(genfscon "debugfs" "/" debugfs)
(genfscon "drm" "/" drm)
(genfscon "efivarfs" "/" efivarfs)
(genfscon "fuseblk" "/" fuse)
(genfscon "fusectl" "/" fuse)
(genfscon "fuse" "/" fuse)
(genfscon "iso9660" "/" iso9660)
(genfscon "lustre" "/" nfs)
(genfscon "nfs" "/" nfs)
(genfscon "nfs4" "/" nfs)
(genfscon "nfsd" "/" nfsd)
(genfscon "proc" "/" proc)
(genfscon "proc" "/sysvipc" proc) ; BUG
(genfscon "pstore" "/" pstore)
(genfscon "rootfs" "/" rootfs)
(genfscon "rpc_pipefs" "/" rpc_pipefs)
(genfscon "selinuxfs" "/booleans/fs_use_dosfs" fs_use_dosfs)
(genfscon "selinuxfs" "/booleans/fs_use_cifs" fs_use_cifs)
(genfscon "selinuxfs" "/booleans/fs_use_fuse" fs_use_fuse)
(genfscon "selinuxfs" "/booleans/fs_use_iso9660" fs_use_iso9660)
(genfscon "selinuxfs" "/booleans/fs_use_nfs" fs_use_nfs)
(genfscon "selinuxfs" "/booleans/fs_use_removable" fs_use_removable)
(genfscon "smbfs" "/" cifs)
(genfscon "sysfs" "/" sysfs)
(genfscon "tracefs" "/" tracefs)
(genfscon "vfat" "/" dosfs)

(sidcontext fs fs)
(block fs_obj_blk
	(blockabstract fs_obj_blk)

	(type fs)
	(call fs_obj_type (fs)))

(macro fs_trace_client_subj_type ((type ARG1))
	(typeattributeset fs_trace_client_subj_type ARG1))

(macro fs_read_cifs_subj_type ((type ARG1))
	(typeattributeset fs_read_cifs_subj_type ARG1))

(macro fs_manage_cifs_subj_type ((type ARG1))
	(typeattributeset fs_manage_cifs_subj_type ARG1))

(macro fs_read_dosfs_subj_type ((type ARG1))
	(typeattributeset fs_read_dosfs_subj_type ARG1))

(macro fs_manage_dosfs_subj_type ((type ARG1))
	(typeattributeset fs_manage_dosfs_subj_type ARG1))

(macro fs_read_fuse_subj_type ((type ARG1))
	(typeattributeset fs_read_fuse_subj_type ARG1))

(macro fs_manage_fuse_subj_type ((type ARG1))
	(typeattributeset fs_manage_fuse_subj_type ARG1))

(macro fs_read_iso9660_subj_type ((type ARG1))
	(typeattributeset fs_read_iso9660_subj_type ARG1))

(macro fs_read_nfs_subj_type ((type ARG1))
	(typeattributeset fs_read_nfs_subj_type ARG1))

(macro fs_manage_nfs_subj_type ((type ARG1))
	(typeattributeset fs_manage_nfs_subj_type ARG1))

(macro fs_read_removable_subj_type ((type ARG1))
	(typeattributeset fs_read_removable_subj_type ARG1))

(macro fs_manage_removable_subj_type ((type ARG1))
	(typeattributeset fs_manage_removable_subj_type ARG1))

(macro fs_obj_type ((type ARG1))
	(typeattributeset fs_obj_type ARG1))

(macro fs_associate_fs ((type ARG1))
	(allow ARG1 fs.fs (filesystem (associate))))

(macro fs_associate_devtmpfs ((type ARG1))
	(allow ARG1 devtmpfs.fs (filesystem (associate))))

(macro fs_associate_devpts ((type ARG1))
	(allow ARG1 devpts.fs (filesystem (associate))))

(macro fs_associate_tmpfs ((type ARG1))
	(allow ARG1 tmpfs.fs (filesystem (associate))))

(macro fs_getattr_fs ((type ARG1))
	(allow ARG1 fs.fs (filesystem (getattr))))

(macro fs_mount_fs ((type ARG1))
	(allow ARG1 fs.fs (filesystem (mount))))

(macro fs_remount_fs ((type ARG1))
	(allow ARG1 fs.fs (filesystem (remount))))

(macro fs_unmount_fs ((type ARG1))
	(allow ARG1 fs.fs (filesystem (unmount))))

(macro fs_get_fs_quotas ((type ARG1))
	(allow ARG1 fs.fs (filesystem (quotaget))))

(macro fs_mod_fs_quotas ((type ARG1))
	(allow ARG1 fs.fs (filesystem (quotamod))))

(macro fs_search_autofs ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 autofs_fs.fs search_dir_perms))

(macro fs_list_autofs ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 autofs_fs.fs list_dir_perms))

(macro fs_mount_autofs_fs ((type ARG1))
	(allow ARG1 autofs_fs.fs (filesystem (mount))))

(macro fs_search_binfmt_misc ((type ARG1))
	(call fs_search_autofs (ARG1))
	(allow ARG1 binfmt_misc.fs search_dir_perms))

(macro fs_list_binfmt_misc ((type ARG1))
	(call fs_list_autofs (ARG1))
	(allow ARG1 binfmt_misc.fs list_dir_perms))

(macro fs_read_binfmt_misc_files ((type ARG1))
	(call fs_search_autofs (ARG1))
	(call read_files_pattern (ARG1 binfmt_misc.fs binfmt_misc.fs)))

(macro fs_read_binfmt_misc_lnk_files ((type ARG1))
	(call fs_search_autofs (ARG1))
	(call read_lnk_files_pattern (ARG1 binfmt_misc.fs binfmt_misc.fs)))

(macro fs_read_binfmt_misc ((type ARG1))
	(call fs_search_autofs (ARG1))
	(allow ARG1 binfmt_misc.fs read_file_perms)
	(allow ARG1 binfmt_misc.fs list_dir_perms)
	(allow ARG1 binfmt_misc.fs read_lnk_file_perms))

(macro fs_search_cgroup ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call fs_read_tmpfs_lnk_files (ARG1))
	(allow ARG1 cgroup.fs search_dir_perms))

(macro fs_list_cgroup ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call fs_read_tmpfs_lnk_files (ARG1))
	(allow ARG1 cgroup.fs list_dir_perms))

(macro fs_getattr_cgroup_fs ((type ARG1))
	(allow ARG1 cgroup.fs (filesystem (getattr))))

(macro fs_read_cgroup_files ((type ARG1))
	(call fs_search_cgroup (ARG1))
	(allow ARG1 cgroup.fs read_file_perms))

(macro fs_write_cgroup_files ((type ARG1))
	(call fs_search_cgroup (ARG1))
	(allow ARG1 cgroup.fs write_file_perms))

(macro fs_setattr_cgroup_dirs ((type ARG1))
	(call fs_search_cgroup (ARG1))
	(allow ARG1 cgroup.fs (dir (setattr))))

(macro fs_setattr_cgroup_files ((type ARG1))
	(call fs_search_cgroup (ARG1))
	(allow ARG1 cgroup.fs (file (setattr))))

(macro fs_rw_cgroup_files ((type ARG1))
	(call fs_search_cgroup (ARG1))
	(allow ARG1 cgroup.fs rw_file_perms))

(macro fs_add_entry_cgroup ((type ARG1))
	(call fs_search_cgroup (ARG1))
	(allow ARG1 cgroup.fs add_entry_dir_perms))

(macro fs_del_entry_cgroup ((type ARG1))
	(call fs_search_cgroup (ARG1))
	(allow ARG1 cgroup.fs del_entry_dir_perms))

(macro fs_delete_cgroup_dirs ((type ARG1))
	(call fs_del_entry_cgroup (ARG1))
	(allow ARG1 cgroup.fs delete_dir_perms))

(macro fs_manage_cgroup_dirs ((type ARG1))
	(call fs_search_cgroup (ARG1))
	(allow ARG1 cgroup.fs manage_dir_perms))

(macro fs_read_cgroup_lnk_files ((type ARG1))
	(call fs_search_cgroup (ARG1))
	(allow ARG1 cgroup.fs read_lnk_file_perms))

(macro fs_read_cgroup ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call fs_read_tmpfs_lnk_files (ARG1))
	(allow ARG1 cgroup.fs read_file_perms)
	(allow ARG1 cgroup.fs list_dir_perms)
	(allow ARG1 cgroup.fs read_lnk_file_perms))

(macro fs_mounton_cgroup_dirs ((type ARG1))
	(allow ARG1 cgroup.fs (dir (mounton))))

(macro fs_mount_cgroup_fs ((type ARG1))
	(allow ARG1 cgroup.fs (filesystem (mount))))

(macro fs_remount_cgroup_fs ((type ARG1))
	(allow ARG1 cgroup.fs (filesystem (remount))))

(macro fs_search_cifs ((type ARG1))
	(allow ARG1 cifs.fs search_dir_perms))

(macro fs_list_cifs ((type ARG1))
	(allow ARG1 cifs.fs list_dir_perms))

(macro fs_read_cifs_files ((type ARG1))
	(call read_files_pattern (ARG1 cifs.fs cifs.fs)))

(macro fs_read_cifs ((type ARG1))
	(allow ARG1 cifs.fs list_dir_perms)
	(allow ARG1 cifs.fs read_file_perms)
	(allow ARG1 cifs.fs read_lnk_file_perms))

(macro fs_manage_cifs ((type ARG1))
	(allow ARG1 cifs.fs manage_dir_perms)
	(allow ARG1 cifs.fs manage_file_perms)
	(allow ARG1 cifs.fs manage_lnk_file_perms))

(macro fs_getattr_cifs_fs ((type ARG1))
	(allow ARG1 cifs.fs (filesystem (getattr))))

(macro fs_search_debugfs ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 debugfs.fs search_dir_perms))

(macro fs_list_debugfs ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 debugfs.fs list_dir_perms))

(macro fs_read_debugfs_files ((type ARG1))
	(call fs_search_proc (ARG1))
	(call read_files_pattern (ARG1 debugfs.fs debugfs.fs)))

(macro fs_read_debugfs ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 debugfs.fs list_dir_perms)
	(allow ARG1 debugfs.fs read_file_perms)
	(allow ARG1 debugfs.fs read_lnk_file_perms))

(macro fs_getattr_debugfs_fs ((type ARG1))
	(allow ARG1 debugfs.fs (filesystem (getattr))))

(macro fs_search_devpts ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 devpts.fs search_dir_perms))

(macro fs_list_devpts ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 devpts.fs list_dir_perms))

(macro fs_getattr_devpts_fs ((type ARG1))
	(allow ARG1 devpts.fs (filesystem (getattr))))

(macro fs_getattr_devpts_chr_files ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call getattr_chr_files_pattern (ARG1 devpts.fs devpts.fs)))

(macro fs_relabel_devpts_chr_files ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 devpts.fs relabel_chr_file_perms))

(macro fs_rw_devpts_chr_files ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call rw_chr_files_pattern (ARG1 devpts.fs devpts.fs)))

(macro fs_write_inherited_devpts_chr_files ((type ARG1))
	(allow ARG1 devpts.fs write_inherited_chr_file_perms))

(macro fs_relabelfrom_devpts_fs ((type ARG1))
	(allow ARG1 devpts.fs (filesystem (relabelfrom))))

(macro fs_devpts_obj_type_transition ((type ARG1)(type ARG2) (class ARG3)(name ARG4))
	(call fs_search_devtmpfs (ARG1))
	(call obj_type_transition_pattern (ARG1 devpts.fs ARG2 ARG3 ARG4)))

(macro fs_mount_devpts_fs ((type ARG1))
	(allow ARG1 devpts.fs (filesystem (mount))))

(macro fs_remount_devpts_fs ((type ARG1))
	(allow ARG1 devpts.fs (filesystem (remount))))

(macro fs_list_devtmpfs ((type ARG1))
	(allow ARG1 devtmpfs.fs list_dir_perms))

(macro fs_getattr_devtmpfs_fs ((type ARG1))
	(allow ARG1 devtmpfs.fs (filesystem (getattr))))

(macro fs_read_devtmpfs_files ((type ARG1))
	(call read_files_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_read_devtmpfs_chr_files ((type ARG1))
	(call read_chr_files_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_dontaudit_write_devtmpfs_chr_files ((type ARG1))
	(dontaudit ARG1 devtmpfs.fs (chr_file (write))))

(macro fs_dontaudit_getattr_devtmpfs_lnk_files ((type ARG1))
	(dontaudit ARG1 devtmpfs.fs (lnk_file (getattr))))

(macro fs_read_devtmpfs_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_read_devtmpfs ((type ARG1))
	(allow ARG1 devtmpfs.fs read_file_perms)
	(allow ARG1 devtmpfs.fs list_dir_perms)
	(allow ARG1 devtmpfs.fs read_lnk_file_perms))

(macro fs_audit_access_devtmpfs_dirs ((type ARG1))
	(allow ARG1 devtmpfs.fs (dir (write))))

(macro fs_setattr_devtmpfs_dirs ((type ARG1))
	(allow ARG1 devtmpfs.fs (dir (setattr))))

(macro fs_manage_devtmpfs_files ((type ARG1))
	(call manage_files_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_manage_devtmpfs_chr_files ((type ARG1))
	(call manage_chr_files_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_add_entry_devtmpfs ((type ARG1))
	(allow ARG1 devtmpfs.fs add_entry_dir_perms))

(macro fs_del_entry_devtmpfs ((type ARG1))
	(allow ARG1 devtmpfs.fs del_entry_dir_perms))

(macro fs_create_devtmpfs_chr_files ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 devtmpfs.fs create_chr_file_perms))

(macro fs_setattr_devtmpfs_chr_files ((type ARG1))
	(allow ARG1 devtmpfs.fs (chr_file (setattr))))

(macro fs_create_devtmpfs_blk_files ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 devtmpfs.fs create_blk_file_perms))

(macro fs_setattr_devtmpfs_blk_files ((type ARG1))
	(allow ARG1 devtmpfs.fs (blk_file (setattr))))

(macro fs_relabel_devtmpfs_dirs ((type ARG1))
	(call relabel_dirs_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_relabelfrom_devtmpfs_dirs ((type ARG1))
	(call relabelfrom_dirs_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_relabelfrom_devtmpfs_chr_files ((type ARG1))
	(call relabelfrom_chr_files_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_relabelfrom_devtmpfs_blk_files ((type ARG1))
	(call relabelfrom_blk_files_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_dontaudit_getattr_devtmpfs_chr_files ((type ARG1))
	(dontaudit ARG1 devtmpfs.fs (chr_file (getattr))))

(macro fs_dontaudit_getattr_devtmpfs_blk_files ((type ARG1))
	(dontaudit ARG1 devtmpfs.fs (blk_file (getattr))))

(macro fs_manage_devtmpfs_blk_files ((type ARG1))
	(call manage_blk_files_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_manage_devtmpfs_dirs ((type ARG1))
	(call manage_dirs_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_manage_devtmpfs_lnk_files ((type ARG1))
	(call manage_lnk_files_pattern (ARG1 devtmpfs.fs devtmpfs.fs)))

(macro fs_mounton_devtmpfs_dirs ((type ARG1))
	(allow ARG1 devtmpfs.fs (dir (mounton))))

(macro fs_search_devtmpfs ((type ARG1))
	(allow ARG1 devtmpfs.fs search_dir_perms))

(macro fs_rw_devtmpfs_dirs ((type ARG1))
	(allow ARG1 devtmpfs.fs rw_dir_perms))

(macro fs_devtmpfs_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call obj_type_transition_pattern (ARG1 devtmpfs.fs ARG2 ARG3 ARG4)))

(macro fs_search_dosfs ((type ARG1))
	(allow ARG1 dosfs.fs search_dir_perms))

(macro fs_list_dosfs ((type ARG1))
	(allow ARG1 dosfs.fs list_dir_perms))

(macro fs_getattr_dosfs_fs ((type ARG1))
	(allow ARG1 dosfs.fs (filesystem (getattr))))

(macro fs_read_dosfs_files ((type ARG1))
	(call read_files_pattern (ARG1 dosfs.fs dosfs.fs)))

(macro fs_manage_dosfs_files ((type ARG1))
	(call manage_files_pattern (ARG1 dosfs.fs dosfs.fs)))

(macro fs_read_dosfs_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 dosfs.fs dosfs.fs)))

(macro fs_read_dosfs ((type ARG1))
	(allow ARG1 dosfs.fs read_file_perms)
	(allow ARG1 dosfs.fs list_dir_perms)
	(allow ARG1 dosfs.fs read_lnk_file_perms))

(macro fs_manage_dosfs ((type ARG1))
	(allow ARG1 dosfs.fs manage_file_perms)
	(allow ARG1 dosfs.fs manage_dir_perms)
	(allow ARG1 dosfs.fs manage_lnk_file_perms))

(macro fs_remount_dosfs_fs ((type ARG1))
	(allow ARG1 dosfs.fs (filesystem (remount))))

(macro fs_search_efivarfs ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 efivarfs.fs search_dir_perms))

(macro fs_list_efivarfs ((type ARG1))
	(call fs_search_proc (ARG1))
	(allow ARG1 efivarfs.fs list_dir_perms))

(macro fs_getattr_fuse_fs ((type ARG1))
	(allow ARG1 fuse_fs.fs (filesystem (getattr))))

(macro fs_mount_fuse_fs ((type ARG1))
	(allow ARG1 fuse_fs.fs (filesystem (mount))))

(macro fs_manage_fuse_dirs ((type ARG1))
	(allow ARG1 fuse_fs.fs manage_dir_perms))

(macro fs_manage_fuse_files ((type ARG1))
	(call manage_files_pattern (ARG1 fuse_fs.fs fuse_fs.fs)))

(macro fs_manage_fuse_lnk_files ((type ARG1))
	(call manage_lnk_files_pattern (ARG1 fuse_fs.fs fuse_fs.fs)))

(macro fs_list_fuse ((type ARG1))
	(allow ARG1 fuse_fs.fs list_dir_perms))

(macro fs_read_fuse_files ((type ARG1))
	(call read_files_pattern (ARG1 fuse_fs.fs fuse_fs.fs)))

(macro fs_read_fuse_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 fuse_fs.fs fuse_fs.fs)))

(macro fs_read_fuse ((type ARG1))
	(allow ARG1 fuse_fs.fs list_dir_perms)
	(allow ARG1 fuse_fs.fs read_file_perms)
	(allow ARG1 fuse_fs.fs read_lnk_file_perms))

(macro fs_manage_fuse ((type ARG1))
	(allow ARG1 fuse_fs.fs manage_dir_perms)
	(allow ARG1 fuse_fs.fs manage_file_perms)
	(allow ARG1 fuse_fs.fs manage_lnk_file_perms))

(macro fs_unmount_fuse_fs ((type ARG1))
	(allow ARG1 fuse_fs.fs (filesystem (unmount))))

(macro fs_search_hugetlbfs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 hugetlbfs.fs search_dir_perms))

(macro fs_list_hugetlbfs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 hugetlbfs.fs list_dir_perms))

(macro fs_getattr_hugetlbfs_fs ((type ARG1))
	(allow ARG1 hugetlbfs.fs (filesystem (getattr))))

(macro fs_dontaudit_audit_access_hugetlbfs_dirs ((type ARG1))
	(dontaudit ARG1 hugetlbfs.fs (dir (audit_access))))

(macro fs_setattr_hugetlbfs_dirs ((type ARG1))
	(allow ARG1 hugetlbfs.fs (dir (setattr))))

(macro fs_manage_hugetlbfs_files ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call manage_files_pattern (ARG1 hugetlbfs.fs hugetlbfs.fs)))

(macro fs_mount_hugetlbfs_fs ((type ARG1))
	(allow ARG1 hugetlbfs.fs (filesystem (mount))))

(macro fs_remount_hugetlbfs_fs ((type ARG1))
	(allow ARG1 hugetlbfs.fs (filesystem (remount))))

(macro fs_search_iso9660 ((type ARG1))
	(allow ARG1 iso9660.fs search_dir_perms))

(macro fs_list_iso9660 ((type ARG1))
	(allow ARG1 iso9660.fs list_dir_perms))

(macro fs_read_iso9660_files ((type ARG1))
	(call read_files_pattern (ARG1 iso9660.fs iso9660.fs)))

(macro fs_read_iso9660_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 iso9660.fs iso9660.fs)))

(macro fs_read_iso9660 ((type ARG1))
	(allow ARG1 iso9660.fs read_file_perms)
	(allow ARG1 iso9660.fs list_dir_perms)
	(allow ARG1 iso9660.fs read_lnk_file_perms))

(macro fs_getattr_iso9660_fs ((type ARG1))
	(allow ARG1 iso9660.fs (filesystem (getattr))))

(macro fs_search_nfs ((type ARG1))
	(allow ARG1 nfs.fs search_dir_perms))

(macro fs_list_nfs ((type ARG1))
	(allow ARG1 nfs.fs list_dir_perms))

(macro fs_read_nfs_files ((type ARG1))
	(call read_files_pattern (ARG1 nfs.fs nfs.fs)))

(macro fs_read_nfs ((type ARG1))
	(allow ARG1 nfs.fs list_dir_perms)
	(allow ARG1 nfs.fs read_file_perms)
	(allow ARG1 nfs.fs read_lnk_file_perms))

(macro fs_manage_nfs ((type ARG1))
	(allow ARG1 nfs.fs manage_dir_perms)
	(allow ARG1 nfs.fs manage_file_perms)
	(allow ARG1 nfs.fs manage_lnk_file_perms))

(macro fs_getattr_nfs_fs ((type ARG1))
	(allow ARG1 nfs.fs (filesystem (getattr))))

(macro fs_search_proc ((type ARG1))
	(allow ARG1 proc.fs search_dir_perms))

(macro fs_getattr_proc_fs ((type ARG1))
	(allow ARG1 proc.fs (filesystem (getattr))))

(macro fs_mount_proc_fs ((type ARG1))
	(allow ARG1 proc.fs (filesystem (mount))))

(macro fs_remount_proc_fs ((type ARG1))
	(allow ARG1 proc.fs (filesystem (remount))))

(macro fs_read_proc_files ((type ARG1))
	(call read_files_pattern (ARG1 proc.fs proc.fs)))

(macro fs_write_proc_files ((type ARG1))
	(call write_files_pattern (ARG1 proc.fs proc.fs)))

(macro fs_read_proc_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 proc.fs proc.fs)))

(macro fs_read_proc ((type ARG1))
	(allow ARG1 proc.fs list_dir_perms)
	(allow ARG1 proc.fs read_file_perms)
	(allow ARG1 proc.fs read_lnk_file_perms))

(macro fs_list_proc ((type ARG1))
	(allow ARG1 proc.fs list_dir_perms))

(macro fs_rw_proc_dirs ((type ARG1))
	(allow ARG1 proc.fs rw_dir_perms))

(macro fs_dontaudit_setattr_proc_dirs ((type ARG1))
	(dontaudit ARG1 proc.fs (dir (setattr))))

(macro fs_setattr_proc_dirs ((type ARG1))
	(allow ARG1 proc.fs (dir (setattr))))

(macro fs_mounton_proc_dirs ((type ARG1))
	(allow ARG1 proc.fs (dir (mounton))))

(macro fs_search_pstore ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 pstore.fs search_dir_perms))

(macro fs_list_pstore ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 pstore.fs list_dir_perms))

(macro fs_search_removable ((type ARG1))
	(allow ARG1 removable_fs.fs search_dir_perms))

(macro fs_list_removable ((type ARG1))
	(allow ARG1 removable_fs.fs list_dir_perms))

(macro fs_read_removable_files ((type ARG1))
	(call read_files_pattern (ARG1 removable_fs.fs removable_fs.fs)))

(macro fs_read_removable ((type ARG1))
	(allow ARG1 removable_fs.fs list_dir_perms)
	(allow ARG1 removable_fs.fs read_file_perms)
	(allow ARG1 removable_fs.fs read_lnk_file_perms))

(macro fs_manage_removable ((type ARG1))
	(allow ARG1 removable_fs.fs manage_dir_perms)
	(allow ARG1 removable_fs.fs manage_file_perms)
	(allow ARG1 removable_fs.fs manage_lnk_file_perms))

(macro fs_getattr_removable_fs ((type ARG1))
	(allow ARG1 removable_fs.fs (filesystem (getattr))))

(macro fs_getattr_rootfs_fs ((type ARG1))
	(allow ARG1 rootfs.fs (filesystem (getattr))))

(macro fs_setattr_rootfs_dirs ((type ARG1))
	(allow ARG1 rootfs.fs (dir (setattr))))

(macro fs_rw_rootfs_dirs ((type ARG1))
	(allow ARG1 rootfs.fs rw_dir_perms))

(macro fs_audit_access_rootfs_dirs ((type ARG1))
	(allow ARG1 rootfs.fs (dir (write))))

(macro fs_search_rootfs ((type ARG1))
	(allow ARG1 rootfs.fs search_dir_perms))

(macro fs_list_rootfs ((type ARG1))
	(allow ARG1 rootfs.fs list_dir_perms))

(macro fs_mounton_rootfs_dirs ((type ARG1))
	(allow ARG1 rootfs.fs (dir (mounton))))

(macro fs_rootfs_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call obj_type_transition_pattern (ARG1 rootfs.fs ARG2 ARG3 ARG4)))

(macro fs_search_sysfs ((type ARG1))
	(allow ARG1 sysfs.fs search_dir_perms))

(macro fs_dontaudit_audit_access_sysfs_dirs ((type ARG1))
	(dontaudit ARG1 sysfs.fs (dir (audit_access))))

(macro fs_relabel_sysfs_dirs ((type ARG1))
	(call relabel_dirs_pattern (ARG1 sysfs.fs sysfs.fs)))

(macro fs_relabelfrom_sysfs_dirs ((type ARG1))
	(call relabelfrom_dirs_pattern (ARG1 sysfs.fs sysfs.fs)))

(macro fs_setattr_sysfs_dirs ((type ARG1))
	(allow ARG1 sysfs.fs (dir (setattr))))

(macro fs_list_sysfs ((type ARG1))
	(allow ARG1 sysfs.fs list_dir_perms))

(macro fs_getattr_sysfs_fs ((type ARG1))
	(allow ARG1 sysfs.fs (filesystem (getattr))))

(macro fs_read_sysfs_files ((type ARG1))
	(call read_files_pattern (ARG1 sysfs.fs sysfs.fs)))

(macro fs_rw_sysfs_files ((type ARG1))
	(call rw_files_pattern (ARG1 sysfs.fs sysfs.fs)))

(macro fs_read_sysfs_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 sysfs.fs sysfs.fs)))

(macro fs_manage_sysfs_dirs ((type ARG1))
	(call manage_dirs_pattern (ARG1 sysfs.fs sysfs.fs)))

(macro fs_read_sysfs ((type ARG1))
	(allow ARG1 sysfs.fs read_file_perms)
	(allow ARG1 sysfs.fs list_dir_perms)
	(allow ARG1 sysfs.fs read_lnk_file_perms))

(macro fs_mounton_sysfs_dirs ((type ARG1))
	(allow ARG1 sysfs.fs (dir (mounton))))

(macro fs_mount_sysfs_fs ((type ARG1))
	(allow ARG1 sysfs.fs (filesystem (mount))))

(macro fs_remount_sysfs_fs ((type ARG1))
	(allow ARG1 sysfs.fs (filesystem (remount))))

(macro fs_search_tmpfs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tmpfs.fs search_dir_perms))

(macro fs_list_tmpfs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tmpfs.fs list_dir_perms))

(macro fs_del_entry_tmpfs_dirs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tmpfs.fs del_entry_dir_perms))

(macro fs_getattr_tmpfs_fs ((type ARG1))
	(allow ARG1 tmpfs.fs (filesystem (getattr))))

(macro fs_read_tmpfs_files ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call read_files_pattern (ARG1 tmpfs.fs tmpfs.fs)))

(macro fs_rw_tmpfs_files ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call rw_files_pattern (ARG1 tmpfs.fs tmpfs.fs)))

(macro fs_rw_inherited_tmpfs_files ((type ARG1))
	(allow ARG1 tmpfs.fs rw_inherited_file_perms))

(macro fs_manage_tmpfs_files ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call manage_files_pattern (ARG1 tmpfs.fs tmpfs.fs)))

(macro fs_read_tmpfs_lnk_files ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call read_lnk_files_pattern (ARG1 tmpfs.fs tmpfs.fs)))

(macro fs_manage_tmpfs_lnk_files ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call manage_lnk_files_pattern (ARG1 tmpfs.fs tmpfs.fs)))

(macro fs_read_tmpfs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tmpfs.fs read_file_perms)
	(allow ARG1 tmpfs.fs list_dir_perms)
	(allow ARG1 tmpfs.fs read_lnk_file_perms))

(macro fs_relabelfrom_tmpfs_fs ((type ARG1))
	(allow ARG1 tmpfs.fs (filesystem (relabelfrom))))

(macro fs_relabel_tmpfs_dirs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call relabel_dirs_pattern (ARG1 tmpfs.fs tmpfs.fs)))

(macro fs_relabelfrom_tmpfs_dirs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call relabelfrom_dirs_pattern (ARG1 tmpfs.fs tmpfs.fs)))

(macro fs_relabelfrom_tmpfs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tmpfs.fs relabelfrom_file_perms)
	(allow ARG1 tmpfs.fs relabelfrom_dir_perms)
	(allow ARG1 tmpfs.fs relabelfrom_fifo_file_perms)
	(allow ARG1 tmpfs.fs relabelfrom_lnk_file_perms)
	(allow ARG1 tmpfs.fs relabelfrom_sock_file_perms)
	(allow ARG1 tmpfs.fs relabelfrom_blk_file_perms)
	(allow ARG1 tmpfs.fs relabelfrom_chr_file_perms))

(macro fs_del_entry_tmpfs ((type ARG1))
	(allow ARG1 tmpfs.fs del_entry_dir_perms))

(macro fs_dontaudit_audit_access_tmpfs_dirs ((type ARG1))
	(dontaudit ARG1 tmpfs.fs (dir (audit_access))))

(macro fs_rw_tmpfs_dirs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tmpfs.fs rw_dir_perms))

(macro fs_setattr_tmpfs_dirs ((type ARG1))
	(allow ARG1 tmpfs.fs (dir (setattr))))

(macro fs_manage_tmpfs_dirs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(call manage_dirs_pattern (ARG1 tmpfs.fs tmpfs.fs)))

(macro fs_mounton_tmpfs_dirs ((type ARG1))
	(allow ARG1 tmpfs.fs (dir (mounton))))

(macro fs_mount_tmpfs_fs ((type ARG1))
	(allow ARG1 tmpfs.fs (filesystem (mount))))

(macro fs_remount_tmpfs_fs ((type ARG1))
	(allow ARG1 tmpfs.fs (filesystem (remount))))

(macro fs_unmount_tmpfs_fs ((type ARG1))
	(allow ARG1 tmpfs.fs (filesystem (unmount))))

(macro fs_tmpfs_obj_type_transition ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
	(call fs_search_devtmpfs (ARG1))
	(call obj_type_transition_pattern (ARG1 tmpfs.fs ARG2 ARG3 ARG4)))

(macro fs_mount_tracefs_fs ((type ARG1))
	(allow ARG1 tracefs.fs (filesystem (mount))))

(macro fs_search_tracefs ((type ARG1))
	(call fs_search_debugfs (ARG1))
	(allow ARG1 tracefs.fs search_dir_perms))

(macro fs_list_tracefs ((type ARG1))
	(call fs_search_debugfs (ARG1))
	(allow ARG1 tracefs.fs list_dir_perms))

(macro fs_read_tracefs_files ((type ARG1))
	(call fs_search_debugfs (ARG1))
	(call read_files_pattern (ARG1 tracefs.fs tracefs.fs)))

(macro fs_read_tracefs ((type ARG1))
	(call fs_search_debugfs (ARG1))
	(allow ARG1 tracefs.fs read_file_perms)
	(allow ARG1 tracefs.fs list_dir_perms)
	(allow ARG1 tracefs.fs read_lnk_file_perms))

(macro fs_getattr_tracefs_fs ((type ARG1))
	(allow ARG1 tracefs.fs (filesystem (getattr))))

(macro fs_list_all ((type ARG1))
	(allow ARG1 fs_obj_type list_dir_perms))

(macro fs_getattr_all ((type ARG1))
	(allow ARG1 fs_obj_type (file (getattr)))
	(allow ARG1 fs_obj_type (dir (getattr)))
	(allow ARG1 fs_obj_type (fifo_file (getattr)))
	(allow ARG1 fs_obj_type (lnk_file (getattr)))
	(allow ARG1 fs_obj_type (sock_file (getattr)))
	(allow ARG1 fs_obj_type (blk_file (getattr)))
	(allow ARG1 fs_obj_type (chr_file (getattr))))

(macro fs_relabel_all ((type ARG1))
	(allow ARG1 fs_obj_type relabel_file_perms)
	(allow ARG1 fs_obj_type relabel_dir_perms)
	(allow ARG1 fs_obj_type relabel_fifo_file_perms)
	(allow ARG1 fs_obj_type relabel_lnk_file_perms)
	(allow ARG1 fs_obj_type relabel_sock_file_perms)
	(allow ARG1 fs_obj_type relabel_blk_file_perms)
	(allow ARG1 fs_obj_type relabel_chr_file_perms))

(macro fs_read_all_lnk_files ((type ARG1))
	(call read_lnk_files_pattern (ARG1 fs_obj_type fs_obj_type)))

(macro fs_dontaudit_getattr_all_fs ((type ARG1))
	(dontaudit ARG1 fs_obj_type (filesystem (getattr))))

(macro fs_getattr_all_fs ((type ARG1))
	(allow ARG1 fs_obj_type (filesystem (getattr))))

(macro fs_mount_all_fs ((type ARG1))
	(allow ARG1 fs_obj_type (filesystem (mount))))

(macro fs_remount_all_fs ((type ARG1))
	(allow ARG1 fs_obj_type (filesystem (remount))))

(macro fs_unmount_all_fs ((type ARG1))
	(allow ARG1 fs_obj_type (filesystem (unmount))))

(macro fs_unconfined_subj_type ((type ARG1))
	(typeattributeset fs_unconfined_subj_type ARG1))
(boolean fs_use_cifs true)
(boolean fs_use_dosfs true)
(boolean fs_use_fuse true)
(boolean fs_use_nfs true)
(boolean fs_use_iso9660 true)
(boolean fs_use_removable true)

(sid fs)

(typeattribute fs_obj_type)

(typeattribute fs_unconfined_subj_type)

(typeattribute fs_read_cifs_subj_type)
(typeattribute fs_manage_cifs_subj_type)

(typeattribute fs_read_dosfs_subj_type)
(typeattribute fs_manage_dosfs_subj_type)

(typeattribute fs_read_fuse_subj_type)
(typeattribute fs_manage_fuse_subj_type)

(typeattribute fs_read_iso9660_subj_type)

(typeattribute fs_read_nfs_subj_type)
(typeattribute fs_manage_nfs_subj_type)

(typeattribute fs_read_removable_subj_type)
(typeattribute fs_manage_removable_subj_type)

(typeattribute fs_trace_client_subj_type)

(block fs_use_dosfs
	(blockinherit sec_bool_obj_blk))

(block fs_use_cifs
	(blockinherit sec_bool_obj_blk))

(block fs_use_fuse
	(blockinherit sec_bool_obj_blk))

(block fs_use_iso9660
	(blockinherit sec_bool_obj_blk))

(block fs_use_nfs
	(blockinherit sec_bool_obj_blk))

(block fs_use_removable
	(blockinherit sec_bool_obj_blk))

(block aio
	(blockinherit fs_obj_blk))

(block anon_inodefs
	(blockinherit fs_obj_blk)

	(call mls_trusted_obj_type (fs)))

(block autofs_fs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block bdev
	(blockinherit fs_obj_blk))

(block binfmt_misc
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block cifs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block cgroup
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block configfs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block debugfs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block devpts
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block devtmpfs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs))

	(call mls_trusted_obj_type (fs))

	(call fs_associate_fs (fs)))

(block dosfs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block drm
	(blockinherit fs_obj_blk))

(block efivarfs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block fs
	(blockinherit fs_obj_blk))

(block fuse_fs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block hugetlbfs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block iso9660
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block nfs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block nfsd
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block proc
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs))

	(call fs_associate_fs (fs)))

(block pstore
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block removable_fs
	(blockinherit fs_obj_blk))

(block rootfs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs))

	(call fs_associate_fs (fs)))

(block rpc_pipefs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(block sysfs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs))

	(call fs_associate_fs (fs)))

(block tmpfs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs))

	(call fs_associate_fs (fs)))

(block tracefs
	(blockinherit fs_obj_blk)

	(call sys_mountpoint_obj_type (fs)))

(call sys_obj_type (fs_obj_type))

(allow fs_obj_type self (filesystem (associate)))

(call fs_getattr_debugfs_fs (fs_trace_client_subj_type))
(call fs_mount_tracefs_fs (fs_trace_client_subj_type))
(call fs_read_debugfs (fs_trace_client_subj_type))
(call fs_read_tracefs (fs_trace_client_subj_type))

(allow fs_unconfined_subj_type fs_obj_type all_file_perms_except_mounton_execmod_and_entrypoint)
(allow fs_unconfined_subj_type fs_obj_type all_dir_perms_except_mounton_and_execmod)
(allow fs_unconfined_subj_type fs_obj_type all_fifo_file_perms_except_mounton_and_execmod)
(allow fs_unconfined_subj_type fs_obj_type all_lnk_file_perms_except_mounton_and_execmod)
(allow fs_unconfined_subj_type fs_obj_type all_sock_file_perms_except_mounton_and_execmod)
(allow fs_unconfined_subj_type fs_obj_type all_blk_file_perms_except_mounton_and_execmod)
(allow fs_unconfined_subj_type fs_obj_type all_chr_file_perms_except_mounton_and_execmod)

(allow fs_unconfined_subj_type fs_obj_type (filesystem (mount remount unmount getattr relabelfrom relabelto associate
	quotamod quotaget)))

(booleanif fs_use_cifs
	(true
		(call fs_read_cifs (fs_read_cifs_subj_type))
		(call fs_getattr_cifs_fs (fs_read_cifs_subj_type))
		(call fs_manage_cifs (fs_manage_cifs_subj_type))
		(call fs_getattr_cifs_fs (fs_manage_cifs_subj_type))))

(booleanif fs_use_dosfs
	(true
		(call fs_read_dosfs (fs_read_dosfs_subj_type))
		(call fs_getattr_dosfs_fs (fs_read_dosfs_subj_type))
		(call fs_manage_dosfs (fs_manage_dosfs_subj_type))
		(call fs_getattr_dosfs_fs (fs_manage_dosfs_subj_type))))

(booleanif fs_use_fuse
	(true
		(call fs_read_fuse (fs_read_fuse_subj_type))
		(call fs_getattr_fuse_fs (fs_read_fuse_subj_type))
		(call fs_manage_fuse (fs_manage_fuse_subj_type))
		(call fs_getattr_fuse_fs (fs_manage_fuse_subj_type))))

(booleanif fs_use_iso9660
	(true
		(call fs_read_iso9660 (fs_read_iso9660_subj_type))
		(call fs_getattr_iso9660_fs (fs_read_iso9660_subj_type))))

(booleanif fs_use_nfs
	(true
		(call fs_read_nfs (fs_read_nfs_subj_type))
		(call fs_getattr_nfs_fs (fs_read_nfs_subj_type))
		(call fs_manage_nfs (fs_manage_nfs_subj_type))
		(call fs_getattr_nfs_fs (fs_manage_nfs_subj_type))))

(booleanif fs_use_removable
	(true
		(call fs_read_removable (fs_read_removable_subj_type))
		(call fs_getattr_removable_fs (fs_read_removable_subj_type))
		(call fs_manage_removable (fs_manage_removable_subj_type))
		(call fs_getattr_removable_fs (fs_manage_removable_subj_type))))
(tunableif enable_rbacsep
	(true
		(context console (sys.id sys.role console.dev (systemlow systemlow)))
		(context term_console_login (sys.id sys.role term_console_login.bool (systemlow systemlow)))
		(context tty (sys.id sys.role tty.serial_dev (systemlow systemlow)))
		(context virtio (sys.id sys.role virtio.serial_dev (systemlow systemlow))))
	(false
		(context console (sys.id object_r console.dev (systemlow systemlow)))
		(context term_console_login (sys.id object_r term_console_login.bool (systemlow systemlow)))
		(context tty (sys.id object_r tty.serial_dev (systemlow systemlow)))
		(context virtio (sys.id object_r virtio.serial_dev (systemlow systemlow)))))

(filecon "/dev/console" char console)
(filecon "/dev/hvc[0-9]+" char tty)
(filecon "/dev/tty.+" char tty)
(filecon "/dev/vcs[^/]*" char tty)
(filecon "/dev/vport[0-9]p[0-9]+" char virtio)

(genfscon "selinuxfs" "/booleans/term_console_login" term_console_login)
(block term_pty_obj_blk
	(blockabstract term_pty_obj_blk)

	(type pty_dev)
	(call term_pty_obj_type (pty_dev)))

(block term_login_pty_obj_blk
	(blockabstract term_login_pty_obj_blk)

	(type login_pty_dev)
	(call term_login_pty_obj_type (login_pty_dev)))

(block term_serial_obj_blk
	(blockabstract term_serial_obj_blk)

	(type serial_dev)
	(call term_serial_obj_type (serial_dev)))

(block term_tty_obj_blk
	(blockabstract term_tty_obj_blk)

	(type tty_dev)
	(call term_tty_obj_type (tty_dev)))

(macro term_pty_obj_type ((type ARG1))
	(call dev_obj_type (ARG1))
	(typeattributeset term_pty_obj_type ARG1))

(macro term_login_pty_obj_type ((type ARG1))
	(call term_pty_obj_type (ARG1))
	(typeattributeset term_server_pty_obj_type ARG1))

(macro term_serial_obj_type ((type ARG1))
	(call dev_obj_type (ARG1))
	(typeattributeset term_serial_obj_type ARG1))

(macro term_tty_obj_type ((type ARG1))
	(call term_serial_obj_type (ARG1))
	(typeattributeset term_tty_obj_type ARG1))

(macro term_create_pty ((type ARG1)(type ARG2))
	(call dev_rw_ptmx (ARG1))
	(call fs_getattr_devpts_fs (ARG1))
	(call fs_devpts_obj_type_transition (ARG1 ARG2 chr_file "*")))

(macro term_dontaudit_use_console ((type ARG1))
	(dontaudit ARG1 console.dev rw_term_perms))

(macro term_use_console ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 console.dev rw_term_perms))

(macro term_use_inherited_console ((type ARG1))
	(allow ARG1 console.dev rw_inherited_term_perms))

(macro term_relabel_console ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 console.dev relabel_chr_file_perms))

(macro term_relabelfrom_console ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 console.dev relabelfrom_chr_file_perms))

(macro term_relabelto_console ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 console.dev relabelto_chr_file_perms))

(macro term_setattr_console ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 console.dev (chr_file (setattr))))

(macro term_write_console ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 console.dev write_chr_file_perms))

(macro term_use_virtio ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 virtio.serial_dev rw_term_perms))

(macro term_use_inherited_virtio ((type ARG1))
	(allow ARG1 virtio.serial_dev rw_inherited_term_perms))

(macro term_relabel_unallocated_ttys ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tty.serial_dev relabel_chr_file_perms))

(macro term_relabelfrom_unallocated_ttys ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tty.serial_dev relabelfrom_chr_file_perms))

(macro term_relabelto_unallocated_ttys ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tty.serial_dev relabelto_chr_file_perms))

(macro term_setattr_unallocated_ttys ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tty.serial_dev (chr_file (setattr))))

(macro term_use_inherited_unallocated_ttys ((type ARG1))
	(allow ARG1 tty.serial_dev rw_inherited_term_perms))

(macro term_use_unallocated_ttys ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tty.serial_dev rw_term_perms))

(macro term_user_pty ((type ARG1)(type ARG2))
	(typechange ARG1 term_server_pty_obj_type chr_file ARG2))

(macro term_user_tty ((type ARG1)(type ARG2))
	(typechange ARG1 tty.serial_dev chr_file ARG2)
	(booleanif term_console_login (true (typechange ARG1 console.dev chr_file ARG2))))

(macro term_devtmpfs_obj_type_transition_unallocated_tty ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcs"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcs1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcs2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcs3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcs4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcs5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcs6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcs63"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcsa"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcsa1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcsa2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcsa3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcsa4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcsa5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcsa6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 tty.serial_dev chr_file "vcsa63")))
(boolean term_console_login false)

(typeattribute term_pty_obj_type)
(typeattribute term_serial_obj_type)
(typeattribute term_server_pty_obj_type)
(typeattribute term_tty_obj_type)

(block term_console_login
	(blockinherit sec_bool_obj_blk))

(block console
	(blockinherit dev_obj_blk))

(block tty
	(blockinherit term_serial_obj_blk))

(block virtio
	(blockinherit term_serial_obj_blk))

(call fs_associate_devpts (term_pty_obj_type))
(tunableif enable_rbacsep
	(true
		(context securityfs (sys.id sys.role securityfs.fs (systemlow systemlow)))
		(context sec_load_policy (sys.id sys.role sec_load_policy.bool (systemlow systemlow))))
	(false
		(context securityfs (sys.id object_r securityfs.fs (systemlow systemlow)))
		(context sec_load_policy (sys.id object_r sec_load_policy.bool (systemlow systemlow)))))

(tunableif enable_mls
	(true
		(tunableif enable_rbacsep
			(true
				(context security_sidcon (sys.id sys.role securityfs.fs (systemhigh systemhigh))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context security_sidcon (sys.id object_r securityfs.fs (systemhigh systemhigh)))))))

(tunableif (not enable_mls)
	(true
		(tunableif enable_rbacsep
			(true
				(context security_sidcon (sys.id sys.role securityfs.fs (systemlow systemlow))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context security_sidcon (sys.id object_r securityfs.fs (systemlow systemlow)))))))

(genfscon "securityfs" "/" securityfs)
(genfscon "selinuxfs" "/booleans/sec_load_policy" sec_load_policy)
(genfscon "selinuxfs" "/" securityfs)

(sidcontext security security_sidcon)
(block sec_bool_obj_blk
	(blockabstract sec_bool_obj_blk)

	(type bool)
	(call sec_bool_obj_type (bool)))

(macro sec_bool_obj_type ((type ARG1))
	(typeattributeset sec_bool_obj_type ARG1))

(macro sec_search_fs ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 securityfs.fs search_dir_perms))

(macro sec_dontaudit_list_fs ((type ARG1))
	(dontaudit ARG1 securityfs.fs list_dir_perms))

(macro sec_list_fs ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 securityfs.fs list_dir_perms))

(macro sec_getattr_fs ((type ARG1))
	(allow ARG1 securityfs.fs (filesystem (getattr))))

(macro sec_remount_fs ((type ARG1))
	(allow ARG1 securityfs.fs (filesystem (remount))))

(macro sec_dontaudit_write_securityfs_files ((type ARG1))
	(dontaudit ARG1 securityfs.fs write_file_perms))

(macro sec_compute_access_vector ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(allow ARG1 securityfs.fs (security (compute_av))))

(macro sec_compute_create_context ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(allow ARG1 securityfs.fs (security (compute_create))))

(macro sec_compute_relabel_context ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(allow ARG1 securityfs.fs (security (compute_relabel))))

(macro sec_compute_user_contexts ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(allow ARG1 securityfs.fs (security (compute_user))))

(macro sec_get_enforce_mode ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call read_files_pattern (ARG1 securityfs.fs securityfs.fs)))

(macro sec_load_policy_subj_type ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(typeattributeset sec_load_policy_subj_type ARG1)
	(booleanif (sec_load_policy) (true (allow ARG1 securityfs.fs (security (load_policy))))))

(macro sec_read_policy ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call read_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(allow ARG1 securityfs.fs (security (read_policy))))

(macro sec_get_all_booleans ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 securityfs.fs list_dir_perms)
	(allow ARG1 sec_bool_obj_type read_file_perms))

(macro sec_set_all_booleans ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 sec_bool_obj_type_except_sec_load_policy rw_file_perms)
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(allow ARG1 securityfs.fs (security (setbool)))
	(booleanif (sec_load_policy) (true (allow ARG1 sec_load_policy.bool (file (append write))))))

(macro sec_set_spec_boolean ((type ARG1)(type ARG2))
	(call fs_search_sysfs (ARG1))
	(allow ARG1 ARG2 rw_file_perms)
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(allow ARG1 securityfs.fs (security (setbool))))

(macro sec_set_check_req_prot ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(allow ARG1 securityfs.fs (security (setcheckreqprot))))

(macro sec_set_enforce_mode ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(typeattributeset sec_setenforce_subj_type ARG1)
	(booleanif (sec_load_policy) (true (allow ARG1 securityfs.fs (security (setenforce))))))

(macro sec_set_params ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(allow ARG1 securityfs.fs (security (setsecparam)))
	(auditallow ARG1 securityfs.fs (security (setsecparam)))
	(typeattributeset sec_setsecparam_subj_type ARG1))

(macro sec_validate_context ((type ARG1))
	(call fs_search_sysfs (ARG1))
	(call rw_files_pattern (ARG1 securityfs.fs securityfs.fs))
	(allow ARG1 securityfs.fs (security (check_context))))

(macro sec_unconfined_subj_type ((type ARG1))
	(typeattributeset sec_unconfined_subj_type ARG1))
(boolean sec_load_policy true)

(sid security)

(typeattribute sec_bool_obj_type)

(typeattribute sec_unconfined_subj_type)

(block securityfs
	(blockinherit fs_obj_blk)

	(call sec_bool_obj_type (fs)))

(block sec_load_policy
	(blockinherit sec_bool_obj_blk))

(call sys_obj_type (sec_bool_obj_type))

(typeattribute sec_load_policy_subj_type)
(typeattribute sec_not_load_policy_subj_type_or_sec_unconfined_subj_type)

(typeattributeset sec_not_load_policy_subj_type_or_sec_unconfined_subj_type
	(not (sec_load_policy_subj_type sec_unconfined_subj_type)))

(neverallow sec_not_load_policy_subj_type_or_sec_unconfined_subj_type securityfs.fs (security (load_policy)))
; for flow requirement ;
(typeattributeset Harm (sec_not_load_policy_subj_type_or_sec_unconfined_subj_type))
(typeattributeset TCB securityfs.fs)

(typeattribute sec_setenforce_subj_type)
(typeattribute sec_not_setenforce_subj_type_or_sec_unconfined_subj_type)

(typeattributeset sec_not_setenforce_subj_type_or_sec_unconfined_subj_type
	(not (sec_setenforce_subj_type sec_unconfined_subj_type)))

(neverallow sec_not_setenforce_subj_type_or_sec_unconfined_subj_type securityfs.fs (security (setenforce)))
; for flow requirement ;
(typeattributeset Harm (sec_not_setenforce_subj_type_or_sec_unconfined_subj_type))

(typeattribute sec_setsecparam_subj_type)
(typeattribute sec_not_setsecparam_subj_type_or_sec_unconfined_subj_type)

(typeattributeset sec_not_setsecparam_subj_type_or_sec_unconfined_subj_type
	(not (sec_setsecparam_subj_type sec_unconfined_subj_type)))

(neverallow sec_not_setsecparam_subj_type_or_sec_unconfined_subj_type securityfs.fs (security (setsecparam)))
; for flow requirement ;
(typeattributeset Harm (sec_not_setsecparam_subj_type_or_sec_unconfined_subj_type))

(allow sec_unconfined_subj_type securityfs.fs list_dir_perms)
(allow sec_unconfined_subj_type securityfs.fs read_lnk_file_perms)

(typeattribute sec_bool_obj_type_except_sec_load_policy)

(typeattributeset sec_bool_obj_type_except_sec_load_policy (and (sec_bool_obj_type) (not (sec_load_policy.bool))))

(allow sec_unconfined_subj_type sec_bool_obj_type read_file_perms)
(allow sec_unconfined_subj_type sec_bool_obj_type_except_sec_load_policy (file (append write)))

(allow sec_unconfined_subj_type securityfs.fs all_security_perms_except_load_policy_and_setenforce)

(booleanif sec_load_policy (true (allow sec_unconfined_subj_type securityfs.fs (security (load_policy setenforce)))
	(allow sec_unconfined_subj_type securityfs.fs (file (append write)))))
(tunableif enable_rbacsep
	(true
		(context fuse_storage (sys.id sys.role fuse_storage.storage_dev (systemlow systemlow)))
		(context removable_storage (sys.id sys.role removable_storage.storage_dev (systemlow systemlow)))
		(context scsi_generic (sys.id sys.role scsi_generic.storage_dev (systemlow systemlow))))
	(false
		(context fuse_storage (sys.id object_r fuse_storage.storage_dev (systemlow systemlow)))
		(context removable_storage (sys.id object_r removable_storage.storage_dev (systemlow systemlow)))
		(context scsi_generic (sys.id object_r scsi_generic.storage_dev (systemlow systemlow)))))

(tunableif enable_mls
	(true
		(tunableif enable_rbacsep
			(true
				(context fixed_disk (sys.id sys.role fixed_disk.storage_dev (systemhigh systemhigh))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context fixed_disk (sys.id object_r fixed_disk.storage_dev (systemhigh systemhigh)))))))

(tunableif (not enable_mls)
	(true
		(tunableif enable_rbacsep
			(true
				(context fixed_disk (sys.id sys.role fixed_disk.storage_dev (systemlow systemlow))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context fixed_disk (sys.id object_r fixed_disk.storage_dev (systemlow systemlow)))))))

(filecon "/dev/bsg/.+" char scsi_generic)
(filecon "/dev/dm-[0-9]+" block fixed_disk)
(filecon "/dev/fuse" char fuse_storage)
(filecon "/dev/loop.+" char fixed_disk)
(filecon "/dev/mmcblk.+" block removable_storage)
(filecon "/dev/mspblk.+" block removable_storage)
(filecon "/dev/raw/.+" char fixed_disk)
(filecon "/dev/sg[0-9]+" char scsi_generic)
(filecon "/dev/[shmxv]d[^/]*" block fixed_disk)
(filecon "/dev/sr[0-9]+" block removable_storage)
(macro storage_getattr_fixed_disk ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fixed_disk.storage_dev (chr_file (getattr)))
	(allow ARG1 fixed_disk.storage_dev (blk_file (getattr))))

(macro storage_getattr_fuse ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fuse_storage.storage_dev (chr_file (getattr))))

(macro storage_getattr_removable ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 removable_storage.storage_dev (blk_file (getattr))))

(macro storage_getattr_scsi_generic ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 scsi_generic.storage_dev (chr_file (getattr))))

(macro storage_getattr_all ((type ARG1))
	(call storage_getattr_fixed_disk (ARG1))
	(call storage_getattr_fuse (ARG1))
	(call storage_getattr_removable (ARG1))
	(call storage_getattr_scsi_generic (ARG1)))

(macro storage_relabel_fixed_disk ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fixed_disk.storage_dev relabel_blk_file_perms)
	(allow ARG1 fixed_disk.storage_dev relabel_chr_file_perms))

(macro storage_relabel_fuse ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fuse_storage.storage_dev relabel_chr_file_perms))

(macro storage_relabel_removable ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 removable_storage.storage_dev relabel_blk_file_perms))

(macro storage_relabel_scsi_generic ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 scsi_generic.storage_dev relabel_chr_file_perms))

(macro storage_relabel_all ((type ARG1))
	(call storage_relabel_fixed_disk (ARG1))
	(call storage_relabel_fuse (ARG1))
	(call storage_relabel_removable (ARG1))
	(call storage_relabel_scsi_generic (ARG1)))

(macro storage_relabelto_fixed_disk ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fixed_disk.storage_dev relabelto_blk_file_perms)
	(allow ARG1 fixed_disk.storage_dev relabelto_chr_file_perms))

(macro storage_relabelto_fuse ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fuse_storage.storage_dev relabelto_chr_file_perms))

(macro storage_relabelto_removable ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 removable_storage.storage_dev relabelto_blk_file_perms))

(macro storage_relabelto_scsi_generic ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 scsi_generic.storage_dev relabelto_chr_file_perms))

(macro storage_relabelto_all ((type ARG1))
	(call storage_relabelto_fixed_disk (ARG1))
	(call storage_relabelto_fuse (ARG1))
	(call storage_relabelto_removable (ARG1))
	(call storage_relabelto_scsi_generic (ARG1)))

(macro storage_rw_fixed_disk ((type ARG1))
	(call storage_read_fixed_disk (ARG1))
	(call storage_write_fixed_disk (ARG1)))

(macro storage_rw_fuse ((type ARG1))
	(call storage_read_fuse (ARG1))
	(call storage_write_fuse (ARG1)))

(macro storage_rw_scsi_generic ((type ARG1))
	(call storage_read_scsi_generic (ARG1))
	(call storage_write_scsi_generic (ARG1)))

(macro storage_rw_removable ((type ARG1))
	(call storage_read_removable (ARG1))
	(call storage_write_removable (ARG1)))

(macro storage_rw_all ((type ARG1))
	(call storage_rw_fixed_disk (ARG1))
	(call storage_rw_fuse (ARG1))
	(call storage_rw_removable (ARG1))
	(call storage_rw_scsi_generic (ARG1)))

(macro storage_setattr_fixed_disk ((type ARG1))
	(allow ARG1 fixed_disk.storage_dev (chr_file (setattr)))
	(allow ARG1 fixed_disk.storage_dev (blk_file (setattr))))

(macro storage_setattr_fuse ((type ARG1))
	(allow ARG1 fuse_storage.storage_dev (chr_file (setattr))))

(macro storage_setattr_removable ((type ARG1))
	(allow ARG1 removable_storage.storage_dev (blk_file (setattr))))

(macro storage_setattr_scsi_generic ((type ARG1))
	(allow ARG1 scsi_generic.storage_dev (chr_file (setattr))))

(macro storage_setattr_all ((type ARG1))
	(call storage_setattr_fixed_disk (ARG1))
	(call storage_setattr_fuse (ARG1))
	(call storage_setattr_removable (ARG1))
	(call storage_setattr_scsi_generic (ARG1)))

(macro storage_write_fixed_disk ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fixed_disk.storage_dev write_chr_file_perms)
	(allow ARG1 fixed_disk.storage_dev write_blk_file_perms)
	(typeattributeset storage_write_fixed_disk_subj_type ARG1))

(macro storage_write_fuse ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fuse_storage.storage_dev write_chr_file_perms))

(macro storage_write_removable ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 removable_storage.storage_dev write_blk_file_perms))

(macro storage_write_scsi_generic ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 scsi_generic.storage_dev write_chr_file_perms)
	(typeattributeset storage_write_scsi_generic_subj_type ARG1))

(macro storage_write_all ((type ARG1))
	(call storage_write_fixed_disk (ARG1))
	(call storage_write_fuse (ARG1))
	(call storage_write_removable (ARG1))
	(call storage_write_scsi_generic (ARG1)))

(macro storage_read_fixed_disk ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fixed_disk.storage_dev read_chr_file_perms)
	(allow ARG1 fixed_disk.storage_dev read_blk_file_perms)
	(typeattributeset storage_read_fixed_disk_subj_type ARG1))

(macro storage_read_fuse ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fuse_storage.storage_dev read_chr_file_perms))

(macro storage_read_removable ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 removable_storage.storage_dev read_blk_file_perms))

(macro storage_read_scsi_generic ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 scsi_generic.storage_dev read_chr_file_perms)
	(typeattributeset storage_read_scsi_generic_subj_type ARG1))

(macro storage_read_all ((type ARG1))
	(call storage_read_fixed_disk (ARG1))
	(call storage_read_fuse (ARG1))
	(call storage_read_removable (ARG1))
	(call storage_read_scsi_generic (ARG1)))

(macro storage_manage_fixed_disk ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_rw_devtmpfs_dirs (ARG1))
	(allow ARG1 fixed_disk.storage_dev manage_blk_file_perms)
	(allow ARG1 fixed_disk.storage_dev manage_chr_file_perms)
	(typeattributeset storage_read_fixed_disk_subj_type ARG1)
	(typeattributeset storage_write_fixed_disk_subj_type ARG1))

(macro storage_manage_fuse ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 fuse_storage.storage_dev manage_chr_file_perms))

(macro storage_manage_removable ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_rw_devtmpfs_dirs (ARG1))
	(allow ARG1 removable_storage.storage_dev manage_blk_file_perms))

(macro storage_manage_scsi_generic ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_rw_devtmpfs_dirs (ARG1))
	(allow ARG1 scsi_generic.storage_dev manage_chr_file_perms)
	(typeattributeset storage_read_scsi_generic_subj_type ARG1)
	(typeattributeset storage_write_scsi_generic_subj_type ARG1))

(macro storage_manage_all ((type ARG1))
	(call storage_manage_fixed_disk (ARG1))
	(call storage_manage_fuse (ARG1))
	(call storage_manage_removable (ARG1))
	(call storage_manage_scsi_generic (ARG1)))

(macro storage_devtmpfs_obj_type_transition_fixed_disk ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sda"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sda1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sda2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sda3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sda4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sda5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sda6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sda7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sda8"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sda9"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdb"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdb1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdb2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdb3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdb4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdb5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdb6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdb7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdb8"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdb9"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdc"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdc1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdc2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdc3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdc4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdc5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdc6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdc7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdc8"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdc9"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdd"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdd1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdd2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdd3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdd4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdd5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdd6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdd7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdd8"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "sdd9"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "dm-0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "dm-1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "dm-2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "dm-3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "dm-4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "dm-5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "dm-6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "dm-7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "dm-8"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "dm-9"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop0p1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop0p2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop0p3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop0p4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop0p5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop0p6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop0p7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop0p8"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop0p9"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop1p1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop1p2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop1p3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop1p4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop1p5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop1p6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop1p7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop1p8"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop1p9"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop2p1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop2p2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop2p3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop2p4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop2p5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop2p6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop2p7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop2p8"))
	(call fs_devtmpfs_obj_type_transition (ARG1 fixed_disk.storage_dev blk_file "loop2p9")))

(macro storage_devtmpfs_obj_type_transition_removable ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mmcblk0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mmcblk0p1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mmcblk0p2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mmcblk0p3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mmcblk0p4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mmcblk0p5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mmcblk0p6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mmcblk0p7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mmcblk0p7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mmcblk0p9"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mspblk0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mspblk0p1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mspblk0p2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mspblk0p3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mspblk0p4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mspblk0p5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mspblk0p6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mspblk0p7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mspblk0p8"))
	(call fs_devtmpfs_obj_type_transition (ARG1 removable_storage.storage_dev blk_file "mspblk0p9")))

(macro storage_devtmpfs_obj_type_transition_scsi_generic ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "sg0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "sg1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "sg2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "sg3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "0:0:0:0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "1:0:0:0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "2:0:0:0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "3:0:0:0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "4:0:0:0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "5:0:0:0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "6:0:0:0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "7:0:0:0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "8:0:0:0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 scsi_generic.storage_dev chr_file "9:0:0:0")))

(macro storage_unconfined_subj_type ((type ARG1))
	(typeattributeset storage_unconfined_subj_type ARG1))
(typeattribute storage_unconfined_subj_type)

(block fixed_disk
	(blockinherit dev_storage_obj_blk))

(block fuse_storage
	(blockinherit dev_storage_obj_blk))

(block removable_storage
	(blockinherit dev_storage_obj_blk))

(block scsi_generic
	(blockinherit dev_storage_obj_blk))

(typeattribute storage_read_fixed_disk_subj_type)
(typeattribute storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type)

(typeattributeset storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type
	(not (storage_read_fixed_disk_subj_type storage_unconfined_subj_type)))

(typeattribute not_storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type)
(typeattributeset not_storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type
	(not storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type))

(neverallow storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (chr_file (read)))
(neverallow storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (blk_file (read)))

(typeattribute storage_write_fixed_disk_subj_type)
(typeattribute storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type)

(typeattributeset storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type
	(not (storage_write_fixed_disk_subj_type storage_unconfined_subj_type)))

(typeattribute not_storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type)
(typeattributeset not_storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type
	(not storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type))

(neverallow storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (chr_file (append write)))
(neverallow storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (blk_file (append write)))

(typeattribute storage_read_scsi_generic_subj_type)
(typeattribute storage_not_read_scsi_generic_subj_type_or_storage_unconfined_subj_type)

(typeattributeset storage_not_read_scsi_generic_subj_type_or_storage_unconfined_subj_type
	(not (storage_read_scsi_generic_subj_type storage_unconfined_subj_type)))

(typeattribute not_storage_not_read_scsi_generic_subj_type_or_storage_unconfined_subj_type)
(typeattributeset not_storage_not_read_scsi_generic_subj_type_or_storage_unconfined_subj_type
	(not storage_not_read_scsi_generic_subj_type_or_storage_unconfined_subj_type))

(neverallow storage_not_read_scsi_generic_subj_type_or_storage_unconfined_subj_type
	scsi_generic.storage_dev (chr_file (read)))

(typeattribute storage_write_scsi_generic_subj_type)
(typeattribute storage_not_write_scsi_generic_subj_type_or_storage_unconfined_subj_type)

(typeattributeset storage_not_write_scsi_generic_subj_type_or_storage_unconfined_subj_type
	(not (storage_write_scsi_generic_subj_type storage_unconfined_subj_type)))

(typeattribute not_storage_not_write_scsi_generic_subj_type_or_storage_unconfined_subj_type)
(typeattributeset not_storage_not_write_scsi_generic_subj_type_or_storage_unconfined_subj_type
	(not storage_not_write_scsi_generic_subj_type_or_storage_unconfined_subj_type))


(neverallow storage_not_write_scsi_generic_subj_type_or_storage_unconfined_subj_type
	scsi_generic.storage_dev (chr_file (append write)))

(allow storage_unconfined_subj_type fixed_disk.storage_dev all_chr_file_perms_except_mounton_and_execmod)
(allow storage_unconfined_subj_type fixed_disk.storage_dev all_blk_file_perms_except_mounton_and_execmod)

(allow storage_unconfined_subj_type fuse_storage.storage_dev all_chr_file_perms_except_mounton_and_execmod)

(allow storage_unconfined_subj_type removable_storage.storage_dev all_blk_file_perms_except_mounton_and_execmod)

(allow storage_unconfined_subj_type scsi_generic.storage_dev all_chr_file_perms_except_mounton_and_execmod)
(tunableif enable_rbacsep
	(true
		(context cmd (sys.id sys.role cmd.cmd_file (systemlow systemlow)))
		(context shell (sys.id sys.role shell.cmd_file (systemlow systemlow))))
	(false
		(context cmd (sys.id object_r cmd.cmd_file (systemlow systemlow)))
		(context shell (sys.id object_r shell.cmd_file (systemlow systemlow)))))

(filecon "/etc/kernel/postinst\.d(/.*)?" file cmd)
(filecon "/etc/profile\.d(/.*)?" file cmd)
(filecon "/etc/rc\.d/init\.d(/.*)?" file cmd)
(filecon "/etc/rc\.d/rc\.local" file cmd)
(filecon "/etc/sysconfig/network-scripts/ifdown-.*" file cmd)
(filecon "/etc/sysconfig/network-scripts/ifup-.*" file cmd)
(filecon "/etc/sysconfig/network-scripts/init\.ipv6-global" file cmd)
(filecon "/usr/bin(/.*)?" any cmd)
(filecon "/usr/bin/bash" file shell)
(filecon "/usr/bin" symlink cmd)
(filecon "/usr/libexec(/.*)?" any cmd)
(filecon "/usr/sbin(/.*)?" any cmd)
(filecon "/usr/sbin/nologin" file shell)
(filecon "/usr/sbin" symlink cmd)
(block cmd_obj_blk
	(blockabstract cmd_obj_blk)

	(type cmd_file)
	(call cmd_obj_type (cmd_file)))

(macro cmd_obj_type ((type ARG1))
	(typeattributeset cmd_obj_type ARG1))

(macro cmd_read_cmd ((type ARG1))
	(call file_search_data (ARG1))
	(allow ARG1 cmd.cmd_file list_dir_perms)
	(allow ARG1 cmd.cmd_file read_file_perms)
	(allow ARG1 cmd.cmd_file read_lnk_file_perms))

(macro cmd_read_cmd_files ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 cmd.cmd_file read_file_perms))

(macro cmd_read_cmd_lnk_files ((type ARG1))
	(call file_search_data (ARG1))
	(call read_lnk_files_pattern (ARG1 cmd.cmd_file cmd.cmd_file)))

(macro cmd_search_cmd ((type ARG1))
	(call file_search_data (ARG1))
	(allow ARG1 cmd.cmd_file read_lnk_file_perms)
	(allow ARG1 cmd.cmd_file search_dir_perms))

(macro cmd_list_cmd ((type ARG1))
	(call file_search_data (ARG1))
	(allow ARG1 cmd.cmd_file read_lnk_file_perms)
	(allow ARG1 cmd.cmd_file list_dir_perms))

(macro cmd_obj_entry_subj ((type ARG1))
	(call subj_entry (ARG1 cmd.cmd_file)))

(macro cmd_auto_subj_type_transition ((type ARG1)(type ARG2))
	(call cmd_manual_subj_type_transition (ARG1 ARG2))
	(typetransition ARG1 cmd.cmd_file process "*" ARG2))

(macro cmd_manual_subj_type_transition ((type ARG1)(type ARG2))
	(call manual_subj_type_transition_pattern (ARG1 cmd.cmd_file ARG2)))

(macro cmd_exec_cmd ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 cmd.cmd_file exec_file_perms))

(macro cmd_mmap_cmd ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 cmd.cmd_file mmap_file_perms))

(macro cmd_audit_exec_access_all_cmd_files ((type ARG1))
	(allow ARG1 cmd.cmd_file (file (execute))))

(macro cmd_exec_all_cmd ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 cmd_obj_type exec_file_perms))

(macro cmd_mmap_all_cmd ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 cmd_obj_type mmap_file_perms))

(macro cmd_read_all_cmd_files ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 cmd_obj_type read_file_perms))

(macro cmd_getattr_cmd_files ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 cmd.cmd_file (file (getattr))))

(macro cmd_getattr_all_cmd_files ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 cmd_obj_type (file (getattr))))

(macro cmd_shell_obj_entry_subj ((type ARG1))
	(call subj_entry (ARG1 shell.cmd_file)))

(macro cmd_shell_auto_subj_type_transition ((type ARG1)(type ARG2))
	(call cmd_shell_manual_subj_type_transition (ARG1 ARG2))
	(typetransition ARG1 shell.cmd_file process "*" ARG2))

(macro cmd_shell_manual_subj_type_transition ((type ARG1)(type ARG2))
	(call manual_subj_type_transition_pattern (ARG1 shell.cmd_file ARG2)))

(macro cmd_getattr_shell_files ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 shell.cmd_file (file (getattr))))

(macro cmd_exec_shell ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 shell.cmd_file exec_file_perms))

(macro cmd_mmap_shell ((type ARG1))
	(call cmd_search_cmd (ARG1))
	(allow ARG1 shell.cmd_file mmap_file_perms))

(macro cmd_audit_exec_access_cmd_files ((type ARG1))
	(allow ARG1 cmd.cmd_file (file (execute))))

(macro cmd_audit_exec_access_shell_files ((type ARG1))
	(allow ARG1 shell.cmd_file (file (execute))))

(macro cmd_audit_read_access_cmd_files ((type ARG1))
	(allow ARG1 cmd.cmd_file (file (read))))

(macro cmd_audit_read_access_shell_files ((type ARG1))
	(allow ARG1 shell.cmd_file (file (read))))
(typeattribute cmd_obj_type)

(block cmd
	(blockinherit cmd_obj_blk))

(block shell
	(blockinherit cmd_obj_blk))

(call file_obj_type (cmd_obj_type))
(tunableif enable_rbacsep
	(true
		(context apm (sys.id sys.role apm.dev (systemlow systemlow)))
		(context autofs_dev (sys.id sys.role autofs_dev.dev (systemlow systemlow)))
		(context clock (sys.id sys.role clock.dev (systemlow systemlow)))
		(context cpu (sys.id sys.role cpu.dev (systemlow systemlow)))
		(context devtty (sys.id sys.role devtty.dev (systemlow systemlow)))
		(context dri (sys.id sys.role dri.dev (systemlow systemlow)))
		(context event (sys.id sys.role event.dev (systemlow systemlow)))
		(context framebuf (sys.id sys.role framebuf.dev (systemlow systemlow)))
		(context kvm (sys.id sys.role kvm.dev (systemlow systemlow)))
		(context loop_control (sys.id sys.role loop_control.dev (systemlow systemlow)))
		(context lvm_control (sys.id sys.role lvm_control.dev (systemlow systemlow)))
		(context mei_misc (sys.id sys.role mei_misc.dev (systemlow systemlow)))
		(context mouse (sys.id sys.role mouse.dev (systemlow systemlow)))
		(context null (sys.id sys.role null.dev (systemlow systemlow)))
		(context pm_qos_misc (sys.id sys.role pm_qos_misc.dev (systemlow systemlow)))
		(context ppp (sys.id sys.role ppp.dev (systemlow systemlow)))
		(context printer (sys.id sys.role printer.dev (systemlow systemlow)))
		(context ptmx (sys.id sys.role ptmx.dev (systemlow systemlow)))
		(context random (sys.id sys.role random.dev (systemlow systemlow)))
		(context sound (sys.id sys.role sound.dev (systemlow systemlow)))
		(context tpm (sys.id sys.role tpm.dev (systemlow systemlow)))
		(context tun_tap (sys.id sys.role tun_tap.dev (systemlow systemlow)))
		(context uhid (sys.id sys.role uhid.dev (systemlow systemlow)))
		(context urandom (sys.id sys.role urandom.dev (systemlow systemlow)))
		(context usbmon (sys.id sys.role usbmon.dev (systemlow systemlow)))
		(context usb (sys.id sys.role usb.dev (systemlow systemlow)))
		(context v4l (sys.id sys.role v4l.dev (systemlow systemlow)))
		(context vfio (sys.id sys.role vfio.dev (systemlow systemlow)))
		(context vhost (sys.id sys.role vhost.dev (systemlow systemlow)))
		(context watchdog (sys.id sys.role watchdog.dev (systemlow systemlow)))
		(context wireless (sys.id sys.role wireless.dev (systemlow systemlow)))
		(context xserver_misc (sys.id sys.role xserver_misc.dev (systemlow systemlow)))
		(context zero (sys.id sys.role zero.dev (systemlow systemlow))))
	(false
		(context apm (sys.id object_r apm.dev (systemlow systemlow)))
		(context autofs_dev (sys.id object_r autofs_dev.dev (systemlow systemlow)))
		(context clock (sys.id object_r clock.dev (systemlow systemlow)))
		(context cpu (sys.id object_r cpu.dev (systemlow systemlow)))
		(context devtty (sys.id object_r devtty.dev (systemlow systemlow)))
		(context dri (sys.id object_r dri.dev (systemlow systemlow)))
		(context event (sys.id object_r event.dev (systemlow systemlow)))
		(context framebuf (sys.id object_r framebuf.dev (systemlow systemlow)))
		(context kvm (sys.id object_r kvm.dev (systemlow systemlow)))
		(context loop_control (sys.id object_r loop_control.dev (systemlow systemlow)))
		(context lvm_control (sys.id object_r lvm_control.dev (systemlow systemlow)))
		(context mei_misc (sys.id object_r mei_misc.dev (systemlow systemlow)))
		(context mouse (sys.id object_r mouse.dev (systemlow systemlow)))
		(context null (sys.id object_r null.dev (systemlow systemlow)))
		(context pm_qos_misc (sys.id object_r pm_qos_misc.dev (systemlow systemlow)))
		(context ppp (sys.id object_r ppp.dev (systemlow systemlow)))
		(context printer (sys.id object_r printer.dev (systemlow systemlow)))
		(context ptmx (sys.id object_r ptmx.dev (systemlow systemlow)))
		(context random (sys.id object_r random.dev (systemlow systemlow)))
		(context sound (sys.id object_r sound.dev (systemlow systemlow)))
		(context tpm (sys.id object_r tpm.dev (systemlow systemlow)))
		(context tun_tap (sys.id object_r tun_tap.dev (systemlow systemlow)))
		(context uhid (sys.id object_r uhid.dev (systemlow systemlow)))
		(context urandom (sys.id object_r urandom.dev (systemlow systemlow)))
		(context usbmon (sys.id object_r usbmon.dev (systemlow systemlow)))
		(context usb (sys.id object_r usb.dev (systemlow systemlow)))
		(context v4l (sys.id object_r v4l.dev (systemlow systemlow)))
		(context vfio (sys.id object_r vfio.dev (systemlow systemlow)))
		(context vhost (sys.id object_r vhost.dev (systemlow systemlow)))
		(context watchdog (sys.id object_r watchdog.dev (systemlow systemlow)))
		(context wireless (sys.id object_r wireless.dev (systemlow systemlow)))
		(context xserver_misc (sys.id object_r xserver_misc.dev (systemlow systemlow)))
		(context zero (sys.id object_r zero.dev (systemlow systemlow)))))

(tunableif enable_mls
	(true
		(tunableif enable_rbacsep
			(true
				(context kmsg (sys.id sys.role kmsg_dev.dev (systemhigh systemhigh)))
				(context memory (sys.id sys.role memory.dev (systemhigh systemhigh)))
				(context nvram (sys.id sys.role nvram.dev (systemhigh systemhigh))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context kmsg (sys.id object_r kmsg_dev.dev (systemhigh systemhigh)))
				(context memory (sys.id object_r memory.dev (systemhigh systemhigh)))
				(context nvram (sys.id object_r nvram.dev (systemhigh systemhigh)))))))

(tunableif (not enable_mls)
	(true
		(tunableif enable_rbacsep
			(true
				(context kmsg (sys.id sys.role kmsg_dev.dev (systemlow systemlow)))
				(context memory (sys.id sys.role memory.dev (systemlow systemlow)))
				(context nvram (sys.id sys.role nvram.dev (systemlow systemlow))))))
	(false
		(tunableif (not enable_rbacsep)
			(true
				(context kmsg (sys.id object_r kmsg_dev.dev (systemlow systemlow)))
				(context memory (sys.id object_r memory.dev (systemlow systemlow)))
				(context nvram (sys.id object_r nvram.dev (systemlow systemlow)))))))

(filecon "/dev/autofs" char autofs_dev)
(filecon "/dev/btrfs-control" char lvm_control)
(filecon "/dev/bus/usb/.+" char usb)
(filecon "/dev/cpu/.+" char cpu)
(filecon "/dev/cpu_dma_latency" char pm_qos_misc)
(filecon "/dev/dri/.+" char dri)
(filecon "/dev/fb([0-9]+)?" char framebuf)
(filecon "/dev/full" char null)
(filecon "/dev/hidraw[0-9]+" char usb)
(filecon "/dev/hpet" char clock)
(filecon "/dev/hwrng" char random)
(filecon "/dev/input/event([0-9]+)?" char event)
(filecon "/dev/input/mice" char mouse)
(filecon "/dev/input/mouse([0-9]+)?" char mouse)
(filecon "/dev/kmsg" char kmsg)
(filecon "/dev/kvm" char kvm)
(filecon "/dev/loop-control" char loop_control)
(filecon "/dev/mapper/control" char lvm_control)
(filecon "/dev/mcelog" char kmsg)
(filecon "/dev/media([0-9]+)?" char v4l)
(filecon "/dev/mei([0-9]+)?" char mei_misc)
(filecon "/dev/mem" char memory)
(filecon "/dev/memory_bandwidth" char pm_qos_misc)
(filecon "/dev/ndctl([0-9]+)?" char nvram)
(filecon "/dev/net/tun" char tun_tap)
(filecon "/dev/network_latency" char pm_qos_misc)
(filecon "/dev/network_throughput" char pm_qos_misc)
(filecon "/dev/null" char null)
(filecon "/dev/nvram" char nvram)
(filecon "/dev/parport([0-9]+)?" char printer)
(filecon "/dev/port" char memory)
(filecon "/dev/ppp" char ppp)
(filecon "/dev/ptmx" char ptmx)
(filecon "/dev/ptp([0-9]+)?" char clock)
(filecon "/dev/random" char random)
(filecon "/dev/rfkill" char wireless)
(filecon "/dev/rtc([0-9]+)?" char clock)
(filecon "/dev/snapshot" char apm)
(filecon "/dev/snd/.+" char sound)
(filecon "/dev/tpm([0-9]+)?" char tpm)
(filecon "/dev/tty" char devtty)
(filecon "/dev/uhid" char uhid)
(filecon "/dev/uinput" char event)
(filecon "/dev/urandom" char urandom)
(filecon "/dev/usbmon[0-9]+" char usbmon)
(filecon "/dev/vfio/.+" char vfio)
(filecon "/dev/vga_arbiter" char xserver_misc)
(filecon "/dev/vhci" char vhost)
(filecon "/dev/vhost-net" char vhost)
(filecon "/dev/video([0-9]+)?" char v4l)
(filecon "/dev/watchdog([0-9]+)?" char watchdog)
(filecon "/dev/zero" char zero)

(sidcontext devnull null)
(block dev_obj_blk
	(blockabstract dev_obj_blk)

	(type dev)
	(call dev_obj_type (dev)))

(block dev_storage_obj_blk
	(blockabstract dev_storage_obj_blk)

	(type storage_dev)
	(call dev_storage_obj_type (storage_dev)))

(macro dev_obj_type ((type ARG1))
	(typeattributeset dev_obj_type ARG1))

(macro dev_storage_obj_type ((type ARG1))
	(call dev_obj_type (ARG1))
	(typeattributeset dev_storage_obj_type ARG1))

(macro dev_getattr_all ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 dev_except_storage_obj_type (chr_file (getattr)))
	(optional dev_getattr_all_optional_storage
		(call storage_getattr_all (ARG1))))

(macro dev_relabel_all ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 dev_except_storage_obj_type relabel_chr_file_perms)
	(optional dev_relabel_all_optional_storage
		(call storage_relabel_all (ARG1))))

(macro dev_relabelto_all ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 dev_except_storage_obj_type relabelto_chr_file_perms)
	(optional dev_relabelto_all_optional_storage
		(call storage_relabelto_all (ARG1))))

(macro dev_manage_all ((type ARG1))
	(call fs_rw_devtmpfs_dirs (ARG1))
	(allow ARG1 dev_except_storage_obj_type manage_chr_file_perms)
	(typeattributeset dev_read_memory_subj_type ARG1)
	(typeattributeset dev_write_memory_subj_type ARG1)
	(optional dev_manage_all_optional_storage
		(call storage_manage_all (ARG1))))

(macro dev_rw_all ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 dev_except_storage_obj_type rw_chr_file_perms)
	(typeattributeset dev_read_memory_subj_type ARG1)
	(typeattributeset dev_write_memory_subj_type ARG1)
	(optional dev_rw_all_optional_storage
		(call storage_rw_all (ARG1))))

(macro dev_write_all ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 dev_except_storage_obj_type write_chr_file_perms)
	(typeattributeset dev_write_memory_subj_type ARG1)
	(optional dev_write_all_optional_storage
		(call storage_write_all (ARG1))))

(macro dev_setattr_all ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 dev_except_storage_obj_type (chr_file (setattr)))
	(optional dev_setattr_all_optional_storage
		(call storage_setattr_all (ARG1))))

(macro dev_getattr_dri ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 dri.dev (chr_file (getattr))))

(macro dev_getattr_kvm ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 kvm.dev (chr_file (getattr))))

(macro dev_getattr_random ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 random.dev (chr_file (getattr))))

(macro dev_getattr_sound ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 sound.dev (chr_file (getattr))))

(macro dev_getattr_tun_tap ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tun_tap.dev (chr_file (getattr))))

(macro dev_getattr_wireless ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 wireless.dev (chr_file (getattr))))

(macro dev_getattr_urandom ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 urandom.dev (chr_file (getattr))))

(macro dev_getattr_v4l ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 v4l.dev (chr_file (getattr))))

(macro dev_create_devtty ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 devtty.dev create_chr_file_perms))

(macro dev_tmpfs_obj_type_transition_devtty ((type ARG1))
	(call fs_tmpfs_obj_type_transition (ARG1 devtty.dev chr_file "tty")))

(macro dev_create_null ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 null.dev create_chr_file_perms))

(macro dev_tmpfs_obj_type_transition_null ((type ARG1))
	(call fs_tmpfs_obj_type_transition (ARG1 null.dev chr_file "full"))
	(call fs_tmpfs_obj_type_transition (ARG1 null.dev chr_file "null")))

(macro dev_create_event ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 event.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_event ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event4"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event5"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event6"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event7"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event8"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event9"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event10"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event11"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event12"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event13"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event14"))
	(call fs_devtmpfs_obj_type_transition (ARG1 event.dev chr_file "event15")))

(macro dev_create_printer ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 printer.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_printer ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 printer.dev chr_file "parport0")))

(macro dev_create_random ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 random.dev create_chr_file_perms))

(macro dev_tmpfs_obj_type_transition_random ((type ARG1))
	(call fs_tmpfs_obj_type_transition (ARG1 random.dev chr_file "hwrng"))
	(call fs_tmpfs_obj_type_transition (ARG1 random.dev chr_file "random")))

(macro dev_create_sound ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 sound.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_sound ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "hwC0D0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "hwC1D0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "hwC0D3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC0D0c"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC0D0p"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC0D3p"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC0D7p"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC0D8p"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC1D0c"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC1D0p"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC1D3p"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC1D7p"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC1D8p"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC1D9p"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC2D0c"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "pcmC2D0p"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "controlC0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "controlC1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "controlC2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 sound.dev chr_file "controlC29")))

(macro dev_create_urandom ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 urandom.dev create_chr_file_perms))

(macro dev_tmpfs_obj_type_transition_urandom ((type ARG1))
	(call fs_tmpfs_obj_type_transition (ARG1 urandom.dev chr_file "urandom")))

(macro dev_create_usb ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 usb.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_usb ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "001"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "002"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "003"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "004"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "005"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "006"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "007"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "008"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "009"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "010"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "011"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "012"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "013"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "014"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "hidraw0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "hidraw1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "hidraw2"))
	(call fs_devtmpfs_obj_type_transition (ARG1 usb.dev chr_file "hidraw3")))

(macro dev_create_v4l ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 v4l.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_v4l ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 v4l.dev chr_file "media0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 v4l.dev chr_file "media1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 v4l.dev chr_file "media3"))
	(call fs_devtmpfs_obj_type_transition (ARG1 v4l.dev chr_file "video0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 v4l.dev chr_file "video1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 v4l.dev chr_file "video2")))

(macro dev_create_watchdog ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 watchdog.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_watchdog ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 watchdog.dev chr_file "watchdog"))
	(call fs_devtmpfs_obj_type_transition (ARG1 watchdog.dev chr_file "watchdog0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 watchdog.dev chr_file "watchdog1")))

(macro dev_create_zero ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 zero.dev create_chr_file_perms))

(macro dev_tmpfs_obj_type_transition_zero ((type ARG1))
	(call fs_tmpfs_obj_type_transition (ARG1 zero.dev chr_file "zero")))

(macro dev_read_autofs ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 autofs_dev.dev read_chr_file_perms))

(macro dev_read_clock ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 clock.dev read_chr_file_perms))

(macro dev_create_clock ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 clock.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_clock ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 clock.dev chr_file "ptp0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 clock.dev chr_file "ptp1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 clock.dev chr_file "ptp3")))

(macro dev_read_cpu ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 cpu.dev read_chr_file_perms))

(macro dev_read_event ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 event.dev read_chr_file_perms))

(macro dev_read_kmsg ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 kmsg_dev.dev read_chr_file_perms))

(macro dev_read_loop_control ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 loop_control.dev read_chr_file_perms))

(macro dev_read_memory ((type ARG1))
	(allow ARG1 self (capability (sys_rawio)))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 memory.dev read_chr_file_perms)
	(typeattributeset dev_read_memory_subj_type ARG1))

(macro dev_create_mouse ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 mouse.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_mouse ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 mouse.dev chr_file "mouse0"))
	(call fs_devtmpfs_obj_type_transition (ARG1 mouse.dev chr_file "mouse1"))
	(call fs_devtmpfs_obj_type_transition (ARG1 mouse.dev chr_file "mouse2")))

(macro dev_read_random ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 random.dev read_chr_file_perms))

(macro dev_read_urandom ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 urandom.dev read_chr_file_perms))

(macro dev_read_usbmon ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 usbmon.dev read_chr_file_perms))

(macro dev_read_wireless ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 wireless.dev read_chr_file_perms))

(macro dev_create_wireless ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 wireless.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_wireless ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 wireless.dev chr_file "rfkill")))

(macro dev_rw_cpu ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 cpu.dev rw_chr_file_perms))

(macro dev_rw_devtty ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 devtty.dev rw_chr_file_perms))

(macro dev_rw_dri ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 dri.dev rw_chr_file_perms))

(macro dev_rw_inherited_dri ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 dri.dev rw_inherited_chr_file_perms))

(macro dev_rw_event ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 event.dev rw_chr_file_perms))

(macro dev_rw_inherited_event ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 event.dev rw_inherited_chr_file_perms))

(macro dev_rw_framebuf ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 framebuf.dev rw_chr_file_perms))

(macro dev_rw_kmsg ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 kmsg_dev.dev rw_chr_file_perms))

(macro dev_rw_kvm ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 kvm.dev rw_chr_file_perms))

(macro dev_create_kvm ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 kvm.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_kvm ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 kvm.dev chr_file "kvm")))

(macro dev_rw_loop_control ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 loop_control.dev rw_chr_file_perms))

(macro dev_rw_lvm_control ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 lvm_control.dev rw_chr_file_perms))

(macro dev_rw_null ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 null.dev rw_chr_file_perms))

(macro dev_rw_ptmx ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 ptmx.dev rw_chr_file_perms))

(macro dev_rw_inherited_ptmx ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 ptmx.dev rw_inherited_chr_file_perms))

(macro dev_rw_sound ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 sound.dev rw_chr_file_perms))

(macro dev_rw_tpm ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tpm.dev rw_chr_file_perms))

(macro dev_create_tpm ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 tpm.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_tpm ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 wireless.dev chr_file "tpm0")))

(macro dev_rw_tun_tap ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 tun_tap.dev rw_chr_file_perms))

(macro dev_rw_urandom ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 urandom.dev rw_chr_file_perms))

(macro dev_rw_usb ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 usb.dev rw_chr_file_perms))

(macro dev_rw_v4l ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 v4l.dev rw_chr_file_perms))

(macro dev_rw_wireless ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 wireless.dev rw_chr_file_perms))

(macro dev_rw_xserver_misc ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 xserver_misc.dev rw_chr_file_perms))

(macro dev_rw_zero ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 zero.dev rw_chr_file_perms))

(macro dev_setattr_dri ((type ARG1))
	(allow ARG1 dri.dev (chr_file (setattr))))

(macro dev_setattr_kvm ((type ARG1))
	(allow ARG1 kvm.dev (chr_file (setattr))))

(macro dev_setattr_null ((type ARG1))
	(allow ARG1 null.dev (chr_file (setattr))))

(macro dev_setattr_sound ((type ARG1))
	(allow ARG1 sound.dev (chr_file (setattr))))

(macro dev_setattr_wireless ((type ARG1))
	(allow ARG1 wireless.dev (chr_file (setattr))))

(macro dev_setattr_v4l ((type ARG1))
	(allow ARG1 v4l.dev (chr_file (setattr))))

(macro dev_dontaudit_write_kmsg ((type ARG1))
	(dontaudit ARG1 kmsg_dev.dev write_chr_file_perms))

(macro dev_write_kmsg ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 kmsg_dev.dev write_chr_file_perms))

(macro dev_create_mei_misc ((type ARG1))
	(allow ARG1 self (capability (mknod)))
	(call fs_add_entry_devtmpfs (ARG1))
	(allow ARG1 mei_misc.dev create_chr_file_perms))

(macro dev_devtmpfs_obj_type_transition_mei_misc ((type ARG1))
	(call fs_devtmpfs_obj_type_transition (ARG1 mei_misc.dev chr_file "mei0")))

(macro dev_write_memory ((type ARG1))
	(allow ARG1 self (capability (sys_rawio)))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 memory.dev write_chr_file_perms)
	(typeattributeset dev_write_memory_subj_type ARG1))

(macro dev_write_watchdog ((type ARG1))
	(call fs_search_devtmpfs (ARG1))
	(allow ARG1 watchdog.dev write_chr_file_perms))

(macro dev_unconfined_subj_type ((type ARG1))
	(typeattributeset dev_unconfined_subj_type ARG1))
(sid devnull)

(typeattribute dev_obj_type)
(typeattribute dev_storage_obj_type)

(typeattribute dev_unconfined_subj_type)

(block apm
	(blockinherit dev_obj_blk))

(block autofs_dev
	(blockinherit dev_obj_blk))

(block clock
	(blockinherit dev_obj_blk))

(block cpu
	(blockinherit dev_obj_blk))

(block devtty
	(blockinherit dev_obj_blk)

	(call mls_trusted_obj_type (dev))

	(call fs_associate_tmpfs (dev)))

(block dri
	(blockinherit dev_obj_blk))

(block event
	(blockinherit dev_obj_blk))

(block framebuf
	(blockinherit dev_obj_blk))

(block kmsg_dev
	(blockinherit dev_obj_blk))

(block kvm
	(blockinherit dev_obj_blk)

	(call mls_trusted_obj_type (dev)))

(block loop_control
	(blockinherit dev_obj_blk))

(block lvm_control
	(blockinherit dev_obj_blk))

(block mei_misc
	(blockinherit dev_obj_blk))

(block memory
	(blockinherit dev_obj_blk))

(block mouse
	(blockinherit dev_obj_blk))

(block null
	(blockinherit dev_obj_blk)

	(call mls_trusted_obj_type (dev))

	(call fs_associate_tmpfs (dev)))

(block nvram
	(blockinherit dev_obj_blk))

(block printer
	(blockinherit dev_obj_blk))

(block pm_qos_misc
	(blockinherit dev_obj_blk))

(block ppp
	(blockinherit dev_obj_blk))

(block ptmx
	(blockinherit dev_obj_blk)

	(call mls_trusted_obj_type (dev)))

(block random
	(blockinherit dev_obj_blk)

	(call fs_associate_tmpfs (dev)))

(block sound
	(blockinherit dev_obj_blk))

(block tpm
	(blockinherit dev_obj_blk))

(block tun_tap
	(blockinherit dev_obj_blk))

(block uhid
	(blockinherit dev_obj_blk))

(block urandom
	(blockinherit dev_obj_blk)

	(call fs_associate_tmpfs (dev)))

(block usb
	(blockinherit dev_obj_blk))

(block usbmon
	(blockinherit dev_obj_blk))

(block v4l
	(blockinherit dev_obj_blk))

(block vfio
	(blockinherit dev_obj_blk))

(block vhost
	(blockinherit dev_obj_blk)

	(call mls_trusted_obj_type (dev)))

(block watchdog
	(blockinherit dev_obj_blk))

(block wireless
	(blockinherit dev_obj_blk))

(block xserver_misc
	(blockinherit dev_obj_blk))

(block zero
	(blockinherit dev_obj_blk)

	(call mls_trusted_obj_type (dev))

	(call fs_associate_tmpfs (dev)))

(call sys_obj_type (dev_obj_type))
(call fs_associate_devtmpfs (dev_obj_type))

(typeattribute dev_read_memory_subj_type)
(typeattribute dev_not_read_memory_subj_type_or_dev_unconfined_subj_type)

(typeattributeset dev_not_read_memory_subj_type_or_dev_unconfined_subj_type
	(not (dev_read_memory_subj_type dev_unconfined_subj_type)))

(typeattribute not_dev_not_read_memory_subj_type_or_dev_unconfined_subj_type)
(typeattributeset not_dev_not_read_memory_subj_type_or_dev_unconfined_subj_type
	(not dev_not_read_memory_subj_type_or_dev_unconfined_subj_type))

(neverallow dev_not_read_memory_subj_type_or_dev_unconfined_subj_type
	memory.dev (chr_file (read)))

(typeattribute dev_write_memory_subj_type)
(typeattribute dev_not_write_memory_subj_type_or_dev_unconfined_subj_type)

(typeattributeset dev_not_write_memory_subj_type_or_dev_unconfined_subj_type
	(not (dev_write_memory_subj_type dev_unconfined_subj_type)))

(typeattribute not_dev_not_write_memory_subj_type_or_dev_unconfined_subj_type)
(typeattributeset not_dev_not_write_memory_subj_type_or_dev_unconfined_subj_type
	(not dev_not_write_memory_subj_type_or_dev_unconfined_subj_type))

(neverallow dev_not_write_memory_subj_type_or_dev_unconfined_subj_type
	memory.dev (chr_file (append write)))

(allow dev_unconfined_subj_type self (capability (sys_rawio)))

(typeattribute dev_except_storage_obj_type)

(typeattributeset dev_except_storage_obj_type (and (dev_obj_type) (not (dev_storage_obj_type))))

(allow dev_unconfined_subj_type dev_except_storage_obj_type all_chr_file_perms_except_mounton_and_execmod)
(sid file_labels)
(sid init)
(sid any_socket)
(sid igmp_packet)
(sid icmp_socket)
(sid tcp_socket)
(sid sysctl_modprobe)
(sid sysctl_fs)
(sid sysctl_kernel)
(sid sysctl_net)
(sid sysctl_net_unix)
(sid sysctl_vm)
(sid sysctl_dev)
(sid kmod)
(sid policy)
(sid scmp_packet)

(tunableif enable_rbacsep
	(true
		(context isid (sys.id sys.role unlabeled.isid (systemlow systemlow))))
	(false
		(context isid (sys.id object_r unlabeled.isid (systemlow systemlow)))))

(sidcontext file_labels isid)
(sidcontext init isid)
(sidcontext any_socket isid)
(sidcontext igmp_packet isid)
(sidcontext icmp_socket isid)
(sidcontext tcp_socket isid)
(sidcontext sysctl_modprobe isid)
(sidcontext sysctl_fs isid)
(sidcontext sysctl_kernel isid)
(sidcontext sysctl_net isid)
(sidcontext sysctl_net_unix isid)
(sidcontext sysctl_vm isid)
(sidcontext sysctl_dev isid)
(sidcontext kmod isid)
(sidcontext policy isid)
(sidcontext scmp_packet isid)

(sidorder (kernel security unlabeled fs file file_labels init any_socket port netif netmsg node igmp_packet icmp_socket
	tcp_socket sysctl_modprobe sysctl sysctl_fs sysctl_kernel sysctl_net sysctl_net_unix sysctl_vm sysctl_dev kmod policy
	scmp_packet devnull))
(macro mls_file_read_to_clr_subj_type ((type ARG1))
	(typeattributeset mls_file_read_to_clr_subj_type ARG1))

(macro mls_file_read_subj_type ((type ARG1))
	(typeattributeset mls_file_read_subj_type ARG1))

(macro mls_file_write_to_clr_subj_type ((type ARG1))
	(typeattributeset mls_file_write_to_clr_subj_type ARG1))

(macro mls_file_write_subj_type ((type ARG1))
	(typeattributeset mls_file_write_subj_type ARG1))

(macro mls_file_upgrade_subj_type ((type ARG1))
	(typeattributeset mls_file_upgrade_subj_type ARG1))

(macro mls_file_downgrade_subj_type ((type ARG1))
	(typeattributeset mls_file_downgrade_subj_type ARG1))

(macro mls_file_write_in_range_subj_type ((type ARG1))
	(typeattributeset mls_file_write_in_range_subj_type ARG1))

(macro mls_net_read_subj_type ((type ARG1))
	(typeattributeset mls_net_read_subj_type ARG1))

(macro mls_net_read_to_clr_subj_type ((type ARG1))
	(typeattributeset mls_net_read_to_clr_subj_type ARG1))

(macro mls_net_write_to_clr_subj_type ((type ARG1))
	(typeattributeset mls_net_write_to_clr_subj_type ARG1))

(macro mls_net_write_subj_type ((type ARG1))
	(typeattributeset mls_net_write_subj_type ARG1))

(macro mls_net_write_ranged_subj_type ((type ARG1))
	(typeattributeset mls_net_write_ranged_subj_type ARG1))

(macro mls_net_inbound_subj_type ((type ARG1))
	(typeattributeset mls_net_inbound_subj_type ARG1))

(macro mls_net_outbound_subj_type ((type ARG1))
	(typeattributeset mls_net_outbound_subj_type ARG1))

(macro mls_ipc_read_to_clr_subj_type ((type ARG1))
	(typeattributeset mls_ipc_read_to_clr_subj_type ARG1))

(macro mls_ipc_read_subj_type ((type ARG1))
	(typeattributeset mls_ipc_read_subj_type ARG1))

(macro mls_ipc_write_to_clr_subj_type ((type ARG1))
	(typeattributeset mls_ipc_write_to_clr_subj_type ARG1))

(macro mls_ipc_write_subj_type ((type ARG1))
	(typeattributeset mls_ipc_write_subj_type ARG1))

(macro mls_priv_range_trans_subj_type ((type ARG1))
	(typeattributeset mls_priv_range_trans_subj_type ARG1))

(macro mls_range_trans_subj_type ((type ARG1))
	(typeattributeset mls_range_trans_subj_type ARG1))

(macro mls_proc_read_to_clr_subj_type ((type ARG1))
	(typeattributeset mls_proc_read_to_clr_subj_type ARG1))

(macro mls_proc_read_subj_type ((type ARG1))
	(typeattributeset mls_proc_read_subj_type ARG1))

(macro mls_proc_write_to_clr_subj_type ((type ARG1))
	(typeattributeset mls_proc_write_to_clr_subj_type ARG1))

(macro mls_proc_write_subj_type ((type ARG1))
	(typeattributeset mls_proc_write_subj_type ARG1))

(macro mls_proc_set_sl_subj_type ((type ARG1))
	(typeattributeset mls_proc_set_sl_subj_type ARG1))

(macro mls_trusted_obj_type ((type ARG1))
	(typeattributeset mls_trusted_obj_type ARG1))

(macro mls_fd_use_subj_type ((type ARG1))
	(typeattributeset mls_fd_use_subj_type ARG1))

(macro mls_fd_share_subj_type ((type ARG1))
	(typeattributeset mls_fd_share_subj_type ARG1))
(typeattribute mls_file_read_subj_type)
(typeattribute mls_file_read_to_clr_subj_type)
(typeattribute mls_file_write_subj_type)
(typeattribute mls_file_write_to_clr_subj_type)
(typeattribute mls_file_write_in_range_subj_type)
(typeattribute mls_file_upgrade_subj_type)
(typeattribute mls_file_downgrade_subj_type)

(typeattribute mls_net_read_subj_type)
(typeattribute mls_net_read_to_clr_subj_type)
(typeattribute mls_net_write_subj_type)
(typeattribute mls_net_write_to_clr_subj_type)
(typeattribute mls_net_write_ranged_subj_type)
(typeattribute mls_net_inbound_subj_type)
(typeattribute mls_net_outbound_subj_type)

(typeattribute mls_ipc_read_subj_type)
(typeattribute mls_ipc_read_to_clr_subj_type)
(typeattribute mls_ipc_write_subj_type)
(typeattribute mls_ipc_write_to_clr_subj_type)

(typeattribute mls_proc_read_subj_type)
(typeattribute mls_proc_read_to_clr_subj_type)
(typeattribute mls_proc_write_subj_type)
(typeattribute mls_proc_write_to_clr_subj_type)
(typeattribute mls_proc_set_sl_subj_type)

(typeattribute mls_trusted_obj_type)

(typeattribute mls_priv_range_trans_subj_type)
(typeattribute mls_range_trans_subj_type)

(typeattribute mls_fd_use_subj_type)
(typeattribute mls_fd_share_subj_type)

(tunableif enable_mls
	(true
		(mls true)

		(sensitivity s0)
		(sensitivity s1)
		(sensitivity s2)
		(sensitivity s3)
		(sensitivity s4)
		(sensitivity s5)
		(sensitivity s6)
		(sensitivity s7)
		(sensitivity s8)
		(sensitivity s9)
		(sensitivity s10)
		(sensitivity s11)
		(sensitivity s12)
		(sensitivity s13)
		(sensitivity s14)
		(sensitivity s15)

		(sensitivityorder (s0 s1 s2 s3 s4 s5 s6 s7 s8 s9 s10 s11 s12 s13 s14 s15))

		(category c0)
		(category c1)
		(category c2)
		(category c3)
		(category c4)
		(category c5)
		(category c6)
		(category c7)
		(category c8)
		(category c9)
		(category c10)
		(category c11)
		(category c12)
		(category c13)
		(category c14)
		(category c15)
		(category c16)
		(category c17)
		(category c18)
		(category c19)
		(category c20)
		(category c21)
		(category c22)
		(category c23)
		(category c24)
		(category c25)
		(category c26)
		(category c27)
		(category c28)
		(category c29)
		(category c30)
		(category c31)
		(category c32)
		(category c33)
		(category c34)
		(category c35)
		(category c36)
		(category c37)
		(category c38)
		(category c39)
		(category c40)
		(category c41)
		(category c42)
		(category c43)
		(category c44)
		(category c45)
		(category c46)
		(category c47)
		(category c48)
		(category c49)
		(category c50)
		(category c51)
		(category c52)
		(category c53)
		(category c54)
		(category c55)
		(category c56)
		(category c57)
		(category c58)
		(category c59)
		(category c60)
		(category c61)
		(category c62)
		(category c63)
		(category c64)
		(category c65)
		(category c66)
		(category c67)
		(category c68)
		(category c69)
		(category c70)
		(category c71)
		(category c72)
		(category c73)
		(category c74)
		(category c75)
		(category c76)
		(category c77)
		(category c78)
		(category c79)
		(category c80)
		(category c81)
		(category c82)
		(category c83)
		(category c84)
		(category c85)
		(category c86)
		(category c87)
		(category c88)
		(category c89)
		(category c90)
		(category c91)
		(category c92)
		(category c93)
		(category c94)
		(category c95)
		(category c96)
		(category c97)
		(category c98)
		(category c99)
		(category c100)
		(category c101)
		(category c102)
		(category c103)
		(category c104)
		(category c105)
		(category c106)
		(category c107)
		(category c108)
		(category c109)
		(category c110)
		(category c111)
		(category c112)
		(category c113)
		(category c114)
		(category c115)
		(category c116)
		(category c117)
		(category c118)
		(category c119)
		(category c120)
		(category c121)
		(category c122)
		(category c123)
		(category c124)
		(category c125)
		(category c126)
		(category c127)
		(category c128)
		(category c129)
		(category c130)
		(category c131)
		(category c132)
		(category c133)
		(category c134)
		(category c135)
		(category c136)
		(category c137)
		(category c138)
		(category c139)
		(category c140)
		(category c141)
		(category c142)
		(category c143)
		(category c144)
		(category c145)
		(category c146)
		(category c147)
		(category c148)
		(category c149)
		(category c150)
		(category c151)
		(category c152)
		(category c153)
		(category c154)
		(category c155)
		(category c156)
		(category c157)
		(category c158)
		(category c159)
		(category c160)
		(category c161)
		(category c162)
		(category c163)
		(category c164)
		(category c165)
		(category c166)
		(category c167)
		(category c168)
		(category c169)
		(category c170)
		(category c171)
		(category c172)
		(category c173)
		(category c174)
		(category c175)
		(category c176)
		(category c177)
		(category c178)
		(category c179)
		(category c180)
		(category c181)
		(category c182)
		(category c183)
		(category c184)
		(category c185)
		(category c186)
		(category c187)
		(category c188)
		(category c189)
		(category c190)
		(category c191)
		(category c192)
		(category c193)
		(category c194)
		(category c195)
		(category c196)
		(category c197)
		(category c198)
		(category c199)
		(category c200)
		(category c201)
		(category c202)
		(category c203)
		(category c204)
		(category c205)
		(category c206)
		(category c207)
		(category c208)
		(category c209)
		(category c210)
		(category c211)
		(category c212)
		(category c213)
		(category c214)
		(category c215)
		(category c216)
		(category c217)
		(category c218)
		(category c219)
		(category c220)
		(category c221)
		(category c222)
		(category c223)
		(category c224)
		(category c225)
		(category c226)
		(category c227)
		(category c228)
		(category c229)
		(category c230)
		(category c231)
		(category c232)
		(category c233)
		(category c234)
		(category c235)
		(category c236)
		(category c237)
		(category c238)
		(category c239)
		(category c240)
		(category c241)
		(category c242)
		(category c243)
		(category c244)
		(category c245)
		(category c246)
		(category c247)
		(category c248)
		(category c249)
		(category c250)
		(category c251)
		(category c252)
		(category c253)
		(category c254)
		(category c255)
		(category c256)
		(category c257)
		(category c258)
		(category c259)
		(category c260)
		(category c261)
		(category c262)
		(category c263)
		(category c264)
		(category c265)
		(category c266)
		(category c267)
		(category c268)
		(category c269)
		(category c270)
		(category c271)
		(category c272)
		(category c273)
		(category c274)
		(category c275)
		(category c276)
		(category c277)
		(category c278)
		(category c279)
		(category c280)
		(category c281)
		(category c282)
		(category c283)
		(category c284)
		(category c285)
		(category c286)
		(category c287)
		(category c288)
		(category c289)
		(category c290)
		(category c291)
		(category c292)
		(category c293)
		(category c294)
		(category c295)
		(category c296)
		(category c297)
		(category c298)
		(category c299)
		(category c300)
		(category c301)
		(category c302)
		(category c303)
		(category c304)
		(category c305)
		(category c306)
		(category c307)
		(category c308)
		(category c309)
		(category c310)
		(category c311)
		(category c312)
		(category c313)
		(category c314)
		(category c315)
		(category c316)
		(category c317)
		(category c318)
		(category c319)
		(category c320)
		(category c321)
		(category c322)
		(category c323)
		(category c324)
		(category c325)
		(category c326)
		(category c327)
		(category c328)
		(category c329)
		(category c330)
		(category c331)
		(category c332)
		(category c333)
		(category c334)
		(category c335)
		(category c336)
		(category c337)
		(category c338)
		(category c339)
		(category c340)
		(category c341)
		(category c342)
		(category c343)
		(category c344)
		(category c345)
		(category c346)
		(category c347)
		(category c348)
		(category c349)
		(category c350)
		(category c351)
		(category c352)
		(category c353)
		(category c354)
		(category c355)
		(category c356)
		(category c357)
		(category c358)
		(category c359)
		(category c360)
		(category c361)
		(category c362)
		(category c363)
		(category c364)
		(category c365)
		(category c366)
		(category c367)
		(category c368)
		(category c369)
		(category c370)
		(category c371)
		(category c372)
		(category c373)
		(category c374)
		(category c375)
		(category c376)
		(category c377)
		(category c378)
		(category c379)
		(category c380)
		(category c381)
		(category c382)
		(category c383)
		(category c384)
		(category c385)
		(category c386)
		(category c387)
		(category c388)
		(category c389)
		(category c390)
		(category c391)
		(category c392)
		(category c393)
		(category c394)
		(category c395)
		(category c396)
		(category c397)
		(category c398)
		(category c399)
		(category c400)
		(category c401)
		(category c402)
		(category c403)
		(category c404)
		(category c405)
		(category c406)
		(category c407)
		(category c408)
		(category c409)
		(category c410)
		(category c411)
		(category c412)
		(category c413)
		(category c414)
		(category c415)
		(category c416)
		(category c417)
		(category c418)
		(category c419)
		(category c420)
		(category c421)
		(category c422)
		(category c423)
		(category c424)
		(category c425)
		(category c426)
		(category c427)
		(category c428)
		(category c429)
		(category c430)
		(category c431)
		(category c432)
		(category c433)
		(category c434)
		(category c435)
		(category c436)
		(category c437)
		(category c438)
		(category c439)
		(category c440)
		(category c441)
		(category c442)
		(category c443)
		(category c444)
		(category c445)
		(category c446)
		(category c447)
		(category c448)
		(category c449)
		(category c450)
		(category c451)
		(category c452)
		(category c453)
		(category c454)
		(category c455)
		(category c456)
		(category c457)
		(category c458)
		(category c459)
		(category c460)
		(category c461)
		(category c462)
		(category c463)
		(category c464)
		(category c465)
		(category c466)
		(category c467)
		(category c468)
		(category c469)
		(category c470)
		(category c471)
		(category c472)
		(category c473)
		(category c474)
		(category c475)
		(category c476)
		(category c477)
		(category c478)
		(category c479)
		(category c480)
		(category c481)
		(category c482)
		(category c483)
		(category c484)
		(category c485)
		(category c486)
		(category c487)
		(category c488)
		(category c489)
		(category c490)
		(category c491)
		(category c492)
		(category c493)
		(category c494)
		(category c495)
		(category c496)
		(category c497)
		(category c498)
		(category c499)
		(category c500)
		(category c501)
		(category c502)
		(category c503)
		(category c504)
		(category c505)
		(category c506)
		(category c507)
		(category c508)
		(category c509)
		(category c510)
		(category c511)
		(category c512)
		(category c513)
		(category c514)
		(category c515)
		(category c516)
		(category c517)
		(category c518)
		(category c519)
		(category c520)
		(category c521)
		(category c522)
		(category c523)
		(category c524)
		(category c525)
		(category c526)
		(category c527)
		(category c528)
		(category c529)
		(category c530)
		(category c531)
		(category c532)
		(category c533)
		(category c534)
		(category c535)
		(category c536)
		(category c537)
		(category c538)
		(category c539)
		(category c540)
		(category c541)
		(category c542)
		(category c543)
		(category c544)
		(category c545)
		(category c546)
		(category c547)
		(category c548)
		(category c549)
		(category c550)
		(category c551)
		(category c552)
		(category c553)
		(category c554)
		(category c555)
		(category c556)
		(category c557)
		(category c558)
		(category c559)
		(category c560)
		(category c561)
		(category c562)
		(category c563)
		(category c564)
		(category c565)
		(category c566)
		(category c567)
		(category c568)
		(category c569)
		(category c570)
		(category c571)
		(category c572)
		(category c573)
		(category c574)
		(category c575)
		(category c576)
		(category c577)
		(category c578)
		(category c579)
		(category c580)
		(category c581)
		(category c582)
		(category c583)
		(category c584)
		(category c585)
		(category c586)
		(category c587)
		(category c588)
		(category c589)
		(category c590)
		(category c591)
		(category c592)
		(category c593)
		(category c594)
		(category c595)
		(category c596)
		(category c597)
		(category c598)
		(category c599)
		(category c600)
		(category c601)
		(category c602)
		(category c603)
		(category c604)
		(category c605)
		(category c606)
		(category c607)
		(category c608)
		(category c609)
		(category c610)
		(category c611)
		(category c612)
		(category c613)
		(category c614)
		(category c615)
		(category c616)
		(category c617)
		(category c618)
		(category c619)
		(category c620)
		(category c621)
		(category c622)
		(category c623)
		(category c624)
		(category c625)
		(category c626)
		(category c627)
		(category c628)
		(category c629)
		(category c630)
		(category c631)
		(category c632)
		(category c633)
		(category c634)
		(category c635)
		(category c636)
		(category c637)
		(category c638)
		(category c639)
		(category c640)
		(category c641)
		(category c642)
		(category c643)
		(category c644)
		(category c645)
		(category c646)
		(category c647)
		(category c648)
		(category c649)
		(category c650)
		(category c651)
		(category c652)
		(category c653)
		(category c654)
		(category c655)
		(category c656)
		(category c657)
		(category c658)
		(category c659)
		(category c660)
		(category c661)
		(category c662)
		(category c663)
		(category c664)
		(category c665)
		(category c666)
		(category c667)
		(category c668)
		(category c669)
		(category c670)
		(category c671)
		(category c672)
		(category c673)
		(category c674)
		(category c675)
		(category c676)
		(category c677)
		(category c678)
		(category c679)
		(category c680)
		(category c681)
		(category c682)
		(category c683)
		(category c684)
		(category c685)
		(category c686)
		(category c687)
		(category c688)
		(category c689)
		(category c690)
		(category c691)
		(category c692)
		(category c693)
		(category c694)
		(category c695)
		(category c696)
		(category c697)
		(category c698)
		(category c699)
		(category c700)
		(category c701)
		(category c702)
		(category c703)
		(category c704)
		(category c705)
		(category c706)
		(category c707)
		(category c708)
		(category c709)
		(category c710)
		(category c711)
		(category c712)
		(category c713)
		(category c714)
		(category c715)
		(category c716)
		(category c717)
		(category c718)
		(category c719)
		(category c720)
		(category c721)
		(category c722)
		(category c723)
		(category c724)
		(category c725)
		(category c726)
		(category c727)
		(category c728)
		(category c729)
		(category c730)
		(category c731)
		(category c732)
		(category c733)
		(category c734)
		(category c735)
		(category c736)
		(category c737)
		(category c738)
		(category c739)
		(category c740)
		(category c741)
		(category c742)
		(category c743)
		(category c744)
		(category c745)
		(category c746)
		(category c747)
		(category c748)
		(category c749)
		(category c750)
		(category c751)
		(category c752)
		(category c753)
		(category c754)
		(category c755)
		(category c756)
		(category c757)
		(category c758)
		(category c759)
		(category c760)
		(category c761)
		(category c762)
		(category c763)
		(category c764)
		(category c765)
		(category c766)
		(category c767)
		(category c768)
		(category c769)
		(category c770)
		(category c771)
		(category c772)
		(category c773)
		(category c774)
		(category c775)
		(category c776)
		(category c777)
		(category c778)
		(category c779)
		(category c780)
		(category c781)
		(category c782)
		(category c783)
		(category c784)
		(category c785)
		(category c786)
		(category c787)
		(category c788)
		(category c789)
		(category c790)
		(category c791)
		(category c792)
		(category c793)
		(category c794)
		(category c795)
		(category c796)
		(category c797)
		(category c798)
		(category c799)
		(category c800)
		(category c801)
		(category c802)
		(category c803)
		(category c804)
		(category c805)
		(category c806)
		(category c807)
		(category c808)
		(category c809)
		(category c810)
		(category c811)
		(category c812)
		(category c813)
		(category c814)
		(category c815)
		(category c816)
		(category c817)
		(category c818)
		(category c819)
		(category c820)
		(category c821)
		(category c822)
		(category c823)
		(category c824)
		(category c825)
		(category c826)
		(category c827)
		(category c828)
		(category c829)
		(category c830)
		(category c831)
		(category c832)
		(category c833)
		(category c834)
		(category c835)
		(category c836)
		(category c837)
		(category c838)
		(category c839)
		(category c840)
		(category c841)
		(category c842)
		(category c843)
		(category c844)
		(category c845)
		(category c846)
		(category c847)
		(category c848)
		(category c849)
		(category c850)
		(category c851)
		(category c852)
		(category c853)
		(category c854)
		(category c855)
		(category c856)
		(category c857)
		(category c858)
		(category c859)
		(category c860)
		(category c861)
		(category c862)
		(category c863)
		(category c864)
		(category c865)
		(category c866)
		(category c867)
		(category c868)
		(category c869)
		(category c870)
		(category c871)
		(category c872)
		(category c873)
		(category c874)
		(category c875)
		(category c876)
		(category c877)
		(category c878)
		(category c879)
		(category c880)
		(category c881)
		(category c882)
		(category c883)
		(category c884)
		(category c885)
		(category c886)
		(category c887)
		(category c888)
		(category c889)
		(category c890)
		(category c891)
		(category c892)
		(category c893)
		(category c894)
		(category c895)
		(category c896)
		(category c897)
		(category c898)
		(category c899)
		(category c900)
		(category c901)
		(category c902)
		(category c903)
		(category c904)
		(category c905)
		(category c906)
		(category c907)
		(category c908)
		(category c909)
		(category c910)
		(category c911)
		(category c912)
		(category c913)
		(category c914)
		(category c915)
		(category c916)
		(category c917)
		(category c918)
		(category c919)
		(category c920)
		(category c921)
		(category c922)
		(category c923)
		(category c924)
		(category c925)
		(category c926)
		(category c927)
		(category c928)
		(category c929)
		(category c930)
		(category c931)
		(category c932)
		(category c933)
		(category c934)
		(category c935)
		(category c936)
		(category c937)
		(category c938)
		(category c939)
		(category c940)
		(category c941)
		(category c942)
		(category c943)
		(category c944)
		(category c945)
		(category c946)
		(category c947)
		(category c948)
		(category c949)
		(category c950)
		(category c951)
		(category c952)
		(category c953)
		(category c954)
		(category c955)
		(category c956)
		(category c957)
		(category c958)
		(category c959)
		(category c960)
		(category c961)
		(category c962)
		(category c963)
		(category c964)
		(category c965)
		(category c966)
		(category c967)
		(category c968)
		(category c969)
		(category c970)
		(category c971)
		(category c972)
		(category c973)
		(category c974)
		(category c975)
		(category c976)
		(category c977)
		(category c978)
		(category c979)
		(category c980)
		(category c981)
		(category c982)
		(category c983)
		(category c984)
		(category c985)
		(category c986)
		(category c987)
		(category c988)
		(category c989)
		(category c990)
		(category c991)
		(category c992)
		(category c993)
		(category c994)
		(category c995)
		(category c996)
		(category c997)
		(category c998)
		(category c999)
		(category c1000)
		(category c1001)
		(category c1002)
		(category c1003)
		(category c1004)
		(category c1005)
		(category c1006)
		(category c1007)
		(category c1008)
		(category c1009)
		(category c1010)
		(category c1011)
		(category c1012)
		(category c1013)
		(category c1014)
		(category c1015)
		(category c1016)
		(category c1017)
		(category c1018)
		(category c1019)
		(category c1020)
		(category c1021)
		(category c1022)
		(category c1023)

		(categoryorder (c0 c1 c2 c3 c4 c5 c6 c7 c8 c9 c10 c11 c12 c13 c14 c15
			c16 c17 c18 c19 c20 c21 c22 c23 c24 c25 c26 c27 c28 c29
			c30 c31 c32 c33 c34 c35 c36 c37 c38 c39 c40 c41 c42 c43
			c44 c45 c46 c47 c48 c49 c50 c51 c52 c53 c54 c55 c56 c57
			c58 c59 c60 c61 c62 c63 c64 c65 c66 c67 c68 c69 c70 c71
			c72 c73 c74 c75 c76 c77 c78 c79 c80 c81 c82 c83 c84 c85
			c86 c87 c88 c89 c90 c91 c92 c93 c94 c95 c96 c97 c98 c99
			c100 c101 c102 c103 c104 c105 c106 c107 c108 c109 c110
			c111 c112 c113 c114 c115 c116 c117 c118 c119 c120 c121
			c122 c123 c124 c125 c126 c127 c128 c129 c130 c131 c132
			c133 c134 c135 c136 c137 c138 c139 c140 c141 c142 c143
			c144 c145 c146 c147 c148 c149 c150 c151 c152 c153 c154
			c155 c156 c157 c158 c159 c160 c161 c162 c163 c164 c165
			c166 c167 c168 c169 c170 c171 c172 c173 c174 c175 c176
			c177 c178 c179 c180 c181 c182 c183 c184 c185 c186 c187
			c188 c189 c190 c191 c192 c193 c194 c195 c196 c197 c198
			c199 c200 c201 c202 c203 c204 c205 c206 c207 c208 c209
			c210 c211 c212 c213 c214 c215 c216 c217 c218 c219 c220
			c221 c222 c223 c224 c225 c226 c227 c228 c229 c230 c231
			c232 c233 c234 c235 c236 c237 c238 c239 c240 c241 c242
			c243 c244 c245 c246 c247 c248 c249 c250 c251 c252 c253
			c254 c255 c256 c257 c258 c259 c260 c261 c262 c263 c264
			c265 c266 c267 c268 c269 c270 c271 c272 c273 c274 c275
			c276 c277 c278 c279 c280 c281 c282 c283 c284 c285 c286
			c287 c288 c289 c290 c291 c292 c293 c294 c295 c296 c297
			c298 c299 c300 c301 c302 c303 c304 c305 c306 c307 c308
			c309 c310 c311 c312 c313 c314 c315 c316 c317 c318 c319
			c320 c321 c322 c323 c324 c325 c326 c327 c328 c329 c330
			c331 c332 c333 c334 c335 c336 c337 c338 c339 c340 c341
			c342 c343 c344 c345 c346 c347 c348 c349 c350 c351 c352
			c353 c354 c355 c356 c357 c358 c359 c360 c361 c362 c363
			c364 c365 c366 c367 c368 c369 c370 c371 c372 c373 c374
			c375 c376 c377 c378 c379 c380 c381 c382 c383 c384 c385
			c386 c387 c388 c389 c390 c391 c392 c393 c394 c395 c396
			c397 c398 c399 c400 c401 c402 c403 c404 c405 c406 c407
			c408 c409 c410 c411 c412 c413 c414 c415 c416 c417 c418
			c419 c420 c421 c422 c423 c424 c425 c426 c427 c428 c429
			c430 c431 c432 c433 c434 c435 c436 c437 c438 c439 c440
			c441 c442 c443 c444 c445 c446 c447 c448 c449 c450 c451
			c452 c453 c454 c455 c456 c457 c458 c459 c460 c461 c462
			c463 c464 c465 c466 c467 c468 c469 c470 c471 c472 c473
			c474 c475 c476 c477 c478 c479 c480 c481 c482 c483 c484
			c485 c486 c487 c488 c489 c490 c491 c492 c493 c494 c495
			c496 c497 c498 c499 c500 c501 c502 c503 c504 c505 c506
			c507 c508 c509 c510 c511 c512 c513 c514 c515 c516 c517
			c518 c519 c520 c521 c522 c523 c524 c525 c526 c527 c528
			c529 c530 c531 c532 c533 c534 c535 c536 c537 c538 c539
			c540 c541 c542 c543 c544 c545 c546 c547 c548 c549 c550
			c551 c552 c553 c554 c555 c556 c557 c558 c559 c560 c561
			c562 c563 c564 c565 c566 c567 c568 c569 c570 c571 c572
			c573 c574 c575 c576 c577 c578 c579 c580 c581 c582 c583
			c584 c585 c586 c587 c588 c589 c590 c591 c592 c593 c594
			c595 c596 c597 c598 c599 c600 c601 c602 c603 c604 c605
			c606 c607 c608 c609 c610 c611 c612 c613 c614 c615 c616
			c617 c618 c619 c620 c621 c622 c623 c624 c625 c626 c627
			c628 c629 c630 c631 c632 c633 c634 c635 c636 c637 c638
			c639 c640 c641 c642 c643 c644 c645 c646 c647 c648 c649
			c650 c651 c652 c653 c654 c655 c656 c657 c658 c659 c660
			c661 c662 c663 c664 c665 c666 c667 c668 c669 c670 c671
			c672 c673 c674 c675 c676 c677 c678 c679 c680 c681 c682
			c683 c684 c685 c686 c687 c688 c689 c690 c691 c692 c693
			c694 c695 c696 c697 c698 c699 c700 c701 c702 c703 c704
			c705 c706 c707 c708 c709 c710 c711 c712 c713 c714 c715
			c716 c717 c718 c719 c720 c721 c722 c723 c724 c725 c726
			c727 c728 c729 c730 c731 c732 c733 c734 c735 c736 c737
			c738 c739 c740 c741 c742 c743 c744 c745 c746 c747 c748
			c749 c750 c751 c752 c753 c754 c755 c756 c757 c758 c759
			c760 c761 c762 c763 c764 c765 c766 c767 c768 c769 c770
			c771 c772 c773 c774 c775 c776 c777 c778 c779 c780 c781
			c782 c783 c784 c785 c786 c787 c788 c789 c790 c791 c792
			c793 c794 c795 c796 c797 c798 c799 c800 c801 c802 c803
			c804 c805 c806 c807 c808 c809 c810 c811 c812 c813 c814
			c815 c816 c817 c818 c819 c820 c821 c822 c823 c824 c825
			c826 c827 c828 c829 c830 c831 c832 c833 c834 c835 c836
			c837 c838 c839 c840 c841 c842 c843 c844 c845 c846 c847
			c848 c849 c850 c851 c852 c853 c854 c855 c856 c857 c858
			c859 c860 c861 c862 c863 c864 c865 c866 c867 c868 c869
			c870 c871 c872 c873 c874 c875 c876 c877 c878 c879 c880
			c881 c882 c883 c884 c885 c886 c887 c888 c889 c890 c891
			c892 c893 c894 c895 c896 c897 c898 c899 c900 c901 c902
			c903 c904 c905 c906 c907 c908 c909 c910 c911 c912 c913
			c914 c915 c916 c917 c918 c919 c920 c921 c922 c923 c924
			c925 c926 c927 c928 c929 c930 c931 c932 c933 c934 c935
			c936 c937 c938 c939 c940 c941 c942 c943 c944 c945 c946
			c947 c948 c949 c950 c951 c952 c953 c954 c955 c956 c957
			c958 c959 c960 c961 c962 c963 c964 c965 c966 c967 c968
			c969 c970 c971 c972 c973 c974 c975 c976 c977 c978 c979
			c980 c981 c982 c983 c984 c985 c986 c987 c988 c989 c990
			c991 c992 c993 c994 c995 c996 c997 c998 c999 c1000 c1001
			c1002 c1003 c1004 c1005 c1006 c1007 c1008 c1009 c1010
			c1011 c1012 c1013 c1014 c1015 c1016 c1017 c1018 c1019
			c1020 c1021 c1022 c1023))

		(sensitivitycategory s0 (range c0 c1023))
		(sensitivitycategory s1 (range c0 c1023))
		(sensitivitycategory s2 (range c0 c1023))
		(sensitivitycategory s3 (range c0 c1023))
		(sensitivitycategory s4 (range c0 c1023))
		(sensitivitycategory s5 (range c0 c1023))
		(sensitivitycategory s6 (range c0 c1023))
		(sensitivitycategory s7 (range c0 c1023))
		(sensitivitycategory s8 (range c0 c1023))
		(sensitivitycategory s9 (range c0 c1023))
		(sensitivitycategory s10 (range c0 c1023))
		(sensitivitycategory s11 (range c0 c1023))
		(sensitivitycategory s12 (range c0 c1023))
		(sensitivitycategory s13 (range c0 c1023))
		(sensitivitycategory s14 (range c0 c1023))
		(sensitivitycategory s15 (range c0 c1023))

		(level systemlow (s0))
		(level systemhigh (s15 (range c0 c1023)))))
; NOTE: binder not covered

(tunableif enable_mls
	(true
		(mlsconstrain (fifo_file (create relabelto))
			(eq l2 h2))

		(mlsconstrain (file (create relabelto))
			(eq l2 h2))

		(mlsconstrain (lnk_file (create relabelto))
			(eq l2 h2))

		(mlsconstrain (blk_file (relabelto))
			(dom h1 h2))

		(mlsconstrain (chr_file (relabelto))
			(dom h1 h2))

		(mlsconstrain (dir (relabelto))
			(dom h1 h2))

		(mlsconstrain (fifo_file (relabelto))
			(dom h1 h2))

		(mlsconstrain (file (relabelto))
			(dom h1 h2))

		(mlsconstrain (lnk_file (relabelto))
			(dom h1 h2))

		(mlsconstrain (sock_file (relabelto))
			(dom h1 h2))

		(mlsconstrain (blk_file (read getattr execute))
			(or (or (or (dom l1 l2)
			(and (eq t1 mls_file_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_file_read_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (chr_file (read getattr execute))
			(or (or (or (dom l1 l2)
			(and (eq t1 mls_file_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_file_read_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (dir (read getattr execute))
			(or (or (or (dom l1 l2)
			(and (eq t1 mls_file_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_file_read_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (fifo_file (read getattr execute))
			(or (or (or (dom l1 l2)
			(and (eq t1 mls_file_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_file_read_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (file (read getattr execute))
			(or (or (or (dom l1 l2)
			(and (eq t1 mls_file_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_file_read_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (lnk_file (read getattr execute))
			(or (or (or (dom l1 l2)
			(and (eq t1 mls_file_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_file_read_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (sock_file (read getattr execute))
			(or (or (or (dom l1 l2)
			(and (eq t1 mls_file_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_file_read_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (dir (search))
			(or (or (or (dom l1 l2)
			(and (eq t1 mls_file_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_file_read_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (blk_file (write create setattr relabelfrom append unlink link rename mounton))
			(or (or (or (or (eq l1 l2)
			(and (and (eq t1 mls_file_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(and (and (eq t2 mls_file_write_in_range_subj_type) (dom l1 l2)) (domby h1 h2)))
			(eq t1 mls_file_write_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (chr_file (write create setattr relabelfrom append unlink link rename mounton))
			(or (or (or (or (eq l1 l2)
			(and (and (eq t1 mls_file_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(and (and (eq t2 mls_file_write_in_range_subj_type) (dom l1 l2)) (domby h1 h2)))
			(eq t1 mls_file_write_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (dir (write create setattr relabelfrom append unlink link rename mounton))
			(or (or (or (or (eq l1 l2)
			(and (and (eq t1 mls_file_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(and (and (eq t2 mls_file_write_in_range_subj_type) (dom l1 l2)) (domby h1 h2)))
			(eq t1 mls_file_write_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (fifo_file (write create setattr relabelfrom append unlink link rename mounton))
			(or (or (or (or (eq l1 l2)
			(and (and (eq t1 mls_file_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(and (and (eq t2 mls_file_write_in_range_subj_type) (dom l1 l2)) (domby h1 h2)))
			(eq t1 mls_file_write_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (file (write create setattr relabelfrom append unlink link rename mounton))
			(or (or (or (or (eq l1 l2)
			(and (and (eq t1 mls_file_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(and (and (eq t2 mls_file_write_in_range_subj_type) (dom l1 l2)) (domby h1 h2)))
			(eq t1 mls_file_write_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (lnk_file (write create setattr relabelfrom append unlink link rename mounton))
			(or (or (or (or (eq l1 l2)
			(and (and (eq t1 mls_file_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(and (and (eq t2 mls_file_write_in_range_subj_type) (dom l1 l2)) (domby h1 h2)))
			(eq t1 mls_file_write_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (sock_file (write create setattr relabelfrom append unlink link rename mounton))
			(or (or (or (or (eq l1 l2)
			(and (and (eq t1 mls_file_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(and (and (eq t2 mls_file_write_in_range_subj_type) (dom l1 l2)) (domby h1 h2)))
			(eq t1 mls_file_write_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (dir (add_name remove_name reparent rmdir))
			(or (or (or (or (eq l1 l2)
			(and (and (eq t1 mls_file_write_in_range_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_file_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_file_write_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsvalidatetrans dir (and (or (or (or (eq l1 l2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq h1 h2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp h1 h2)))))

		(mlsvalidatetrans file (and (or (or (or (eq l1 l2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq h1 h2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp h1 h2)))))

		(mlsvalidatetrans lnk_file (and (or (or (or (eq l1 l2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq h1 h2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp h1 h2)))))

		(mlsvalidatetrans chr_file (and (or (or (or (eq l1 l2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq h1 h2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp h1 h2)))))

		(mlsvalidatetrans blk_file (and (or (or (or (eq l1 l2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq h1 h2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp h1 h2)))))

		(mlsvalidatetrans sock_file (and (or (or (or (eq l1 l2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq h1 h2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp h1 h2)))))

		(mlsvalidatetrans fifo_file (and (or (or (or (eq l1 l2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq h1 h2)
			(and (eq t3 mls_file_upgrade_subj_type) (domby h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (dom h1 h2)))
			(and (eq t3 mls_file_downgrade_subj_type) (incomp h1 h2)))))

		(mlsconstrain (blk_file (create)) (and (or (or (or (eq l1 l2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq l1 h2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 h2)))))

		(mlsconstrain (chr_file (create)) (and (or (or (or (eq l1 l2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq l1 h2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 h2)))))

		(mlsconstrain (dir (create)) (and (or (or (or (eq l1 l2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq l1 h2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 h2)))))

		(mlsconstrain (fifo_file (create)) (and (or (or (or (eq l1 l2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq l1 h2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 h2)))))

		(mlsconstrain (file (create)) (and (or (or (or (eq l1 l2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq l1 h2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 h2)))))

		(mlsconstrain (lnk_file (create)) (and (or (or (or (eq l1 l2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq l1 h2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 h2)))))

		(mlsconstrain (sock_file (create)) (and (or (or (or (eq l1 l2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 l2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 l2)))
			(or (or (or (eq l1 h2)
			(and (eq t1 mls_file_upgrade_subj_type) (domby l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (dom l1 h2)))
			(and (eq t1 mls_file_downgrade_subj_type) (incomp l1 h2)))))

		(mlsconstrain (filesystem (relabelto))
			(dom h1 h2))

		(mlsconstrain (filesystem (getattr quotaget))
			(or (or (dom l1 l2)
			(and (eq t1 mls_file_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_file_read_subj_type)))

		(mlsconstrain (filesystem (mount remount unmount relabelfrom quotamod))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_file_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_file_write_subj_type)))

		(mlsconstrain (key_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_audit_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_dnrt_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_nflog_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_route_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_selinux_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (tun_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_kobject_uevent_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (appletalk_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_tcpdiag_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_xfrm_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_iscsi_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_fib_lookup_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_connector_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_netfilter_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_generic_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_scsitransport_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_rdma_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (netlink_crypto_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (packet_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (rawip_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (tcp_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (dccp_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (udp_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (unix_dgram_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (unix_stream_socket (relabelto))
			(dom h1 h2))

		(mlsconstrain (key_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_audit_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_dnrt_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_nflog_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_route_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_selinux_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (tun_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_kobject_uevent_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (appletalk_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_tcpdiag_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_xfrm_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_iscsi_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_fib_lookup_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_connector_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_netfilter_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_generic_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_scsitransport_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_rdma_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (netlink_crypto_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (packet_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (rawip_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (tcp_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (dccp_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (udp_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (unix_dgram_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (unix_stream_socket (accept connect))
			(or (eq l1 l2)
			(and (or (and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)) (eq t1 mls_net_read_subj_type))
			(or (or (and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))))

		(mlsconstrain (key_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_audit_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_dnrt_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_nflog_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_route_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_selinux_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (tun_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_kobject_uevent_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (appletalk_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_tcpdiag_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_xfrm_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_iscsi_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_fib_lookup_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_connector_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_netfilter_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_generic_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_scsitransport_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_rdma_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_crypto_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (packet_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (rawip_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (tcp_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (dccp_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (udp_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (unix_dgram_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (unix_stream_socket (read getattr listen accept getopt))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_audit_socket (nlmsg_read))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_route_socket (nlmsg_read))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_tcpdiag_socket (nlmsg_read))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (netlink_xfrm_socket (nlmsg_read))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (key_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_audit_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_dnrt_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_nflog_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_route_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_selinux_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (tun_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_kobject_uevent_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (appletalk_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_tcpdiag_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_xfrm_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_iscsi_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_fib_lookup_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_connector_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_netfilter_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_generic_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_scsitransport_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_rdma_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (netlink_crypto_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (packet_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (rawip_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (tcp_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (dccp_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (udp_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (unix_dgram_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (unix_stream_socket (write setattr relabelfrom connect setopt shutdown))
			(or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)))

		(mlsconstrain (rawip_socket (recvfrom))
			(or (or (eq l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (tcp_socket (recvfrom))
			(or (or (eq l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (dccp_socket (recvfrom))
			(or (or (eq l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (udp_socket (recvfrom))
			(or (or (eq l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (unix_stream_socket (connectto))
			(or (or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (unix_dgram_socket (sendto))
			(or (or (or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(and (and (eq t1 mls_net_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_net_write_subj_type)) (eq t2 mls_trusted_obj_type)))

		(mlsconstrain (ipc (getattr read unix_read))
			(or (or (dom l1 l2)
			(and (eq t1 mls_ipc_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_ipc_read_subj_type)))

		(mlsconstrain (msgq (getattr read unix_read))
			(or (or (dom l1 l2)
			(and (eq t1 mls_ipc_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_ipc_read_subj_type)))

		(mlsconstrain (sem (getattr read unix_read))
			(or (or (dom l1 l2)
			(and (eq t1 mls_ipc_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_ipc_read_subj_type)))

		(mlsconstrain (shm (getattr read unix_read))
			(or (or (dom l1 l2)
			(and (eq t1 mls_ipc_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_ipc_read_subj_type)))

		(mlsconstrain (msg (receive))
			(or (or (dom l1 l2)
			(and (eq t1 mls_ipc_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_ipc_read_subj_type)))

		(mlsconstrain (ipc (create destroy setattr write unix_write))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_ipc_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_ipc_write_subj_type)))

		(mlsconstrain (msgq (create destroy setattr write unix_write))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_ipc_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_ipc_write_subj_type)))

		(mlsconstrain (sem (create destroy setattr write unix_write))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_ipc_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_ipc_write_subj_type)))

		(mlsconstrain (shm (create destroy setattr write unix_write))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_ipc_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_ipc_write_subj_type)))

		(mlsconstrain (msgq (enqueue))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_ipc_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_ipc_write_subj_type)))

		(mlsconstrain (shm (lock))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_ipc_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_ipc_write_subj_type)))

		(mlsconstrain (msg (send))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_ipc_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_ipc_write_subj_type)))

		(mlsconstrain (fd (use))
			(or (or (eq l1 l2) (eq t1 mls_fd_use_subj_type))
			(eq t2 mls_fd_share_subj_type)))

		(mlsconstrain (netif (ingress))
			(or (or (and (dom l1 l2) (domby l1 h2))
			(eq t1 mls_net_inbound_subj_type)) (eq t1 unlabeled.isid)))

		(mlsconstrain (netif (egress))
			(or (and (dom l1 l2) (domby l1 h2))
			(eq t1 mls_net_outbound_subj_type)))

		(mlsconstrain (node (recvfrom))
			(or (or (and (dom l1 l2) (domby l1 h2))
			(eq t1 mls_net_inbound_subj_type)) (eq t1 unlabeled.isid)))

		(mlsconstrain (node (sendto))
			(or (and (dom l1 l2) (domby l1 h2))
			(eq t1 mls_net_outbound_subj_type)))

		(mlsconstrain (packet (forward_in))
			(or (or (and (dom l1 l2) (domby l1 h2))
			(eq t1 mls_net_inbound_subj_type)) (eq t1 unlabeled.isid)))

		(mlsconstrain (packet (forward_out))
			(or (or (and (dom l1 l2) (domby l1 h2))
			(eq t1 mls_net_outbound_subj_type)) (eq t1 unlabeled.isid)))

		(mlsconstrain (packet (recv))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (peer (recv))
			(or (or (dom l1 l2)
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)))

		(mlsconstrain (process (transition))
			(and (dom h1 h2)
			(or (or (eq l1 l2) (eq t1 mls_proc_set_sl_subj_type))
			(and (eq t1 mls_priv_range_trans_subj_type) (eq t2 mls_range_trans_subj_type)))))

		(mlsconstrain (process (dyntransition))
			(and (dom h1 h2)
			(or (eq l1 l2) (eq t1 mls_proc_set_sl_subj_type))))

		(mlsconstrain (process (getsched getsession getpgid getcap getattr ptrace share))
			(or (or (dom l1 l2)
			(and (eq t1 mls_proc_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_proc_read_subj_type)))

		(mlsconstrain (process (sigkill sigstop signal setsched setpgid setcap setexec setfscreate setcurrent ptrace share))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_proc_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_proc_write_subj_type)))

		(mlsconstrain (key (create link read search setattr view write))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_proc_write_to_clr_subj_type) (dom h1 l2)) (domby l1 l2)))
			(eq t1 mls_proc_write_subj_type)))

		(mlsconstrain (association (recvfrom))
			(or (or (or (and (dom l1 l2) (domby l1 h2))
			(and (eq t1 mls_net_read_to_clr_subj_type) (dom h1 l2)))
			(eq t1 mls_net_read_subj_type)) (eq t2 unlabeled.isid)))

		(mlsconstrain (association (sendto))
			(or (or (eq l1 l2)
			(and (and (eq t1 mls_net_write_ranged_subj_type) (dom l1 l2)) (domby l1 h2)))
			(eq t2 unlabeled.isid)))

		(mlsconstrain (association (polmatch))
			(and (dom l1 l2) (domby h1 h2)))))
(macro mcs_constrained_subj_type ((type ARG1))
	(typeattributeset mcs_constrained_subj_type ARG1))
(typeattribute mcs_constrained_subj_type)

(tunableif enable_mcs
	(true
		(mls true)

		(sensitivity s0)

		(sensitivityorder (s0))

		(category c0)
		(category c1)
		(category c2)
		(category c3)
		(category c4)
		(category c5)
		(category c6)
		(category c7)
		(category c8)
		(category c9)
		(category c10)
		(category c11)
		(category c12)
		(category c13)
		(category c14)
		(category c15)
		(category c16)
		(category c17)
		(category c18)
		(category c19)
		(category c20)
		(category c21)
		(category c22)
		(category c23)
		(category c24)
		(category c25)
		(category c26)
		(category c27)
		(category c28)
		(category c29)
		(category c30)
		(category c31)
		(category c32)
		(category c33)
		(category c34)
		(category c35)
		(category c36)
		(category c37)
		(category c38)
		(category c39)
		(category c40)
		(category c41)
		(category c42)
		(category c43)
		(category c44)
		(category c45)
		(category c46)
		(category c47)
		(category c48)
		(category c49)
		(category c50)
		(category c51)
		(category c52)
		(category c53)
		(category c54)
		(category c55)
		(category c56)
		(category c57)
		(category c58)
		(category c59)
		(category c60)
		(category c61)
		(category c62)
		(category c63)
		(category c64)
		(category c65)
		(category c66)
		(category c67)
		(category c68)
		(category c69)
		(category c70)
		(category c71)
		(category c72)
		(category c73)
		(category c74)
		(category c75)
		(category c76)
		(category c77)
		(category c78)
		(category c79)
		(category c80)
		(category c81)
		(category c82)
		(category c83)
		(category c84)
		(category c85)
		(category c86)
		(category c87)
		(category c88)
		(category c89)
		(category c90)
		(category c91)
		(category c92)
		(category c93)
		(category c94)
		(category c95)
		(category c96)
		(category c97)
		(category c98)
		(category c99)
		(category c100)
		(category c101)
		(category c102)
		(category c103)
		(category c104)
		(category c105)
		(category c106)
		(category c107)
		(category c108)
		(category c109)
		(category c110)
		(category c111)
		(category c112)
		(category c113)
		(category c114)
		(category c115)
		(category c116)
		(category c117)
		(category c118)
		(category c119)
		(category c120)
		(category c121)
		(category c122)
		(category c123)
		(category c124)
		(category c125)
		(category c126)
		(category c127)
		(category c128)
		(category c129)
		(category c130)
		(category c131)
		(category c132)
		(category c133)
		(category c134)
		(category c135)
		(category c136)
		(category c137)
		(category c138)
		(category c139)
		(category c140)
		(category c141)
		(category c142)
		(category c143)
		(category c144)
		(category c145)
		(category c146)
		(category c147)
		(category c148)
		(category c149)
		(category c150)
		(category c151)
		(category c152)
		(category c153)
		(category c154)
		(category c155)
		(category c156)
		(category c157)
		(category c158)
		(category c159)
		(category c160)
		(category c161)
		(category c162)
		(category c163)
		(category c164)
		(category c165)
		(category c166)
		(category c167)
		(category c168)
		(category c169)
		(category c170)
		(category c171)
		(category c172)
		(category c173)
		(category c174)
		(category c175)
		(category c176)
		(category c177)
		(category c178)
		(category c179)
		(category c180)
		(category c181)
		(category c182)
		(category c183)
		(category c184)
		(category c185)
		(category c186)
		(category c187)
		(category c188)
		(category c189)
		(category c190)
		(category c191)
		(category c192)
		(category c193)
		(category c194)
		(category c195)
		(category c196)
		(category c197)
		(category c198)
		(category c199)
		(category c200)
		(category c201)
		(category c202)
		(category c203)
		(category c204)
		(category c205)
		(category c206)
		(category c207)
		(category c208)
		(category c209)
		(category c210)
		(category c211)
		(category c212)
		(category c213)
		(category c214)
		(category c215)
		(category c216)
		(category c217)
		(category c218)
		(category c219)
		(category c220)
		(category c221)
		(category c222)
		(category c223)
		(category c224)
		(category c225)
		(category c226)
		(category c227)
		(category c228)
		(category c229)
		(category c230)
		(category c231)
		(category c232)
		(category c233)
		(category c234)
		(category c235)
		(category c236)
		(category c237)
		(category c238)
		(category c239)
		(category c240)
		(category c241)
		(category c242)
		(category c243)
		(category c244)
		(category c245)
		(category c246)
		(category c247)
		(category c248)
		(category c249)
		(category c250)
		(category c251)
		(category c252)
		(category c253)
		(category c254)
		(category c255)
		(category c256)
		(category c257)
		(category c258)
		(category c259)
		(category c260)
		(category c261)
		(category c262)
		(category c263)
		(category c264)
		(category c265)
		(category c266)
		(category c267)
		(category c268)
		(category c269)
		(category c270)
		(category c271)
		(category c272)
		(category c273)
		(category c274)
		(category c275)
		(category c276)
		(category c277)
		(category c278)
		(category c279)
		(category c280)
		(category c281)
		(category c282)
		(category c283)
		(category c284)
		(category c285)
		(category c286)
		(category c287)
		(category c288)
		(category c289)
		(category c290)
		(category c291)
		(category c292)
		(category c293)
		(category c294)
		(category c295)
		(category c296)
		(category c297)
		(category c298)
		(category c299)
		(category c300)
		(category c301)
		(category c302)
		(category c303)
		(category c304)
		(category c305)
		(category c306)
		(category c307)
		(category c308)
		(category c309)
		(category c310)
		(category c311)
		(category c312)
		(category c313)
		(category c314)
		(category c315)
		(category c316)
		(category c317)
		(category c318)
		(category c319)
		(category c320)
		(category c321)
		(category c322)
		(category c323)
		(category c324)
		(category c325)
		(category c326)
		(category c327)
		(category c328)
		(category c329)
		(category c330)
		(category c331)
		(category c332)
		(category c333)
		(category c334)
		(category c335)
		(category c336)
		(category c337)
		(category c338)
		(category c339)
		(category c340)
		(category c341)
		(category c342)
		(category c343)
		(category c344)
		(category c345)
		(category c346)
		(category c347)
		(category c348)
		(category c349)
		(category c350)
		(category c351)
		(category c352)
		(category c353)
		(category c354)
		(category c355)
		(category c356)
		(category c357)
		(category c358)
		(category c359)
		(category c360)
		(category c361)
		(category c362)
		(category c363)
		(category c364)
		(category c365)
		(category c366)
		(category c367)
		(category c368)
		(category c369)
		(category c370)
		(category c371)
		(category c372)
		(category c373)
		(category c374)
		(category c375)
		(category c376)
		(category c377)
		(category c378)
		(category c379)
		(category c380)
		(category c381)
		(category c382)
		(category c383)
		(category c384)
		(category c385)
		(category c386)
		(category c387)
		(category c388)
		(category c389)
		(category c390)
		(category c391)
		(category c392)
		(category c393)
		(category c394)
		(category c395)
		(category c396)
		(category c397)
		(category c398)
		(category c399)
		(category c400)
		(category c401)
		(category c402)
		(category c403)
		(category c404)
		(category c405)
		(category c406)
		(category c407)
		(category c408)
		(category c409)
		(category c410)
		(category c411)
		(category c412)
		(category c413)
		(category c414)
		(category c415)
		(category c416)
		(category c417)
		(category c418)
		(category c419)
		(category c420)
		(category c421)
		(category c422)
		(category c423)
		(category c424)
		(category c425)
		(category c426)
		(category c427)
		(category c428)
		(category c429)
		(category c430)
		(category c431)
		(category c432)
		(category c433)
		(category c434)
		(category c435)
		(category c436)
		(category c437)
		(category c438)
		(category c439)
		(category c440)
		(category c441)
		(category c442)
		(category c443)
		(category c444)
		(category c445)
		(category c446)
		(category c447)
		(category c448)
		(category c449)
		(category c450)
		(category c451)
		(category c452)
		(category c453)
		(category c454)
		(category c455)
		(category c456)
		(category c457)
		(category c458)
		(category c459)
		(category c460)
		(category c461)
		(category c462)
		(category c463)
		(category c464)
		(category c465)
		(category c466)
		(category c467)
		(category c468)
		(category c469)
		(category c470)
		(category c471)
		(category c472)
		(category c473)
		(category c474)
		(category c475)
		(category c476)
		(category c477)
		(category c478)
		(category c479)
		(category c480)
		(category c481)
		(category c482)
		(category c483)
		(category c484)
		(category c485)
		(category c486)
		(category c487)
		(category c488)
		(category c489)
		(category c490)
		(category c491)
		(category c492)
		(category c493)
		(category c494)
		(category c495)
		(category c496)
		(category c497)
		(category c498)
		(category c499)
		(category c500)
		(category c501)
		(category c502)
		(category c503)
		(category c504)
		(category c505)
		(category c506)
		(category c507)
		(category c508)
		(category c509)
		(category c510)
		(category c511)
		(category c512)
		(category c513)
		(category c514)
		(category c515)
		(category c516)
		(category c517)
		(category c518)
		(category c519)
		(category c520)
		(category c521)
		(category c522)
		(category c523)
		(category c524)
		(category c525)
		(category c526)
		(category c527)
		(category c528)
		(category c529)
		(category c530)
		(category c531)
		(category c532)
		(category c533)
		(category c534)
		(category c535)
		(category c536)
		(category c537)
		(category c538)
		(category c539)
		(category c540)
		(category c541)
		(category c542)
		(category c543)
		(category c544)
		(category c545)
		(category c546)
		(category c547)
		(category c548)
		(category c549)
		(category c550)
		(category c551)
		(category c552)
		(category c553)
		(category c554)
		(category c555)
		(category c556)
		(category c557)
		(category c558)
		(category c559)
		(category c560)
		(category c561)
		(category c562)
		(category c563)
		(category c564)
		(category c565)
		(category c566)
		(category c567)
		(category c568)
		(category c569)
		(category c570)
		(category c571)
		(category c572)
		(category c573)
		(category c574)
		(category c575)
		(category c576)
		(category c577)
		(category c578)
		(category c579)
		(category c580)
		(category c581)
		(category c582)
		(category c583)
		(category c584)
		(category c585)
		(category c586)
		(category c587)
		(category c588)
		(category c589)
		(category c590)
		(category c591)
		(category c592)
		(category c593)
		(category c594)
		(category c595)
		(category c596)
		(category c597)
		(category c598)
		(category c599)
		(category c600)
		(category c601)
		(category c602)
		(category c603)
		(category c604)
		(category c605)
		(category c606)
		(category c607)
		(category c608)
		(category c609)
		(category c610)
		(category c611)
		(category c612)
		(category c613)
		(category c614)
		(category c615)
		(category c616)
		(category c617)
		(category c618)
		(category c619)
		(category c620)
		(category c621)
		(category c622)
		(category c623)
		(category c624)
		(category c625)
		(category c626)
		(category c627)
		(category c628)
		(category c629)
		(category c630)
		(category c631)
		(category c632)
		(category c633)
		(category c634)
		(category c635)
		(category c636)
		(category c637)
		(category c638)
		(category c639)
		(category c640)
		(category c641)
		(category c642)
		(category c643)
		(category c644)
		(category c645)
		(category c646)
		(category c647)
		(category c648)
		(category c649)
		(category c650)
		(category c651)
		(category c652)
		(category c653)
		(category c654)
		(category c655)
		(category c656)
		(category c657)
		(category c658)
		(category c659)
		(category c660)
		(category c661)
		(category c662)
		(category c663)
		(category c664)
		(category c665)
		(category c666)
		(category c667)
		(category c668)
		(category c669)
		(category c670)
		(category c671)
		(category c672)
		(category c673)
		(category c674)
		(category c675)
		(category c676)
		(category c677)
		(category c678)
		(category c679)
		(category c680)
		(category c681)
		(category c682)
		(category c683)
		(category c684)
		(category c685)
		(category c686)
		(category c687)
		(category c688)
		(category c689)
		(category c690)
		(category c691)
		(category c692)
		(category c693)
		(category c694)
		(category c695)
		(category c696)
		(category c697)
		(category c698)
		(category c699)
		(category c700)
		(category c701)
		(category c702)
		(category c703)
		(category c704)
		(category c705)
		(category c706)
		(category c707)
		(category c708)
		(category c709)
		(category c710)
		(category c711)
		(category c712)
		(category c713)
		(category c714)
		(category c715)
		(category c716)
		(category c717)
		(category c718)
		(category c719)
		(category c720)
		(category c721)
		(category c722)
		(category c723)
		(category c724)
		(category c725)
		(category c726)
		(category c727)
		(category c728)
		(category c729)
		(category c730)
		(category c731)
		(category c732)
		(category c733)
		(category c734)
		(category c735)
		(category c736)
		(category c737)
		(category c738)
		(category c739)
		(category c740)
		(category c741)
		(category c742)
		(category c743)
		(category c744)
		(category c745)
		(category c746)
		(category c747)
		(category c748)
		(category c749)
		(category c750)
		(category c751)
		(category c752)
		(category c753)
		(category c754)
		(category c755)
		(category c756)
		(category c757)
		(category c758)
		(category c759)
		(category c760)
		(category c761)
		(category c762)
		(category c763)
		(category c764)
		(category c765)
		(category c766)
		(category c767)
		(category c768)
		(category c769)
		(category c770)
		(category c771)
		(category c772)
		(category c773)
		(category c774)
		(category c775)
		(category c776)
		(category c777)
		(category c778)
		(category c779)
		(category c780)
		(category c781)
		(category c782)
		(category c783)
		(category c784)
		(category c785)
		(category c786)
		(category c787)
		(category c788)
		(category c789)
		(category c790)
		(category c791)
		(category c792)
		(category c793)
		(category c794)
		(category c795)
		(category c796)
		(category c797)
		(category c798)
		(category c799)
		(category c800)
		(category c801)
		(category c802)
		(category c803)
		(category c804)
		(category c805)
		(category c806)
		(category c807)
		(category c808)
		(category c809)
		(category c810)
		(category c811)
		(category c812)
		(category c813)
		(category c814)
		(category c815)
		(category c816)
		(category c817)
		(category c818)
		(category c819)
		(category c820)
		(category c821)
		(category c822)
		(category c823)
		(category c824)
		(category c825)
		(category c826)
		(category c827)
		(category c828)
		(category c829)
		(category c830)
		(category c831)
		(category c832)
		(category c833)
		(category c834)
		(category c835)
		(category c836)
		(category c837)
		(category c838)
		(category c839)
		(category c840)
		(category c841)
		(category c842)
		(category c843)
		(category c844)
		(category c845)
		(category c846)
		(category c847)
		(category c848)
		(category c849)
		(category c850)
		(category c851)
		(category c852)
		(category c853)
		(category c854)
		(category c855)
		(category c856)
		(category c857)
		(category c858)
		(category c859)
		(category c860)
		(category c861)
		(category c862)
		(category c863)
		(category c864)
		(category c865)
		(category c866)
		(category c867)
		(category c868)
		(category c869)
		(category c870)
		(category c871)
		(category c872)
		(category c873)
		(category c874)
		(category c875)
		(category c876)
		(category c877)
		(category c878)
		(category c879)
		(category c880)
		(category c881)
		(category c882)
		(category c883)
		(category c884)
		(category c885)
		(category c886)
		(category c887)
		(category c888)
		(category c889)
		(category c890)
		(category c891)
		(category c892)
		(category c893)
		(category c894)
		(category c895)
		(category c896)
		(category c897)
		(category c898)
		(category c899)
		(category c900)
		(category c901)
		(category c902)
		(category c903)
		(category c904)
		(category c905)
		(category c906)
		(category c907)
		(category c908)
		(category c909)
		(category c910)
		(category c911)
		(category c912)
		(category c913)
		(category c914)
		(category c915)
		(category c916)
		(category c917)
		(category c918)
		(category c919)
		(category c920)
		(category c921)
		(category c922)
		(category c923)
		(category c924)
		(category c925)
		(category c926)
		(category c927)
		(category c928)
		(category c929)
		(category c930)
		(category c931)
		(category c932)
		(category c933)
		(category c934)
		(category c935)
		(category c936)
		(category c937)
		(category c938)
		(category c939)
		(category c940)
		(category c941)
		(category c942)
		(category c943)
		(category c944)
		(category c945)
		(category c946)
		(category c947)
		(category c948)
		(category c949)
		(category c950)
		(category c951)
		(category c952)
		(category c953)
		(category c954)
		(category c955)
		(category c956)
		(category c957)
		(category c958)
		(category c959)
		(category c960)
		(category c961)
		(category c962)
		(category c963)
		(category c964)
		(category c965)
		(category c966)
		(category c967)
		(category c968)
		(category c969)
		(category c970)
		(category c971)
		(category c972)
		(category c973)
		(category c974)
		(category c975)
		(category c976)
		(category c977)
		(category c978)
		(category c979)
		(category c980)
		(category c981)
		(category c982)
		(category c983)
		(category c984)
		(category c985)
		(category c986)
		(category c987)
		(category c988)
		(category c989)
		(category c990)
		(category c991)
		(category c992)
		(category c993)
		(category c994)
		(category c995)
		(category c996)
		(category c997)
		(category c998)
		(category c999)
		(category c1000)
		(category c1001)
		(category c1002)
		(category c1003)
		(category c1004)
		(category c1005)
		(category c1006)
		(category c1007)
		(category c1008)
		(category c1009)
		(category c1010)
		(category c1011)
		(category c1012)
		(category c1013)
		(category c1014)
		(category c1015)
		(category c1016)
		(category c1017)
		(category c1018)
		(category c1019)
		(category c1020)
		(category c1021)
		(category c1022)
		(category c1023)

	(categoryorder (c0 c1 c2 c3 c4 c5 c6 c7 c8 c9 c10 c11 c12 c13 c14 c15
		c16 c17 c18 c19 c20 c21 c22 c23 c24 c25 c26 c27 c28 c29
		c30 c31 c32 c33 c34 c35 c36 c37 c38 c39 c40 c41 c42 c43
		c44 c45 c46 c47 c48 c49 c50 c51 c52 c53 c54 c55 c56 c57
		c58 c59 c60 c61 c62 c63 c64 c65 c66 c67 c68 c69 c70 c71
		c72 c73 c74 c75 c76 c77 c78 c79 c80 c81 c82 c83 c84 c85
		c86 c87 c88 c89 c90 c91 c92 c93 c94 c95 c96 c97 c98 c99
		c100 c101 c102 c103 c104 c105 c106 c107 c108 c109 c110
		c111 c112 c113 c114 c115 c116 c117 c118 c119 c120 c121
		c122 c123 c124 c125 c126 c127 c128 c129 c130 c131 c132
		c133 c134 c135 c136 c137 c138 c139 c140 c141 c142 c143
		c144 c145 c146 c147 c148 c149 c150 c151 c152 c153 c154
		c155 c156 c157 c158 c159 c160 c161 c162 c163 c164 c165
		c166 c167 c168 c169 c170 c171 c172 c173 c174 c175 c176
		c177 c178 c179 c180 c181 c182 c183 c184 c185 c186 c187
		c188 c189 c190 c191 c192 c193 c194 c195 c196 c197 c198
		c199 c200 c201 c202 c203 c204 c205 c206 c207 c208 c209
		c210 c211 c212 c213 c214 c215 c216 c217 c218 c219 c220
		c221 c222 c223 c224 c225 c226 c227 c228 c229 c230 c231
		c232 c233 c234 c235 c236 c237 c238 c239 c240 c241 c242
		c243 c244 c245 c246 c247 c248 c249 c250 c251 c252 c253
		c254 c255 c256 c257 c258 c259 c260 c261 c262 c263 c264
		c265 c266 c267 c268 c269 c270 c271 c272 c273 c274 c275
		c276 c277 c278 c279 c280 c281 c282 c283 c284 c285 c286
		c287 c288 c289 c290 c291 c292 c293 c294 c295 c296 c297
		c298 c299 c300 c301 c302 c303 c304 c305 c306 c307 c308
		c309 c310 c311 c312 c313 c314 c315 c316 c317 c318 c319
		c320 c321 c322 c323 c324 c325 c326 c327 c328 c329 c330
		c331 c332 c333 c334 c335 c336 c337 c338 c339 c340 c341
		c342 c343 c344 c345 c346 c347 c348 c349 c350 c351 c352
		c353 c354 c355 c356 c357 c358 c359 c360 c361 c362 c363
		c364 c365 c366 c367 c368 c369 c370 c371 c372 c373 c374
		c375 c376 c377 c378 c379 c380 c381 c382 c383 c384 c385
		c386 c387 c388 c389 c390 c391 c392 c393 c394 c395 c396
		c397 c398 c399 c400 c401 c402 c403 c404 c405 c406 c407
		c408 c409 c410 c411 c412 c413 c414 c415 c416 c417 c418
		c419 c420 c421 c422 c423 c424 c425 c426 c427 c428 c429
		c430 c431 c432 c433 c434 c435 c436 c437 c438 c439 c440
		c441 c442 c443 c444 c445 c446 c447 c448 c449 c450 c451
		c452 c453 c454 c455 c456 c457 c458 c459 c460 c461 c462
		c463 c464 c465 c466 c467 c468 c469 c470 c471 c472 c473
		c474 c475 c476 c477 c478 c479 c480 c481 c482 c483 c484
		c485 c486 c487 c488 c489 c490 c491 c492 c493 c494 c495
		c496 c497 c498 c499 c500 c501 c502 c503 c504 c505 c506
		c507 c508 c509 c510 c511 c512 c513 c514 c515 c516 c517
		c518 c519 c520 c521 c522 c523 c524 c525 c526 c527 c528
		c529 c530 c531 c532 c533 c534 c535 c536 c537 c538 c539
		c540 c541 c542 c543 c544 c545 c546 c547 c548 c549 c550
		c551 c552 c553 c554 c555 c556 c557 c558 c559 c560 c561
		c562 c563 c564 c565 c566 c567 c568 c569 c570 c571 c572
		c573 c574 c575 c576 c577 c578 c579 c580 c581 c582 c583
		c584 c585 c586 c587 c588 c589 c590 c591 c592 c593 c594
		c595 c596 c597 c598 c599 c600 c601 c602 c603 c604 c605
		c606 c607 c608 c609 c610 c611 c612 c613 c614 c615 c616
		c617 c618 c619 c620 c621 c622 c623 c624 c625 c626 c627
		c628 c629 c630 c631 c632 c633 c634 c635 c636 c637 c638
		c639 c640 c641 c642 c643 c644 c645 c646 c647 c648 c649
		c650 c651 c652 c653 c654 c655 c656 c657 c658 c659 c660
		c661 c662 c663 c664 c665 c666 c667 c668 c669 c670 c671
		c672 c673 c674 c675 c676 c677 c678 c679 c680 c681 c682
		c683 c684 c685 c686 c687 c688 c689 c690 c691 c692 c693
		c694 c695 c696 c697 c698 c699 c700 c701 c702 c703 c704
		c705 c706 c707 c708 c709 c710 c711 c712 c713 c714 c715
		c716 c717 c718 c719 c720 c721 c722 c723 c724 c725 c726
		c727 c728 c729 c730 c731 c732 c733 c734 c735 c736 c737
		c738 c739 c740 c741 c742 c743 c744 c745 c746 c747 c748
		c749 c750 c751 c752 c753 c754 c755 c756 c757 c758 c759
		c760 c761 c762 c763 c764 c765 c766 c767 c768 c769 c770
		c771 c772 c773 c774 c775 c776 c777 c778 c779 c780 c781
		c782 c783 c784 c785 c786 c787 c788 c789 c790 c791 c792
		c793 c794 c795 c796 c797 c798 c799 c800 c801 c802 c803
		c804 c805 c806 c807 c808 c809 c810 c811 c812 c813 c814
		c815 c816 c817 c818 c819 c820 c821 c822 c823 c824 c825
		c826 c827 c828 c829 c830 c831 c832 c833 c834 c835 c836
		c837 c838 c839 c840 c841 c842 c843 c844 c845 c846 c847
		c848 c849 c850 c851 c852 c853 c854 c855 c856 c857 c858
		c859 c860 c861 c862 c863 c864 c865 c866 c867 c868 c869
		c870 c871 c872 c873 c874 c875 c876 c877 c878 c879 c880
		c881 c882 c883 c884 c885 c886 c887 c888 c889 c890 c891
		c892 c893 c894 c895 c896 c897 c898 c899 c900 c901 c902
		c903 c904 c905 c906 c907 c908 c909 c910 c911 c912 c913
		c914 c915 c916 c917 c918 c919 c920 c921 c922 c923 c924
		c925 c926 c927 c928 c929 c930 c931 c932 c933 c934 c935
		c936 c937 c938 c939 c940 c941 c942 c943 c944 c945 c946
		c947 c948 c949 c950 c951 c952 c953 c954 c955 c956 c957
		c958 c959 c960 c961 c962 c963 c964 c965 c966 c967 c968
		c969 c970 c971 c972 c973 c974 c975 c976 c977 c978 c979
		c980 c981 c982 c983 c984 c985 c986 c987 c988 c989 c990
		c991 c992 c993 c994 c995 c996 c997 c998 c999 c1000 c1001
		c1002 c1003 c1004 c1005 c1006 c1007 c1008 c1009 c1010
		c1011 c1012 c1013 c1014 c1015 c1016 c1017 c1018 c1019
		c1020 c1021 c1022 c1023))

	(sensitivitycategory s0 (range c0 c1023))

	(level systemlow (s0))
	(level systemhigh (s0 (range c0 c1023)))))
(tunableif enable_mcs
	(true
		(defaultrange file target low)
		(defaultrange dir target low)
		(defaultrange lnk_file target low)
		(defaultrange chr_file target low)
		(defaultrange blk_file target low)
		(defaultrange sock_file target low)
		(defaultrange fifo_file target low)

		(mlsconstrain (file (read ioctl lock execute execute_no_trans write setattr append unlink rename relabelfrom))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (file (create relabelto))
			(or (neq t1 mcs_constrained_subj_type)
			(and (dom h1 h2) (eq l2 h2))))

		(mlsconstrain (dir (search read ioctl lock write setattr append unlink rename add_name remove_name relabelfrom))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (dir (create relabelto))
			(or (neq t1 mcs_constrained_subj_type)
			(and (dom h1 h2) (eq l2 h2))))

		(mlsconstrain (fifo_file (open relabelfrom))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (fifo_file (create relabelto))
			(or (neq t1 mcs_constrained_subj_type)
			(and (dom h1 h2) (eq l2 h2))))

		(mlsconstrain (lnk_file (getattr read ioctl write setattr relabelfrom))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (lnk_file (create relabelto))
			(or (neq t1 mcs_constrained_subj_type)
			(and (dom h1 h2) (eq l2 h2))))

		(mlsconstrain (sock_file (getattr read ioctl write setattr relabelfrom))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (sock_file (create relabelto))
			(or (neq t1 mcs_constrained_subj_type)
			(and (dom h1 h2) (eq l2 h2))))

		(mlsconstrain (blk_file (getattr read ioctl write setattr relabelfrom))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (blk_file (create relabelto))
			(or (neq t1 mcs_constrained_subj_type)
			(and (dom h1 h2) (eq l2 h2))))

		(mlsconstrain (chr_file (getattr read ioctl write setattr relabelfrom))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (chr_file (create relabelto))
			(or (neq t1 mcs_constrained_subj_type)
			(and (dom h1 h2) (eq l2 h2))))

		(mlsconstrain (key (create link read search setattr view write))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (ipc (create destroy setattr write unix_write))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (sem (create destroy setattr write unix_write))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (msgq (create destroy setattr write unix_write))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (shm (create destroy setattr write unix_write))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (process (transition dyntransition ptrace sigkill sigstop signal))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (rawip_socket (node_bind))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (dccp_socket (node_bind))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (tcp_socket (node_bind))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (udp_socket (node_bind))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (node (recvfrom sendto))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (netif (egress ingress))
			(or (dom h1 h2) (neq t1 mcs_constrained_subj_type)))

		(mlsconstrain (packet (recv))
			(or (dom h1 h2)
			(and (neq t1 mcs_constrained_subj_type) (neq t1 mcs_constrained_subj_type))))

		(mlsconstrain (peer (recv))
			(or (dom h1 h2)
			(and (neq t1 mcs_constrained_subj_type) (neq t1 mcs_constrained_subj_type))))))
(macro base_manual_subj_type_transition_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 mmap_file_perms)
	(allow ARG1 ARG3 (process (transition)))
	(dontaudit ARG1 ARG3 (process (noatsecure siginh rlimitinh))))

(macro manual_subj_type_transition_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 self (process (setexec)))
	(call base_manual_subj_type_transition_pattern (ARG1 ARG2 ARG3))
	(allow ARG3 ARG1 (fd (use)))
	(allow ARG3 ARG1 rw_inherited_fifo_file_perms)
	(allow ARG3 ARG1 (process (sigchld))))

(macro base_auto_subj_type_transition_pattern ((type ARG1)(type ARG2)(type ARG3))
	(call base_manual_subj_type_transition_pattern (ARG1 ARG2 ARG3))
	(typetransition ARG1 ARG2 process "*" ARG3))

(macro auto_subj_type_transition_pattern ((type ARG1)(type ARG2)(type ARG3))
	(call base_auto_subj_type_transition_pattern (ARG1 ARG2 ARG3))
	(allow ARG3 ARG1 (fd (use)))
	(allow ARG3 ARG1 rw_inherited_fifo_file_perms)
	(allow ARG3 ARG1 (process (sigchld))))

(macro dynamic_subj_type_transition_pattern ((type ARG1)(type ARG2))
	(allow ARG1 self (process (setcurrent)))
	(allow ARG1 ARG2 (process (dyntransition)))
	(allow ARG2 ARG1 (process (sigchld))))

(macro obj_type_transition_add_pattern ((type ARG1)(type ARG2)(type ARG3)(class ARG4)(name ARG5))
	(allow ARG1 ARG2 add_entry_dir_perms)
	(typetransition ARG1 ARG2 ARG4 ARG5 ARG3))

(macro obj_type_transition_pattern ((type ARG1)(type ARG2)(type ARG3)(class ARG4)(name ARG5))
	(allow ARG1 ARG2 rw_dir_perms)
	(typetransition ARG1 ARG2 ARG4 ARG5 ARG3))

(macro ps_subj_pattern ((type ARG1)(type ARG2))
	(allow ARG1 ARG2 read_file_perms)
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG2 read_lnk_file_perms)
	(allow ARG1 ARG2 (process (getattr))))

(macro can_exec ((type ARG1)(type ARG2))
	(allow ARG1 ARG2 exec_file_perms))
(classpermission all_security_perms_except_load_policy_and_setenforce)
(classpermissionset all_security_perms_except_load_policy_and_setenforce (security (compute_av compute_create compute_member
	check_context compute_relabel compute_user setbool setsecparam setcheckreqprot read_policy)))

(classpermission
	all_process_perms_except_transition_dyntransition_setcurrent_execmem_execstack_and_execheap)
(classpermissionset
	all_process_perms_except_transition_dyntransition_setcurrent_execmem_execstack_and_execheap
	(process (fork sigchld sigkill sigstop signull signal getsched getsession getpgid setpgid getcap setcap share
		getattr setexec setfscreate noatsecure siginh setrlimit rlimitinh setkeycreate setsockcreate)))

(classpermission signal_perms)
(classpermissionset signal_perms (process (sigchld sigkill sigstop signull signal)))

(classpermission all_capability_perms_except_sys_module_sys_ptrace_and_sys_nice)
(classpermissionset all_capability_perms_except_sys_module_sys_ptrace_and_sys_nice
	(capability (chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable
		net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_rawio sys_chroot sys_pacct sys_admin
		sys_boot sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap)))

(classpermission mount_fs_perms)
(classpermissionset mount_fs_perms (filesystem (mount remount unmount getattr)))

(classpermission all_file_perms_except_getattr)
(classpermissionset all_file_perms_except_getattr (file (ioctl read write create setattr lock relabelfrom relabelto append
	unlink link rename execute quotaon mounton audit_access open execmod execute_no_trans entrypoint)))

(classpermission all_file_perms_except_mounton_execmod_and_entrypoint)
(classpermissionset all_file_perms_except_mounton_execmod_and_entrypoint (file (ioctl read write create getattr setattr lock
	relabelfrom relabelto append unlink link rename execute quotaon audit_access open execute_no_trans)))

(classpermission read_file_perms)
(classpermissionset read_file_perms (file (getattr open read lock ioctl)))

(classpermission read_inherited_file_perms)
(classpermissionset read_inherited_file_perms (file (getattr read lock ioctl)))

(classpermission mmap_file_perms)
(classpermissionset mmap_file_perms (file (getattr open read execute ioctl)))

(classpermission exec_file_perms)
(classpermissionset exec_file_perms (file (getattr open read execute ioctl execute_no_trans)))

(classpermission append_file_perms)
(classpermissionset append_file_perms (file (getattr open append lock ioctl)))

(classpermission append_inherited_file_perms)
(classpermissionset append_inherited_file_perms (file (getattr append lock ioctl)))

(classpermission write_file_perms)
(classpermissionset write_file_perms (file (getattr open write append lock ioctl)))

(classpermission write_inherited_file_perms)
(classpermissionset write_inherited_file_perms (file (getattr write append lock ioctl)))

(classpermission rw_file_perms)
(classpermissionset rw_file_perms (file (getattr open read write append ioctl lock)))

(classpermission rw_inherited_file_perms)
(classpermissionset rw_inherited_file_perms (file (getattr read write append ioctl lock)))

(classpermission create_file_perms)
(classpermissionset create_file_perms (file (getattr create open)))

(classpermission rename_file_perms)
(classpermissionset rename_file_perms (file (getattr rename)))

(classpermission delete_file_perms)
(classpermissionset delete_file_perms (file (getattr unlink)))

(classpermission manage_file_perms)
(classpermissionset manage_file_perms (file (create open getattr setattr read write append rename link unlink ioctl lock)))

(classpermission relabelfrom_file_perms)
(classpermissionset relabelfrom_file_perms (file (getattr relabelfrom)))

(classpermission relabelto_file_perms)
(classpermissionset relabelto_file_perms (file (getattr relabelto)))

(classpermission relabel_file_perms)
(classpermissionset relabel_file_perms (file (getattr relabelfrom relabelto)))

(classpermission search_dir_perms)
(classpermissionset search_dir_perms (dir (getattr search open)))

(classpermission list_dir_perms)
(classpermissionset list_dir_perms (dir (getattr search open read lock ioctl)))

(classpermission add_entry_dir_perms)
(classpermissionset add_entry_dir_perms (dir (getattr search open read lock ioctl write add_name)))

(classpermission all_dir_perms_except_mounton_and_execmod)
(classpermissionset all_dir_perms_except_mounton_and_execmod (dir (ioctl read write create getattr setattr lock relabelfrom
	relabelto append unlink link rename execute quotaon audit_access open add_name remove_name reparent search rmdir)))

(classpermission del_entry_dir_perms)
(classpermissionset del_entry_dir_perms (dir (getattr search open read lock ioctl write remove_name)))

(classpermission rw_dir_perms)
(classpermissionset rw_dir_perms (dir (open read getattr lock search ioctl add_name remove_name write)))

(classpermission create_dir_perms)
(classpermissionset create_dir_perms (dir (getattr create open)))

(classpermission rename_dir_perms)
(classpermissionset rename_dir_perms (dir (getattr rename)))

(classpermission delete_dir_perms)
(classpermissionset delete_dir_perms (dir (getattr rmdir)))

(classpermission manage_dir_perms)
(classpermissionset manage_dir_perms (dir (create open getattr setattr read write link unlink rename search
	add_name remove_name reparent rmdir lock ioctl)))

(classpermission relabelfrom_dir_perms)
(classpermissionset relabelfrom_dir_perms (dir (getattr relabelfrom)))

(classpermission relabelto_dir_perms)
(classpermissionset relabelto_dir_perms (dir (getattr relabelto)))

(classpermission relabel_dir_perms)
(classpermissionset relabel_dir_perms (dir (getattr relabelfrom relabelto)))

(classpermission read_lnk_file_perms)
(classpermissionset read_lnk_file_perms (lnk_file (getattr read)))

(classpermission all_lnk_file_perms_except_mounton_and_execmod)
(classpermissionset all_lnk_file_perms_except_mounton_and_execmod (lnk_file (ioctl read write create getattr setattr lock
	relabelfrom relabelto append unlink link rename execute quotaon audit_access open)))

(classpermission append_lnk_file_perms)
(classpermissionset append_lnk_file_perms (lnk_file (getattr append lock ioctl)))

(classpermission write_lnk_file_perms)
(classpermissionset write_lnk_file_perms (lnk_file (getattr append write lock ioctl)))

(classpermission rw_lnk_file_perms)
(classpermissionset rw_lnk_file_perms (lnk_file (getattr read write lock ioctl)))

(classpermission create_lnk_file_perms)
(classpermissionset create_lnk_file_perms (lnk_file (create getattr)))

(classpermission rename_lnk_file_perms)
(classpermissionset rename_lnk_file_perms (lnk_file (getattr rename)))

(classpermission delete_lnk_file_perms)
(classpermissionset delete_lnk_file_perms (lnk_file (getattr unlink)))

(classpermission manage_lnk_file_perms)
(classpermissionset manage_lnk_file_perms (lnk_file (create read write getattr setattr link lock ioctl unlink rename)))

(classpermission relabelfrom_lnk_file_perms)
(classpermissionset relabelfrom_lnk_file_perms (lnk_file (getattr relabelfrom)))

(classpermission relabelto_lnk_file_perms)
(classpermissionset relabelto_lnk_file_perms (lnk_file (getattr relabelto)))

(classpermission relabel_lnk_file_perms)
(classpermissionset relabel_lnk_file_perms (lnk_file (getattr relabelfrom relabelto)))

(classpermission read_chr_file_perms)
(classpermissionset read_chr_file_perms (chr_file (getattr open read lock ioctl)))

(classpermission all_chr_file_perms_except_mounton_and_execmod)
(classpermissionset all_chr_file_perms_except_mounton_and_execmod (chr_file (ioctl read write create getattr setattr lock
	relabelfrom relabelto append unlink link rename execute quotaon audit_access open)))

(classpermission append_chr_file_perms)
(classpermissionset append_chr_file_perms (chr_file (getattr open append lock ioctl)))

(classpermission append_inherited_chr_file_perms)
(classpermissionset append_inherited_chr_file_perms (chr_file (getattr append lock ioctl)))

(classpermission write_chr_file_perms)
(classpermissionset write_chr_file_perms (chr_file (getattr open write append lock ioctl)))

(classpermission write_inherited_chr_file_perms)
(classpermissionset write_inherited_chr_file_perms (chr_file (getattr write append lock ioctl)))

(classpermission rw_chr_file_perms)
(classpermissionset rw_chr_file_perms (chr_file (getattr open read write append ioctl lock)))

(classpermission rw_inherited_chr_file_perms)
(classpermissionset rw_inherited_chr_file_perms (chr_file (getattr read write append ioctl lock)))

(classpermission create_chr_file_perms)
(classpermissionset create_chr_file_perms (chr_file (getattr create open)))

(classpermission rename_chr_file_perms)
(classpermissionset rename_chr_file_perms (chr_file (getattr rename)))

(classpermission delete_chr_file_perms)
(classpermissionset delete_chr_file_perms (chr_file (getattr unlink)))

(classpermission manage_chr_file_perms)
(classpermissionset manage_chr_file_perms (chr_file (create open getattr setattr read write append rename link unlink ioctl lock)))

(classpermission relabelfrom_chr_file_perms)
(classpermissionset relabelfrom_chr_file_perms (chr_file (getattr relabelfrom)))

(classpermission relabelto_chr_file_perms)
(classpermissionset relabelto_chr_file_perms (chr_file (getattr relabelto)))

(classpermission relabel_chr_file_perms)
(classpermissionset relabel_chr_file_perms (chr_file (getattr relabelfrom relabelto)))

(classpermission rw_term_perms)
(classpermissionset rw_term_perms (chr_file (getattr open read write append ioctl)))

(classpermission rw_inherited_term_perms)
(classpermissionset rw_inherited_term_perms (chr_file (getattr read write append ioctl)))

(classpermission read_blk_file_perms)
(classpermissionset read_blk_file_perms (blk_file (getattr open read lock ioctl)))

(classpermission append_blk_file_perms)
(classpermissionset append_blk_file_perms (blk_file (getattr open append lock ioctl)))

(classpermission append_inherited_blk_file_perms)
(classpermissionset append_inherited_blk_file_perms (blk_file (getattr append lock ioctl)))

(classpermission all_blk_file_perms_except_mounton_and_execmod)
(classpermissionset all_blk_file_perms_except_mounton_and_execmod (blk_file (ioctl read write create getattr setattr lock
	relabelfrom relabelto append unlink link rename execute quotaon audit_access open)))

(classpermission write_blk_file_perms)
(classpermissionset write_blk_file_perms (blk_file (getattr open write append lock ioctl)))

(classpermission write_inherited_blk_file_perms)
(classpermissionset write_inherited_blk_file_perms (blk_file (getattr write append lock ioctl)))

(classpermission rw_blk_file_perms)
(classpermissionset rw_blk_file_perms (blk_file (getattr open read write append ioctl lock)))

(classpermission rw_inherited_blk_file_perms)
(classpermissionset rw_inherited_blk_file_perms (blk_file (getattr read write append ioctl lock)))

(classpermission create_blk_file_perms)
(classpermissionset create_blk_file_perms (blk_file (getattr create open)))

(classpermission rename_blk_file_perms)
(classpermissionset rename_blk_file_perms (blk_file (getattr rename)))

(classpermission delete_blk_file_perms)
(classpermissionset delete_blk_file_perms (blk_file (getattr unlink)))

(classpermission manage_blk_file_perms)
(classpermissionset manage_blk_file_perms (blk_file (create open getattr setattr read write append rename link unlink ioctl lock)))

(classpermission relabelfrom_blk_file_perms)
(classpermissionset relabelfrom_blk_file_perms (blk_file (getattr relabelfrom)))

(classpermission relabelto_blk_file_perms)
(classpermissionset relabelto_blk_file_perms (blk_file (getattr relabelto)))

(classpermission relabel_blk_file_perms)
(classpermissionset relabel_blk_file_perms (blk_file (getattr relabelfrom relabelto)))

(classpermission all_sock_file_perms_except_mounton_and_execmod)
(classpermissionset all_sock_file_perms_except_mounton_and_execmod (sock_file (ioctl read write create getattr setattr lock
	relabelfrom relabelto append unlink link rename execute quotaon audit_access open)))

(classpermission read_sock_file_perms)
(classpermissionset read_sock_file_perms (sock_file (getattr open read)))

(classpermission write_sock_file_perms)
(classpermissionset write_sock_file_perms (sock_file (getattr write open append)))

(classpermission write_inherited_sock_file_perms)
(classpermissionset write_inherited_sock_file_perms (sock_file (getattr write append lock ioctl)))

(classpermission rw_sock_file_perms)
(classpermissionset rw_sock_file_perms (sock_file (getattr open read write append)))

(classpermission rw_inherited_sock_file_perms)
(classpermissionset rw_inherited_sock_file_perms (sock_file (getattr read write append)))

(classpermission create_sock_file_perms)
(classpermissionset create_sock_file_perms (sock_file (getattr create open)))

(classpermission rename_sock_file_perms)
(classpermissionset rename_sock_file_perms (sock_file (getattr rename)))

(classpermission delete_sock_file_perms)
(classpermissionset delete_sock_file_perms (sock_file (getattr unlink)))

(classpermission manage_sock_file_perms)
(classpermissionset manage_sock_file_perms (sock_file (create open getattr setattr read write rename link unlink ioctl lock append)))

(classpermission relabelfrom_sock_file_perms)
(classpermissionset relabelfrom_sock_file_perms (sock_file (getattr relabelfrom)))

(classpermission relabelto_sock_file_perms)
(classpermissionset relabelto_sock_file_perms (sock_file (getattr relabelto)))

(classpermission relabel_sock_file_perms)
(classpermissionset relabel_sock_file_perms (sock_file (getattr relabelfrom relabelto)))

(classpermission all_fifo_file_perms_except_mounton_and_execmod)
(classpermissionset all_fifo_file_perms_except_mounton_and_execmod (fifo_file (ioctl read write create getattr setattr lock
	relabelfrom relabelto append unlink link rename execute quotaon audit_access open)))

(classpermission read_fifo_file_perms)
(classpermissionset read_fifo_file_perms (fifo_file (getattr open read lock ioctl)))

(classpermission append_fifo_file_perms)
(classpermissionset append_fifo_file_perms (fifo_file (getattr open append lock ioctl)))

(classpermission append_inherited_fifo_file_perms)
(classpermissionset append_inherited_fifo_file_perms (fifo_file (getattr append lock ioctl)))

(classpermission write_fifo_file_perms)
(classpermissionset write_fifo_file_perms (fifo_file (getattr open write append lock ioctl)))

(classpermission write_inherited_fifo_file_perms)
(classpermissionset write_inherited_fifo_file_perms (fifo_file (getattr write append lock ioctl)))

(classpermission rw_fifo_file_perms)
(classpermissionset rw_fifo_file_perms (fifo_file (getattr open read write append ioctl lock)))

(classpermission rw_inherited_fifo_file_perms)
(classpermissionset rw_inherited_fifo_file_perms (fifo_file (getattr read write append ioctl lock)))

(classpermission create_fifo_file_perms)
(classpermissionset create_fifo_file_perms (fifo_file (getattr create open)))

(classpermission rename_fifo_file_perms)
(classpermissionset rename_fifo_file_perms (fifo_file (getattr rename)))

(classpermission delete_fifo_file_perms)
(classpermissionset delete_fifo_file_perms (fifo_file (getattr unlink)))

(classpermission manage_fifo_file_perms)
(classpermissionset manage_fifo_file_perms (fifo_file (create open getattr setattr read write append rename link unlink ioctl lock)))

(classpermission relabelfrom_fifo_file_perms)
(classpermissionset relabelfrom_fifo_file_perms (fifo_file (getattr relabelfrom)))

(classpermission relabelto_fifo_file_perms)
(classpermissionset relabelto_fifo_file_perms (fifo_file (getattr relabelto)))

(classpermission relabel_fifo_file_perms)
(classpermissionset relabel_fifo_file_perms (fifo_file (getattr relabelfrom relabelto)))

(classpermission rw_socket_perms)
(classpermissionset rw_socket_perms (socket (ioctl read getattr write setattr append bind connect getopt setopt shutdown)))

(classpermission create_socket_perms)
(classpermissionset create_socket_perms (socket (create ioctl read getattr write setattr append bind connect getopt setopt shutdown)))

(classpermission rw_tcp_socket_perms)
(classpermissionset rw_tcp_socket_perms (tcp_socket (ioctl read getattr write setattr append bind connect getopt setopt shutdown)))

(classpermission rw_inherited_tcp_socket_perms)
(classpermissionset rw_inherited_tcp_socket_perms (tcp_socket (ioctl read getattr write)))

(classpermission create_tcp_socket_perms)
(classpermissionset create_tcp_socket_perms (tcp_socket (create ioctl read getattr write setattr append bind connect getopt
	setopt shutdown)))

(classpermission rw_tcp_stream_socket_perms)
(classpermissionset rw_tcp_stream_socket_perms (tcp_socket (ioctl read getattr write setattr append bind connect getopt setopt
	shutdown listen accept)))

(classpermission create_tcp_stream_socket_perms)
(classpermissionset create_tcp_stream_socket_perms (tcp_socket (create ioctl read getattr write setattr append bind connect getopt
	setopt shutdown listen accept)))

(classpermission connected_tcp_socket_perms)
(classpermissionset connected_tcp_socket_perms (tcp_socket (create ioctl read getattr write setattr append bind getopt setopt
	shutdown)))

(classpermission connected_tcp_stream_socket_perms)
(classpermissionset connected_tcp_stream_socket_perms (tcp_socket (create ioctl read getattr write setattr append bind getopt setopt
	shutdown listen accept)))

(classpermission rw_udp_socket_perms)
(classpermissionset rw_udp_socket_perms (udp_socket (ioctl read getattr write setattr append bind connect getopt setopt
	shutdown)))

(classpermission create_udp_socket_perms)
(classpermissionset create_udp_socket_perms (udp_socket (create ioctl read getattr write setattr append bind connect getopt
	setopt shutdown)))

(classpermission rw_rawip_socket_perms)
(classpermissionset rw_rawip_socket_perms (rawip_socket (ioctl read getattr write setattr append bind connect getopt setopt
	shutdown)))

(classpermission create_rawip_socket_perms)
(classpermissionset create_rawip_socket_perms (rawip_socket (create ioctl read getattr write setattr append bind connect getopt
	setopt shutdown)))

(classpermission rw_packet_socket_perms)
(classpermissionset rw_packet_socket_perms (packet_socket (ioctl read getattr write setattr append bind connect getopt setopt
	shutdown)))

(classpermission create_packet_socket_perms)
(classpermissionset create_packet_socket_perms (packet_socket (create ioctl read getattr write setattr append bind connect getopt
	setopt shutdown)))

(classpermission rw_key_socket_perms)
(classpermissionset rw_key_socket_perms (key_socket (ioctl read getattr write setattr append bind connect getopt setopt
	shutdown)))

(classpermission create_key_socket_perms)
(classpermissionset create_key_socket_perms (key_socket (create ioctl read getattr write setattr append bind connect getopt
	setopt shutdown)))

(classpermission rw_unix_stream_socket_perms)
(classpermissionset rw_unix_stream_socket_perms (unix_stream_socket (ioctl read getattr write setattr append bind connect getopt
	setopt shutdown)))

(classpermission rw_inherited_unix_stream_socket_perms)
(classpermissionset rw_inherited_unix_stream_socket_perms (unix_stream_socket (ioctl read getattr write)))

(classpermission create_unix_stream_socket_perms)
(classpermissionset create_unix_stream_socket_perms (unix_stream_socket (create ioctl read getattr write setattr append bind
	connect getopt setopt shutdown)))

(classpermission rw_unix_stream_stream_socket_perms)
(classpermissionset rw_unix_stream_stream_socket_perms (unix_stream_socket (ioctl read getattr write setattr append bind connect
	getopt setopt shutdown listen accept)))

(classpermission create_unix_stream_stream_socket_perms)
(classpermissionset create_unix_stream_stream_socket_perms (unix_stream_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown listen accept)))

(classpermission connected_unix_stream_socket_perms)
(classpermissionset connected_unix_stream_socket_perms (unix_stream_socket (create ioctl read getattr write setattr append bind
	getopt setopt shutdown)))

(classpermission connected_unix_stream_stream_socket_perms)
(classpermissionset connected_unix_stream_stream_socket_perms (unix_stream_socket (create ioctl read getattr write setattr append
	bind getopt setopt shutdown listen accept)))

(classpermission rw_unix_dgram_socket_perms)
(classpermissionset rw_unix_dgram_socket_perms (unix_dgram_socket (ioctl read getattr write setattr append bind connect getopt
	setopt shutdown)))

(classpermission rw_inherited_unix_dgram_socket_perms)
(classpermissionset rw_inherited_unix_dgram_socket_perms (unix_dgram_socket (ioctl read getattr write)))

(classpermission create_unix_dgram_socket_perms)
(classpermissionset create_unix_dgram_socket_perms (unix_dgram_socket (create ioctl read getattr write setattr append bind
	connect getopt setopt shutdown)))

(classpermission rw_unix_dgram_stream_socket_perms)
(classpermissionset rw_unix_dgram_stream_socket_perms (unix_dgram_socket (ioctl read getattr write setattr append bind connect
	getopt setopt shutdown listen accept)))

(classpermission create_unix_dgram_stream_socket_perms)
(classpermissionset create_unix_dgram_stream_socket_perms (unix_dgram_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown listen accept)))

(classpermission connected_unix_dgram_socket_perms)
(classpermissionset connected_unix_dgram_socket_perms (unix_dgram_socket (create ioctl read getattr write setattr append bind
	getopt setopt shutdown)))

(classpermission connected_unix_dgram_stream_socket_perms)
(classpermissionset connected_unix_dgram_stream_socket_perms (unix_dgram_socket (create ioctl read getattr write setattr append
	bind getopt setopt shutdown listen accept)))

(classpermission r_sem_perms)
(classpermissionset r_sem_perms (sem (associate getattr read unix_read)))

(classpermission rw_sem_perms)
(classpermissionset rw_sem_perms (sem (associate getattr read write unix_read unix_write)))

(classpermission create_sem_perms)
(classpermissionset create_sem_perms (sem (associate getattr setattr create destroy read write unix_read unix_write)))

(classpermission r_msgq_perms)
(classpermissionset r_msgq_perms (msgq (associate getattr read unix_read)))

(classpermission rw_msgq_perms)
(classpermissionset rw_msgq_perms (msgq (associate getattr read write enqueue unix_read unix_write)))

(classpermission create_msgq_perms)
(classpermissionset create_msgq_perms (msgq (associate getattr setattr create destroy read write enqueue unix_read unix_write)))

(classpermission r_shm_perms)
(classpermissionset r_shm_perms (shm (associate getattr read unix_read)))

(classpermission rw_shm_perms)
(classpermissionset rw_shm_perms (shm (associate getattr read write lock unix_read unix_write)))

(classpermission create_shm_perms)
(classpermissionset create_shm_perms (shm (associate getattr setattr create destroy read write lock unix_read unix_write)))

(classpermission create_netlink_route_socket_perms)
(classpermissionset create_netlink_route_socket_perms (netlink_route_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown nlmsg_read nlmsg_write)))

(classpermission r_netlink_route_socket_perms)
(classpermissionset r_netlink_route_socket_perms (netlink_route_socket (create ioctl read getattr write setattr append bind
	connect getopt setopt shutdown nlmsg_read)))

(classpermission create_netlink_tcpdiag_socket_perms)
(classpermissionset create_netlink_tcpdiag_socket_perms (netlink_tcpdiag_socket (create ioctl read getattr write setattr
	append bind connect getopt setopt shutdown nlmsg_read nlmsg_write)))

(classpermission r_netlink_tcpdiag_socket_perms)
(classpermissionset r_netlink_tcpdiag_socket_perms (netlink_tcpdiag_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown nlmsg_read)))

(classpermission rw_netlink_nflog_socket_perms)
(classpermissionset rw_netlink_nflog_socket_perms (netlink_nflog_socket (ioctl read getattr write setattr append bind connect
	getopt setopt shutdown)))

(classpermission create_netlink_nflog_socket_perms)
(classpermissionset create_netlink_nflog_socket_perms (netlink_nflog_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown)))

(classpermission create_netlink_xfrm_socket_perms)
(classpermissionset create_netlink_xfrm_socket_perms (netlink_xfrm_socket (create ioctl read getattr write setattr append bind
	connect getopt setopt shutdown nlmsg_read nlmsg_write)))

(classpermission r_netlink_xfrm_socket_perms)
(classpermissionset r_netlink_xfrm_socket_perms (netlink_xfrm_socket (create ioctl read getattr write setattr append bind connect
	getopt setopt shutdown nlmsg_read)))

(classpermission rw_netlink_selinux_socket_perms)
(classpermissionset rw_netlink_selinux_socket_perms (netlink_selinux_socket (ioctl read getattr write setattr append bind
	connect getopt setopt shutdown)))

(classpermission create_netlink_selinux_socket_perms)
(classpermissionset create_netlink_selinux_socket_perms (netlink_selinux_socket (create ioctl read getattr write setattr
	append bind connect getopt setopt shutdown)))

(classpermission create_netlink_audit_socket_perms)
(classpermissionset create_netlink_audit_socket_perms (netlink_audit_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown nlmsg_read nlmsg_write)))

(classpermission r_netlink_audit_socket_perms)
(classpermissionset r_netlink_audit_socket_perms (netlink_audit_socket (create ioctl read getattr write setattr append bind
	connect getopt setopt shutdown nlmsg_read)))

(classpermission rw_netlink_dnrt_socket_perms)
(classpermissionset rw_netlink_dnrt_socket_perms (netlink_dnrt_socket (ioctl read getattr write setattr append bind connect
	getopt setopt shutdown)))

(classpermission create_netlink_dnrt_socket_perms)
(classpermissionset create_netlink_dnrt_socket_perms (netlink_dnrt_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown)))

(classpermission rw_netlink_kobject_uevent_socket)
(classpermissionset rw_netlink_kobject_uevent_socket (netlink_kobject_uevent_socket (ioctl read getattr write setattr
	append bind connect getopt setopt shutdown)))

(classpermission create_netlink_kobject_uevent_socket_perms)
(classpermissionset create_netlink_kobject_uevent_socket_perms (netlink_kobject_uevent_socket (create ioctl read getattr write
	setattr append bind connect getopt setopt shutdown)))

(classpermission rw_appletalk_socket_perms)
(classpermissionset rw_appletalk_socket_perms (appletalk_socket (ioctl read getattr write setattr append bind connect getopt
	setopt shutdown)))

(classpermission create_appletalk_socket_perms)
(classpermissionset create_appletalk_socket_perms (appletalk_socket (create ioctl read getattr write setattr append bind
	connect getopt setopt shutdown)))

(classpermission rw_dccp_socket_perms)
(classpermissionset rw_dccp_socket_perms (dccp_socket (ioctl read getattr write setattr append bind connect getopt setopt
	shutdown)))

(classpermission create_dccp_socket_perms)
(classpermissionset create_dccp_socket_perms (dccp_socket (create ioctl read getattr write setattr append bind connect getopt
	setopt shutdown)))

(classpermission rw_dccp_stream_socket_perms)
(classpermissionset rw_dccp_stream_socket_perms (dccp_socket (ioctl read getattr write setattr append bind connect getopt setopt
	shutdown listen accept)))

(classpermission create_dccp_stream_socket_perms)
(classpermissionset create_dccp_stream_socket_perms (dccp_socket (create ioctl read getattr write setattr append bind connect getopt
	setopt shutdown listen accept)))

(classpermission connected_dccp_socket_perms)
(classpermissionset connected_dccp_socket_perms (dccp_socket (create ioctl read getattr write setattr append bind getopt setopt
	shutdown)))

(classpermission connected_dccp_stream_socket_perms)
(classpermissionset connected_dccp_stream_socket_perms (dccp_socket (create ioctl read getattr write setattr append bind getopt
	setopt shutdown listen accept)))

(classpermission all_capability2_perms_except_mac_override_and_mac_admin)
(classpermissionset all_capability2_perms_except_mac_override_and_mac_admin (capability2 (audit_read syslog wake_alarm
	block_suspend)))

(classpermission rw_tun_socket_perms)
(classpermissionset rw_tun_socket_perms (tun_socket (ioctl read getattr write setattr append bind connect getopt setopt
	shutdown)))

(classpermission create_tun_socket_perms)
(classpermissionset create_tun_socket_perms (tun_socket (create ioctl read getattr write setattr append bind connect getopt
	setopt shutdown)))

(classpermission rw_netlink_iscsi_socket_perms)
(classpermissionset rw_netlink_iscsi_socket_perms (netlink_iscsi_socket (ioctl read getattr write setattr append bind connect
	getopt setopt shutdown)))

(classpermission create_netlink_iscsi_socket_perms)
(classpermissionset create_netlink_iscsi_socket_perms (netlink_iscsi_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown)))

(classpermission rw_netlink_fib_lookup_socket_perms)
(classpermissionset rw_netlink_fib_lookup_socket_perms (netlink_fib_lookup_socket (ioctl read getattr write setattr append
	bind connect getopt setopt shutdown)))

(classpermission create_netlink_fib_lookup_socket_perms)
(classpermissionset create_netlink_fib_lookup_socket_perms (netlink_fib_lookup_socket (create ioctl read getattr write setattr
	append bind connect getopt setopt shutdown)))

(classpermission rw_netlink_connector_socket_perms)
(classpermissionset rw_netlink_connector_socket_perms (netlink_connector_socket (ioctl read getattr write setattr append
	bind connect getopt setopt shutdown)))

(classpermission create_netlink_connector_socket_perms)
(classpermissionset create_netlink_connector_socket_perms (netlink_connector_socket (create ioctl read getattr write setattr
	append bind connect getopt setopt shutdown)))

(classpermission rw_netlink_netfilter_socket_perms)
(classpermissionset rw_netlink_netfilter_socket_perms (netlink_netfilter_socket (ioctl read getattr write setattr append bind
	connect getopt setopt shutdown)))

(classpermission create_netlink_netfilter_socket_perms)
(classpermissionset create_netlink_netfilter_socket_perms (netlink_netfilter_socket (create ioctl read getattr write setattr
	append bind connect getopt setopt shutdown)))

(classpermission rw_netlink_generic_socket_perms)
(classpermissionset rw_netlink_generic_socket_perms (netlink_generic_socket (ioctl read getattr write setattr append bind
	connect getopt setopt shutdown)))

(classpermission create_netlink_generic_socket_perms)
(classpermissionset create_netlink_generic_socket_perms (netlink_generic_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown)))

(classpermission rw_netlink_scsitransport_socket_perms)
(classpermissionset rw_netlink_scsitransport_socket_perms (netlink_scsitransport_socket (ioctl read getattr write setattr append
	bind connect getopt setopt shutdown)))

(classpermission create_netlink_scsitransport_socket_perms)
(classpermissionset create_netlink_scsitransport_socket_perms (netlink_scsitransport_socket (create ioctl read getattr write
	setattr append bind connect getopt setopt shutdown)))

(classpermission rw_netlink_rdma_socket_perms)
(classpermissionset rw_netlink_rdma_socket_perms (netlink_rdma_socket (ioctl read getattr write setattr append bind connect
	getopt setopt shutdown)))

(classpermission create_netlink_rdma_socket_perms)
(classpermissionset create_netlink_rdma_socket_perms (netlink_rdma_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown)))

(classpermission rw_netlink_crypto_socket_perms)
(classpermissionset rw_netlink_crypto_socket_perms (netlink_crypto_socket (ioctl read getattr write setattr append bind connect
	getopt setopt shutdown)))

(classpermission create_netlink_crypto_socket_perms)
(classpermissionset create_netlink_crypto_socket_perms (netlink_crypto_socket (create ioctl read getattr write setattr append
	bind connect getopt setopt shutdown)))
(macro getattr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (file (getattr))))

(macro setattr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (file (setattr))))

(macro read_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 read_file_perms))

(macro mmap_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 mmap_file_perms))

(macro exec_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 exec_file_perms))

(macro append_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 append_file_perms))

(macro write_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 write_file_perms))

(macro rw_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 rw_file_perms))

(macro create_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 add_entry_dir_perms)
	(allow ARG1 ARG3 create_file_perms))

(macro delete_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 del_entry_dir_perms)
	(allow ARG1 ARG3 delete_file_perms))

(macro rename_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 rw_dir_perms)
	(allow ARG1 ARG3 rename_file_perms))

(macro manage_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 rw_dir_perms)
	(allow ARG1 ARG3 manage_file_perms))

(macro relabelfrom_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabelfrom_file_perms))

(macro relabelto_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabelto_file_perms))

(macro relabel_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabel_file_perms))

(macro getattr_dirs_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (dir (getattr))))

(macro setattr_dirs_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (dir (setattr))))

(macro search_dirs_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 search_dir_perms))

(macro list_dirs_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 list_dir_perms))

(macro rw_dirs_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 rw_dir_perms))

(macro create_dirs_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 add_entry_dir_perms)
	(allow ARG1 ARG3 create_dir_perms))

(macro delete_dirs_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 del_entry_dir_perms)
	(allow ARG1 ARG3 delete_dir_perms))

(macro manage_dirs_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 rw_dir_perms)
	(allow ARG1 ARG3 manage_dir_perms))

(macro relabelfrom_dirs_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabelfrom_dir_perms))

(macro relabel_dirs_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabel_dir_perms))

(macro getattr_lnk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (lnk_file (getattr))))

(macro read_lnk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 read_lnk_file_perms))

(macro rw_lnk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 rw_lnk_file_perms))

(macro create_lnk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 add_entry_dir_perms)
	(allow ARG1 ARG3 create_lnk_file_perms))

(macro delete_lnk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 del_entry_dir_perms)
	(allow ARG1 ARG3 delete_lnk_file_perms))

(macro manage_lnk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 rw_dir_perms)
	(allow ARG1 ARG3 manage_lnk_file_perms))

(macro relabelfrom_lnk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabelfrom_lnk_file_perms))

(macro relabel_lnk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabel_lnk_file_perms))

(macro getattr_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (chr_file (getattr))))

(macro setattr_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (chr_file (setattr))))

(macro read_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 read_chr_file_perms))

(macro append_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 append_chr_file_perms))

(macro write_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 write_chr_file_perms))

(macro rw_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 rw_chr_file_perms))

(macro create_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 self (capability (mknod)))
	(allow ARG1 ARG2 add_entry_dir_perms)
	(allow ARG1 ARG3 create_chr_file_perms))

(macro delete_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 del_entry_dir_perms)
	(allow ARG1 ARG3 delete_chr_file_perms))

(macro rename_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 rw_dir_perms)
	(allow ARG1 ARG3 rename_chr_file_perms))

(macro manage_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 self (capability (mknod)))
	(allow ARG1 ARG2 rw_dir_perms)
	(allow ARG1 ARG3 manage_chr_file_perms))

(macro relabelfrom_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabelfrom_chr_file_perms))

(macro relabel_chr_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabel_chr_file_perms))

(macro getattr_blk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (blk_file (getattr))))

(macro setattr_blk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (blk_file (setattr))))

(macro read_blk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 read_blk_file_perms))

(macro rw_blk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 rw_blk_file_perms))

(macro create_blk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 self (capability (mknod)))
	(allow ARG1 ARG2 add_entry_dir_perms)
	(allow ARG1 ARG3 create_blk_file_perms))

(macro delete_blk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 del_entry_dir_perms)
	(allow ARG1 ARG3 delete_blk_file_perms))

(macro rename_blk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 rw_dir_perms)
	(allow ARG1 ARG3 rename_blk_file_perms))

(macro manage_blk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 self (capability (mknod)))
	(allow ARG1 ARG2 rw_dir_perms)
	(allow ARG1 ARG3 manage_blk_file_perms))

(macro relabelfrom_blk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabelfrom_blk_file_perms))

(macro relabel_blk_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabel_blk_file_perms))

(macro getattr_sock_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (sock_file (getattr))))

(macro read_sock_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 read_sock_file_perms))

(macro write_sock_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 write_sock_file_perms))

(macro rw_sock_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 rw_sock_file_perms))

(macro create_sock_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 add_entry_dir_perms)
	(allow ARG1 ARG3 create_sock_file_perms))

(macro delete_sock_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 del_entry_dir_perms)
	(allow ARG1 ARG3 delete_sock_file_perms))

(macro manage_sock_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 rw_dir_perms)
	(allow ARG1 ARG3 manage_sock_file_perms))

(macro relabelfrom_sock_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabelfrom_sock_file_perms))

(macro relabel_sock_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabel_sock_file_perms))

(macro getattr_fifo_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 (fifo_file (getattr))))

(macro create_fifo_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 add_entry_dir_perms)
	(allow ARG1 ARG3 create_fifo_file_perms))

(macro read_fifo_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 read_fifo_file_perms))

(macro write_fifo_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 write_fifo_file_perms))

(macro rw_fifo_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 rw_fifo_file_perms))

(macro delete_fifo_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 del_entry_dir_perms)
	(allow ARG1 ARG3 delete_fifo_file_perms))

(macro manage_fifo_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 rw_dir_perms)
	(allow ARG1 ARG3 manage_fifo_file_perms))

(macro relabelfrom_fifo_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabelfrom_fifo_file_perms))

(macro relabel_fifo_files_pattern ((type ARG1)(type ARG2)(type ARG3))
	(allow ARG1 ARG2 search_dir_perms)
	(allow ARG1 ARG3 relabel_fifo_file_perms))
(macro stream_connect_pattern ((type ARG1)(type ARG2)(type ARG3)(type ARG4))
	(call write_sock_files_pattern (ARG1 ARG2 ARG3))
	(allow ARG1 self create_unix_stream_socket_perms)
	(allow ARG1 ARG4 (unix_stream_socket (connectto))))

(macro dgram_send_pattern ((type ARG1)(type ARG2)(type ARG3)(type ARG4))
	(call write_sock_files_pattern (ARG1 ARG2 ARG3))
	(allow ARG1 self create_unix_dgram_socket_perms)
	(allow ARG1 ARG4 (unix_dgram_socket (sendto))))
(class security (compute_av compute_create compute_member check_context load_policy compute_relabel compute_user
	setenforce setbool setsecparam setcheckreqprot read_policy))

(class process (fork transition sigchld sigkill sigstop signull signal ptrace getsched setsched getsession getpgid setpgid getcap
	setcap share getattr setexec setfscreate noatsecure siginh setrlimit rlimitinh dyntransition setcurrent execmem execstack
	execheap setkeycreate setsockcreate))

(class system (ipc_info syslog_read syslog_mod syslog_console
	module_request))

(class capability (chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service
	net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot
	sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap))

(class filesystem (mount remount unmount getattr relabelfrom
	relabelto associate quotamod quotaget))

(common file (ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute quotaon mounton))

(classcommon file file)
(class file (audit_access open execmod execute_no_trans entrypoint))

(classcommon dir file)
(class dir (audit_access open execmod add_name remove_name reparent search rmdir))

(class fd (use))

(classcommon lnk_file file)
(class lnk_file (audit_access open execmod))

(classcommon chr_file file)
(class chr_file (audit_access open execmod))

(classcommon blk_file file)
(class blk_file (audit_access open execmod))

(classcommon sock_file file)
(class sock_file (audit_access open execmod))

(classcommon fifo_file file)
(class fifo_file (audit_access open execmod))

(common socket (ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt
	setopt shutdown recvfrom sendto name_bind))

(classcommon socket socket)
(class socket ())

(classcommon tcp_socket socket)
(class tcp_socket (node_bind name_connect))

(classcommon udp_socket socket)
(class udp_socket (node_bind))

(classcommon rawip_socket socket)
(class rawip_socket (node_bind))

(class node (recvfrom sendto))

(class netif (ingress egress))

; remove me when everything is at Linux 4.2
(classcommon netlink_socket socket)
(class netlink_socket ())

(classcommon packet_socket socket)
(class packet_socket ())

(classcommon key_socket socket)
(class key_socket ())

(classcommon unix_stream_socket socket)
(class unix_stream_socket (connectto))

(classcommon unix_dgram_socket socket)
(class unix_dgram_socket ())

(common ipc (create destroy getattr setattr read write associate unix_read unix_write))

(classcommon sem ipc)
(class sem ())

(class msg (send receive))

(classcommon msgq ipc)
(class msgq (enqueue))

(classcommon shm ipc)
(class shm (lock))

(classcommon ipc ipc)
(class ipc ())

(classcommon netlink_route_socket socket)
(class netlink_route_socket (nlmsg_read nlmsg_write))

(classcommon netlink_tcpdiag_socket socket)
(class netlink_tcpdiag_socket (nlmsg_read nlmsg_write))

(classcommon netlink_nflog_socket socket)
(class netlink_nflog_socket ())

(classcommon netlink_xfrm_socket socket)
(class netlink_xfrm_socket (nlmsg_read nlmsg_write))

(classcommon netlink_selinux_socket socket)
(class netlink_selinux_socket ())

(classcommon netlink_audit_socket socket)
(class netlink_audit_socket (nlmsg_read nlmsg_write nlmsg_relay nlmsg_readpriv nlmsg_tty_audit))

(classcommon netlink_dnrt_socket socket)
(class netlink_dnrt_socket ())

(class association (sendto recvfrom setcontext polmatch))

(classcommon netlink_kobject_uevent_socket socket)
(class netlink_kobject_uevent_socket ())

(classcommon appletalk_socket socket)
(class appletalk_socket ())

(class packet (send recv relabelto forward_in forward_out))

(class key (view read write search link setattr create))

(classcommon dccp_socket socket)
(class dccp_socket (node_bind name_connect))

(class memprotect (mmap_zero))

(class peer (recv))

(class capability2 (audit_read mac_override mac_admin syslog wake_alarm block_suspend))

(class kernel_service (use_as_override create_files_as))

(classcommon tun_socket socket)

(class tun_socket (attach_queue))

(class binder (impersonate call set_context_mgr transfer))

(classcommon netlink_iscsi_socket socket)
(class netlink_iscsi_socket ())

(classcommon netlink_fib_lookup_socket socket)
(class netlink_fib_lookup_socket ())

(classcommon netlink_connector_socket socket)
(class netlink_connector_socket ())

(classcommon netlink_netfilter_socket socket)
(class netlink_netfilter_socket ())

(classcommon netlink_generic_socket socket)
(class netlink_generic_socket ())

(classcommon netlink_scsitransport_socket socket)
(class netlink_scsitransport_socket ())

(classcommon netlink_rdma_socket socket)
(class netlink_rdma_socket ())

(classcommon netlink_crypto_socket socket)
(class netlink_crypto_socket ())

(classorder (security process system capability filesystem file dir fd lnk_file chr_file blk_file sock_file fifo_file socket
	tcp_socket udp_socket rawip_socket node netif netlink_socket packet_socket key_socket unix_stream_socket unix_dgram_socket
	sem msg msgq shm ipc netlink_route_socket netlink_tcpdiag_socket netlink_nflog_socket
	netlink_xfrm_socket netlink_selinux_socket netlink_audit_socket netlink_dnrt_socket association
	netlink_kobject_uevent_socket appletalk_socket packet key dccp_socket memprotect peer capability2 kernel_service
	tun_socket binder netlink_iscsi_socket netlink_fib_lookup_socket netlink_connector_socket netlink_netfilter_socket
	netlink_generic_socket netlink_scsitransport_socket netlink_rdma_socket netlink_crypto_socket))
(macro rbacsep_exempt_role ((role ARG1))
	(roleattributeset rbacsep_exempt_role ARG1))

(macro rbacsep_read_state_source_subj_type ((type ARG1))
	(typeattributeset rbacsep_read_state_source_subj_type ARG1))

(macro rbacsep_read_state_target_subj_type ((type ARG1))
	(typeattributeset rbacsep_read_state_target_subj_type ARG1))

(macro rbacsep_exempt_obj_type ((type ARG1))
	(typeattributeset rbacsep_exempt_obj_type ARG1))

(macro rbacsep_exempt_subj_type ((type ARG1))
	(typeattributeset rbacsep_exempt_subj_type ARG1))

(macro rbacsep_obj_role_change_exemption_subj_type ((type ARG1))
	(typeattributeset rbacsep_obj_role_change_exemption_subj_type ARG1))

(macro rbacsep_obj_sys_role_change_exemption_subj_type ((type ARG1))
	(typeattributeset rbacsep_obj_sys_role_change_exemption_subj_type ARG1))
(roleattribute rbacsep_exempt_role)

(typeattribute rbacsep_read_state_source_subj_type)
(typeattribute rbacsep_read_state_target_subj_type)

(typeattribute rbacsep_exempt_obj_type)
(typeattribute rbacsep_exempt_subj_type)

(typeattribute rbacsep_obj_role_change_exemption_subj_type)
(typeattribute rbacsep_obj_sys_role_change_exemption_subj_type)

(tunableif enable_rbacsep
	(true
		(defaultrole file source)
		(defaultrole dir source)
		(defaultrole lnk_file source)
		(defaultrole chr_file source)
		(defaultrole blk_file source)
		(defaultrole sock_file source)
		(defaultrole fifo_file source))
	(false
		(role object_r)
		(call sys_role (object_r))))
(tunableif enable_rbacsep
	(true
		(constrain (fd (use))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (unix_dgram_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (unix_dgram_socket (getattr ioctl read write sendto))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (unix_stream_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (unix_stream_socket (getattr ioctl read write connectto))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (process (ptrace sigchld sigkill sigstop signull))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (chr_file (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (chr_file (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_obj_type)))

		(constrain (blk_file (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				 (eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (chr_file (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_obj_type)))

		(constrain (fifo_file (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (fifo_file (getattr ioctl read write))
			(or (or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_obj_type)))

		(constrain (sock_file (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (sock_file (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_obj_type)))

		(constrain (dir (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (dir (getattr ioctl read write))
			(or (or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_obj_type))
				(and (eq r2 rbacsep_exempt_role) (neq t2 subj_common_type)))
				(and (eq t1 rbacsep_read_state_source_subj_type) (eq t2 rbacsep_read_state_target_subj_type))))

		(constrain (lnk_file (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (lnk_file (getattr ioctl read write))
			(or (or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_obj_type))
				(and (eq r2 rbacsep_exempt_role) (neq t2 subj_common_type)))
				(and (eq t1 rbacsep_read_state_source_subj_type) (eq t2 rbacsep_read_state_target_subj_type))))

		(constrain (file (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (file (getattr ioctl read write))
			(or (or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_obj_type))
				(and (eq r2 rbacsep_exempt_role) (neq t2 subj_common_type)))
				(and (eq t1 rbacsep_read_state_source_subj_type) (eq t2 rbacsep_read_state_target_subj_type))))

		(constrain (tcp_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (tcp_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (udp_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (udp_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (rawip_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (rawip_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (packet_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (packet_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (key (create link read search setattr view write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (ipc (create destroy setattr write unix_write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (sem (create destroy setattr write unix_write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (msgq (create destroy setattr write unix_write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (shm (create destroy setattr write unix_write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_route_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_route_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_tcpdiag_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_tcpdiag_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_nflog_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_nflog_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_xfrm_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_xfrm_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_selinux_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_selinux_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_audit_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_audit_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_dnrt_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_dnrt_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_kobject_uevent_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_kobject_uevent_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (appletalk_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (appletalk_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (dccp_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (dccp_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (tun_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (tun_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_iscsi_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_iscsi_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_fib_lookup_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_fib_lookup_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_connector_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_connector_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_netfilter_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_netfilter_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_generic_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_generic_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_scsitransport_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_scsitransport_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_rdma_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_rdma_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))

		(constrain (netlink_crypto_socket (create relabelto relabelfrom))
			(or (or (eq r1 r2)
				(and (eq t1 rbacsep_obj_sys_role_change_exemption_subj_type) (eq r2 sys.role)))
				(eq t1 rbacsep_obj_role_change_exemption_subj_type)))

		(constrain (netlink_crypto_socket (getattr ioctl read write))
			(or (or (or (or (eq r1 r2)
				(eq r1 rbacsep_exempt_role))
				(eq r2 rbacsep_exempt_role))
				(eq t1 rbacsep_exempt_subj_type))
				(eq t2 rbacsep_exempt_subj_type)))))
